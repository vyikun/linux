





# LinuxåŸºç¡€å‘½ä»¤

[TOC]



## 0. bashåŸºç¡€

**Linux shell ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»**

```bash
äº¤äº’å¼shellï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥æ‰§è¡Œçš„å‘½ä»¤(ç»ˆç«¯æ“ä½œ,éœ€è¦ä¸æ–­æç¤ºï¼‰
éäº¤äº’å¼shellï¼Œæ‰§è¡Œshellè„šæœ¬ï¼Œè„šæœ¬æ‰§è¡Œç»“æŸåshelè‡ªåŠ¨é€€å‡º
ç™»é™†shellï¼Œéœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æ‰èƒ½è¿›å…¥Shellï¼Œæ—¥å¸¸æ¥è§¦çš„æœ€å¤šçš„ä¸€ç§
éç™»é™†shellï¼Œä¸éœ€è¦è¾“å…¥ç”¨æˆ·å’Œå¯†ç å°±èƒ½è¿›å…¥Shell,æ¯”å¦‚è¿è¡Œbashä¼šå¼€å¯ä¸€ä¸ªæ–°çš„ä¼šè¯çª—å£
```

2.bash shell é…ç½®æ–‡ä»¶ä»‹ç»ï¼ˆæ–‡ä»¶ä¸»è¦ä¿å­˜ç”¨æˆ·çš„å·¥ä½œç¯å¢ƒï¼‰

```bash
ä¸ªäººé…ç½®æ–‡ä»¶: ~/.bash_profile  ~/.bashrc  
å…¨å±€é…ç½®æ–‡ä»¶:/etc/profile /etc/profile.d/*.sh /etc/bashrc 
profileç±»æ–‡ä»¶ï¼Œè®¾å®šç¯å¢ƒå˜é‡ï¼Œç™»é™†å‰è¿è¡Œçš„è„šæœ¬å’Œå‘½ä»¤ã€‚
bashrcç±»æ–‡ä»¶ï¼Œè®¾å®šæœ¬åœ°å˜é‡,å®šä¹‰å‘½ä»¤åˆ«å
PS:å¦‚æœå…¨å±€é…ç½®å’Œä¸ªäººé…ç½®äº§ç”Ÿå†²çªï¼Œä»¥ä¸ªäººé…ç½®ä¸ºå‡†ã€‚
```

3.ç™»é™†ç³»ç»Ÿåï¼Œç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶çš„åº”ç”¨é¡ºåºæ˜¯?

```bash
ç™»é™†å¼shellé…ç½®æ–‡ä»¶æ‰§è¡Œé¡ºåºï¼š/etc/profile->/etc/profile.d/*.sh->/root/.bash_profile->/etc/bashrc
éç™»å½•shelllé…ç½®æ–‡ä»¶æ‰§è¡Œé¡ºåºï¼š/root/.bashrc->/etc/bashrc->/etc/profile.d/*.sh
```

**ps:éªŒè¯ä½¿ç”¨echoåœ¨æ¯è¡Œæ·»åŠ ä¸€ä¸ªæ–‡ä»¶åè¾“å‡ºå³å¯**

### 0.1.å¿«æ·é”®

```bash
ctrl+a          å°†å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–
ctrl+e          å°†å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾
ctrl+k          åˆ é™¤å…‰æ ‡åçš„æ‰€æœ‰å†…å®¹
ctrl+u          åˆ é™¤å…‰æ ‡å‰çš„æ‰€æœ‰å†…å®¹
ctrl+w          åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å†…å®¹ï¼ŒæŒ‰å•è¯è¿›è¡Œåˆ é™¤
ctrl+l          æ¸…ç†å±å¹• ==> clear
ctrl+r          æœç´¢å†å²æ‰§è¡Œè¿‡çš„å‘½ä»¤ï¼ˆæŒ‰å…³é”®å­—æœç´¢ï¼‰
ctrl+c          ç»“æŸå½“å‰æ­£åœ¨Bashçª—å£å‰å°è¿è¡Œçš„ç¨‹åº
ctrl+d          é€€å‡ºå½“å‰Bash Shell ==>logout
```

### 0.2.åˆ«åalias

1.ä¸´æ—¶è®¾ç½®

```bash
è®¾ç½®
#alias net='cat /etc/sysconfig/network-scripts/ifcfg-eth0'
å–æ¶ˆ
unalias net
```

2.æ°¸ä¹…è®¾ç½® 

```bash
å½“å‰ç”¨æˆ·ä¸‹#cat ~/.bashrcæ–‡ä»¶ä¼šè‡ªåŠ¨åŠ è½½ï¼Œè¿™ä¸ªæ–‡ä»¶ä¹ŸæŒ‡å‘/etc/bashrc,æ‰€ä»¥æ·»åŠ åœ¨é‚£ä¸ªæ–‡ä»¶éƒ½å¯ä»¥
#è®¾ç½®æ–¹æ³•
echo "alias net='cat /etc/sysconfig/network-scripts/ifcfg-eth0'" >>/etc/bashrc
```

### 0.3.å†å²è®°å½•history

```bash
#ä½¿ç”¨
!123                #è°ƒç”¨historyå†å²è®°å½•ä¸­123æ¬¡çš„æ“ä½œå†æ¬¡æ‰§è¡Œ
!!                  #å¿«é€Ÿæ‰ç”¨ä¸Šä¸€æ¡æ‰§è¡Œè¿‡çš„å‘½ä»¤
æŒ‰ecsåœ¨æŒ‰ .          #å¿«é€Ÿè°ƒå–ä¸Šä¸€æ¡å‘½ä»¤çš„å‚æ•°

#å‚æ•°
-w ä¿å­˜å½“å‰shellæ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ï¼Œè‡³æ–‡ä»¶ä¸­å­˜å‚¨é»˜è®¤å­˜æ”¾~/.bash_historyæ–‡ä»¶
-c æ¸…ç©ºå‘½ä»¤å†å²è®°å½•ï¼Œä¸ä¼šæ¸…ç©ºæ–‡ä»¶      å®ä¾‹ï¼šhistory -c
-d åˆ é™¤å‘½ä»¤å†å²çš„ç¬¬nè¡Œ               å®ä¾‹ï¼šhistory -d 123
```

### 0.4.å¸®åŠ©æ‰‹å†Œ --help | man

```
ls --help
man ls						--->æŒ‰qé€€å‡º
```

## 1.æ–‡ä»¶ç®¡ç†

**åˆ›å»º/å¤åˆ¶/ç§»åŠ¨/åˆ é™¤/ç¼–è¾‘**

### 1.1.åˆ›å»ºæ–‡ä»¶ touch

```
#touch file						#æ— åˆ™åˆ›å»ºæœ‰åˆ™ä¿®æ”¹åˆ›å»ºæ—¶é—´
#touch file1 file2	
#touch /home/file3 file4
#touch file{a,b,c}				#{}é›†åˆ,ç­‰ä»· touch a b c
#touch file{1..10}
#touch file{a..z}
```

### 1.2.åˆ›å»ºç›®å½• mkdir

ç›®å½•é€šå¸¸æ˜¾ç¤ºä¸ºè“è‰²

```
å‘½ä»¤:mkdir
é€‰é¡¹: -pé€’å½’åˆ›å»º -væ˜¾ç¤ºåˆ›å»ºè¿‡ç¨‹		
å‚æ•°: è·¯å¾„,åœ¨ä»€ä¹ˆåœ°æ–¹åˆ›å»º

#mkdir /home/cc/123 /home/kk/456 -p
#mkdir /home/cc/{dir3,dir4}
#mkdir -pv /home/{cc/{xx,zz},oo}

tree å°†ç›®å½•ä»¥æ ‘çŠ¶ç»“æ„æ˜¾ç¤º,å¦‚æœæ²¡æœ‰çš„è¯yum instll tree -y å®‰è£…
```

### 1.3.æ‹·è´æ–‡ä»¶ cp

```
å‘½ä»¤: cp
é€‰é¡¹: 
-v:è¯¦ç»†æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œçš„æ“ä½œ 
-r:é€’å½’å¤„ç†ç›®å½•ä¸æ–‡ä»¶ 
-p:ä¿ç•™æºæ–‡ä»¶æˆ–ç›®å½•çš„å±æ€§
```

### 1.4.ç§»åŠ¨æ–‡ä»¶ mv

```
ç§»åŠ¨æ–‡ä»¶: mv[OPTION]... SoURCE... DIRECTORY
```

### 1.5.åˆ é™¤æ–‡ä»¶æˆ–ç›®å½• rm

```
é€‰é¡¹: 
-r:é€’å½’ 
-f:å¼ºåˆ¶åˆ é™¤ 
-v:è¯¦ç»†è¿‡ç¨‹
```

å®éªŒ:

```
1.åˆ›å»ºäº†ä¸€æ¨çš„æ–‡ä»¶ï¼Œæ–‡ä»¶è¦è¿›è¡Œåˆ†é—¨åˆ«ç±»å­˜å‚¨èµ·æ¥ã€‚
	1)åˆ›å»ºä¸€æ¨æ–‡ä»¶ 		{/data/filea-filez}
	2)åˆ›å»ºä¸€ä¸ªç›®å½•	 	{/data/files}
	3)å°†æ–‡ä»¶æ‹·è´åˆ°å¯¹åº”ç›®å½•
	4)åˆ é™¤æ–‡ä»¶			  {/data/files/*}

```

### 1.6.chmod ä¿®æ”¹æ–‡ä»¶æƒé™

```bash
#é€‰é¡¹:  -Ré€’å½’ä¿®æ”¹
# chmod 644 file
# chmod -R 755 dir/
```

### 1.7.chown ä¿®æ”¹å±ä¸»å±ç»„

```bash
#é€‰é¡¹:  -Ré€’å½’ä¿®æ”¹

1.å˜æ›´æ–‡ä»¶çš„å±ä¸»å’Œå±ç»„
chown kk.kk access-2020-03-12.log

2.ä»…å˜æ›´æ–‡ä»¶çš„å±ç»„
[root@web ~]# chown .root access-2020-03-12.log
[root@web ~]# ll access-2020-03-12.log
-rw-r--r--. 1 kk root 58112885 3æœˆ  13 09:25 access-2020-03-12.log

3.ä½¿ç”¨chgrpç›´æ¥å˜æ›´æ–‡ä»¶çš„å±ç»„ï¼ˆåªèƒ½æ˜¯å±ç»„ï¼Œä¸èƒ½æ˜¯å…¶ä»–ï¼‰
[root@web ~]# chgrp kk access-2020-03-12.log
[root@web ~]# ll access-2020-03-12.log
-rw-r--r--. 1 kk kk 58112885 3æœˆ  13 09:25 access-2020-03-12.log
```

### 1.7.æ–‡ä»¶ç¼–è¾‘vim

1.æ™®é€šæ¨¡å¼

```bash
vimä¸€ä¸ªæ–‡ä»¶é»˜è®¤æ˜¯æ™®é€šæ¨¡å¼,ä¸»è¦æ˜¯æ§åˆ¶å…‰æ ‡ç§»åŠ¨,å¯å¯¹æ–‡æœ¬è¿›è¡Œå¤åˆ¶ã€ç²˜è´´ã€åˆ é™¤ç­‰å·¥ä½œã€‚
1ã€å‘½ä»¤è¡Œè·³è½¬
G       #å…‰æ ‡è·³è½¬è‡³æœªç«¯ï¼ˆæ–‡ä»¶çš„å°¾éƒ¨ï¼‰
gg      #å…‰æ ‡è·³è½¬è‡³é¡¶ç«¯
Ngg     #å…‰æ ‡è·³è½¬è‡³å½“å‰æ–‡ä»¶å†…çš„Nè¡Œ  ï¼ˆæŒ‡å®šå…‰æ ‡è·³è½¬åˆ°å¤šå°‘è¡Œï¼‰ 5gg è·³è½¬åˆ°ç¬¬äº”è¡Œ
ctrl+f  #å¾€ä¸‹ç¿»é¡µï¼ˆè¡Œæ¯”è¾ƒå¤šï¼‰
ctrl+b  #å¾€ä¸‹ç¿»é¡µ

$       #å…‰æ ‡è·³è½¬è‡³å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„å°¾éƒ¨ ï¼ˆåªæ˜¯è·³è½¬ï¼Œå¹¶ä¸ä¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼‰
^|0     #å…‰æ ‡è·³è½¬è‡³å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„é¦–éƒ¨

2ã€å¤åˆ¶ç²˜è´´
yy      #å¤åˆ¶ä¸å½“å‰å…‰æ ‡æ‰€åœ¨çš„è¡Œ
Nyy     #å¤åˆ¶å¸¦ä¸Šå½“å‰å…‰æ ‡æ‰€åœ¨çš„è¡Œï¼Œå…±Nè¡Œ

p(å°å†™)   #ç²˜è´´è‡³å½“å‰å…‰æ ‡ä¸‹ä¸€è¡Œ
P(å¤§å†™)   #ç²˜è´´è‡³å½“å‰å…‰æ ‡ä¸Šä¸€è¡Œ
3ã€åˆ é™¤å‰ªè´´æ’¤é”€
dd      #åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨çš„è¡Œ
4dd     #åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨çš„è¡Œä»¥åŠå¾€ä¸‹çš„3è¡Œ
dG      #åˆ é™¤å½“å‰å…‰æ ‡ä»¥åçš„æ‰€æœ‰è¡Œ
D       #åˆ é™¤å½“å‰å…‰æ ‡åŠå…‰æ ‡ä»¥åçš„å†…å®¹
x       #åˆ é™¤å½“å‰å…‰æ ‡æ ‡è®°è®°ä½å¾€åçš„å­—ç¬¦
X       #åˆ é™¤å½“å‰å…‰æ ‡æ ‡è®°è®°ä½å¾€å‰çš„å­—ç¬¦
dd & p  #å‰ªè´´ å…ˆåˆ é™¤åç²˜è´´=å‰ªè´´
u       #æ’¤é”€ä¸Šä¸€æ¬¡çš„æ“ä½œ
4ã€æ›¿æ¢
r       #æ›¿æ¢å½“å‰å…‰æ ‡æ ‡è®°çš„å•ä¸ªå­—ç¬¦
R       #è¿›å…¥REPLACEæ¨¡å¼ï¼Œè¿ç»­æ›¿æ¢ï¼ŒESCç»“æŸ
```

2.ç¼–è¾‘æ¨¡å¼

```bash
ä»æ™®é€šæ¨¡å¼è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œåªéœ€æŒ‰ä¸€ä¸ªé”®å³å¯ï¼ˆiã€Iã€aã€Aã€oã€Oï¼‰ escé€€å‡ºç¼–è¾‘æ¨¡å¼
i       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå…‰æ ‡ä¸åšä»»ä½•æ“ä½œ
a       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå°†å½“å‰å…‰æ ‡å¾€åä¸€ä½
o       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå¹¶åœ¨å½“å‰å…‰æ ‡ä¸‹æ·»åŠ ä¸€è¡Œç©ºç™½å†…å®¹

I       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ä¼šè·³è½¬è‡³æœ¬è¡Œçš„å¤´éƒ¨
A       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå°†å…‰æ ‡ç§»åŠ¨è‡³æœ¬è¡Œå°¾éƒ¨
O       #è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå¹¶åœ¨å½“å‰å…‰æ ‡ä¸Šæ·»åŠ ä¸€è¡Œç©ºç™½å†…å®¹
```

3.æœ«è¡Œæ¨¡å¼

```bash
åœ¨æ™®é€šæ¨¡å¼ä¸‹,è¾“å…¥ ":" æˆ–è€… "/" å³å¯è¿›å…¥æœ«è¡Œæ¨¡å¼.åœ¨æœ«è¡Œæ¨¡å¼ä¸‹å¯è¿›è¡Œçš„æ“ä½œæœ‰:æ˜¾ç¤ºè¡Œå·ã€æœç´¢ã€æ›¿æ¢ã€ä¿å­˜ã€é€€å‡ºã€‚
#ä¸»è¦ä¿å­˜é€€å‡º
:w          ä¿å­˜å½“å‰çŠ¶æ€
:q          é€€å‡ºå½“å‰æ–‡æ¡£ï¼ˆæ–‡æ¡£å¿…é¡»ä¿å­˜æ‰èƒ½é€€å‡ºï¼‰
:w!         å¼ºåˆ¶ä¿å­˜å½“å‰çŠ¶æ€
:q!         å¼ºåˆ¶é€€å‡ºæ–‡æ¡£ä¸ä¼šä¿®æ”¹æ–‡ä»¶å†…å®¹
:wq         å…ˆä¿å­˜åœ¨é€€å‡º
:wq!        å¼ºåˆ¶ä¿å­˜å¹¶é€€å‡º
:number     è·³è½¬è‡³å¯¹åº”çš„è¡Œå·

2.æ–‡ä»¶å†…å®¹æŸ¥æ‰¾
/string     #éœ€è¦æœç´¢çš„å†…å®¹ï¼ˆæŸ¥æ‰¾ï¼‰
n           #æŒ‰æœç´¢åˆ°çš„å†…å®¹ä¾æ¬¡å¾€ä¸‹è¿›è¡ŒæŸ¥æ‰¾
N           #æŒ‰æœç´¢åˆ°çš„å†…å®¹ä¾æ¬¡å¾€ä¸ŠæŸ¥æ‰¾
3.æ–‡ä»¶å†…å®¹æ›¿æ¢

:1,5s#sbin#test#g       #æ›¿æ¢1-5è¡Œä¸­åŒ…å«sbinçš„å†…å®¹ä¸ºtest
:%S#sbin#test#g         #æ›¿æ¢æ•´ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­åŒ…å«sbinçš„æ›¿æ¢ä¸ºtest
4.æ–‡ä»¶å†…å®¹ä¿å­˜
:w /root/test.txt       #å°†æ‰€æœ‰å†…å®¹ä¿å­˜åˆ°/root/test.txtæ–‡ä»¶ä¸­

5.æ–‡ä»¶å†…å®¹è¯»å…¥
:r /etc/hosts           #è¯»å…¥/etc/hostsæ–‡ä»¶è‡³å½“å‰å…‰æ ‡ä¸‹é¢
:5r /etc/hosts          #æŒ‡å®šæ’å…¥/etc/hostsæ–‡ä»¶è‡³å½“å‰æ–‡ä»¶çš„ç¬¬äº”è¡Œä¸‹é¢
```

4.è§†å›¾æ¨¡å¼

```bash
ä»æ™®é€šæ¨¡å¼è¿›å…¥è§†å›¾æ¨¡å¼ï¼Œä¸»è¦è¿›è¡Œæ‰¹é‡æ“ä½œ

shift+v     è¿›å…¥å¯è§†åŒ–æ¨¡å¼ï¼Œé€‰ä¸­æ•´è¡Œå†…å®¹å¯è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š
    1.å¤åˆ¶ï¼šé€‰ä¸­è¡Œå†…å®¹åæŒ‰yé”®å³å¯å¤åˆ¶ã€‚
    2.åˆ é™¤ï¼šé€‰ä¸­è¡Œå†…å®¹åæŒ‰dé”®åˆ é™¤ã€‚
    
ctrl+v      è¿›å…¥å¯è§†å¿«æ¨¡å¼ï¼Œé€‰ä¸­éœ€è¦æ³¨é‡Šçš„è¡Œ
    1.æ’å…¥ï¼šæŒ‰shift+i(å°±æ˜¯å¤§å†™i)è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥#ï¼Œç»“æŸæŒ‰ESCé”®
    2.åˆ é™¤ï¼šé€‰ä¸­å†…å®¹åï¼ŒæŒ‰xæˆ–è€…dé”®åˆ é™¤
    3.æ›¿æ¢ï¼šé€‰ä¸­éœ€è¦æ›¿æ¢çš„å†…å®¹ï¼ŒæŒ‰ä¸‹ré”®ï¼Œç„¶åè¾“å…¥æ›¿æ¢åçš„å†…å®¹
```

5.æ‰©å±•çŸ¥è¯†

```bash
1.ç¯å¢ƒå˜é‡ä¸´æ—¶ç”Ÿæ•ˆ

:set nu             #æ˜¾ç¤ºè¡Œå·
:set ic             #å¿½ç•¥å¤§å°å†™,åœ¨æœç´¢çš„æ—¶å€™æœ‰ç”¨
:set ai             #è‡ªåŠ¨ç¼©è¿›
:set list           #æ˜¾ç¤ºåˆ¶è¡¨ç¬¦(ç©ºè¡Œã€tabé”®)
:noho               #å–æ¶ˆæœç´¢å‡ºæ¥çš„å†…å®¹æ˜¾ç¤ºé«˜äº®
:set no[nu|ic|ai..] #å–æ¶ˆä¸´æ—¶è®¾å®šçš„å˜é‡
2.ç¯å¢ƒå˜é‡æ°¸ä¹…ç”Ÿæ•ˆ. ~/.vimrc ä¸ªäººç¯å¢ƒå˜é‡(ä¼˜å…ˆçº§é«˜) /etc/vimrc å…¨å±€ç¯å¢ƒå˜é‡

# vim ~/.vimrc      #å½“ä¸‹æ¬¡å†æ‰“å¼€æ–‡ä»¶è‡ªåŠ¨æ˜¾ç¤ºè¡Œå·å¹¶å¿½ç•¥å¤§å°å†™
set nu
set ic

#å¦‚æœä¸ªäººvimç¯å¢ƒæ²¡æœ‰é…ç½®,åˆ™ä½¿ç”¨å…¨å±€vimç¯å¢ƒå˜é‡é…ç½®.
#å¦‚æœä¸ªäººvimç¯å¢ƒå’Œå…¨å±€ç¯å¢ƒå˜é‡äº§ç”Ÿå†²çª,ä¼˜å…ˆä½¿ç”¨ä¸ªäººvimç¯å¢ƒå˜é‡.
3.å¦‚ä½•åŒæ—¶ç¼–è¾‘å¤šä¸ªæ–‡ä»¶

vim -o file1 file2      #æ°´å¹³åˆ†éš”
vim -O file1 file2      #å‚ç›´åˆ†éš”

#ctrl+ww    æ–‡ä»¶åˆ‡æ¢
4.ç›¸åŒæ–‡ä»¶ä¹‹é—´å·®å¼‚å¯¹æ¯”,é€šå¸¸ç”¨äºå¯¹æ¯”ä¿®æ”¹å‰åå·®å¼‚

#diff           #æ–‡ä»¶å¯¹æ¯”
#vimdiff        #ä»¥vimæ–¹å¼æ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶å¯¹æ¯”,é«˜äº®æ˜¾ç¤ºä¸åŒçš„å†…å®¹
5.å¦‚æœviméæ­£å¸¸é€€å‡º(ctrl+z)æŒ‚èµ·æˆ–å¼ºåˆ¶é€€å‡ºç»ˆç«¯æ²¡å…³é—­vimå

å½“æˆ‘ä»¬å»ç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶çš„æ—¶ï¼Œæœ‰æ—¶ä¼šå‡ºç°ç½‘ç»œä¸­æ–­ã€æˆ–è€…è‡ªå·±æŒ‰äº†ä¸€ä¸‹ctrl+zï¼Œé€ æˆå¼‚å¸¸æƒ…å†µã€‚
    ç¼–è¾‘æ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€‰æ‹©ré”®ã€‚æ¢å¤åˆ°ä¿®æ”¹çš„çŠ¶æ€ã€‚
        å¯ä»¥é€‰æ‹©eé”®ã€‚æ¢å¤æ–‡ä»¶æ²¡ä¿å­˜çš„çŠ¶æ€ã€‚
    è®°å¾—æ–‡ä»¶æ¢å¤åï¼Œè®°å¾—å¹²æ‰.xxxçš„swpæ–‡ä»¶ ï¼ˆæˆ–è€…ç§»åŠ¨èµ°ï¼‰

#å‡è®¾æ‰“å¼€filenameæ–‡ä»¶è¢«æ„å¤–å…³é—­,éœ€è¦åˆ é™¤åŒæ–‡ä»¶åçš„.swpæ–‡ä»¶å³å¯è§£å†³
#rm -f .filename.swp
```



## 2.æŸ¥çœ‹æ–‡ä»¶å†…å®¹

### 2.1.æŸ¥çœ‹æ–‡ä»¶å†…å®¹ cat

```
å‚æ•°: -n:æŸ¥çœ‹æ–‡ä»¶å†…å®¹
	 -A:æŸ¥çœ‹æ–‡ä»¶ç‰¹æ®Šç¬¦å·
```

### 2.2.æŸ¥çœ‹å¤§æ–‡ä»¶ lessã€more

```
less /etc/services	#ä½¿ç”¨å…‰æ ‡ä¸Šä¸‹ç¿»åŠ¨ï¼Œç©ºæ ¼è¿›è¡Œç¿»é¡µï¼Œqé€€å‡º
more /etc/services	#ä½¿ç”¨å›è½¦ä¸Šä¸‹ç¿»åŠ¨ï¼Œç©ºæ ¼è¿›è¡Œç¿»é¡µï¼Œqé€€å‡º
```

### 2.3.æŸ¥çœ‹æ–‡ä»¶å‰åè¡Œhead

```
é»˜è®¤æŸ¥çœ‹æ–‡ä»¶å‰åè¡Œ
head /etc/passwd

å‚æ•°ï¼š -n5	#æŸ¥çœ‹å¤´éƒ¨å‰5è¡Œ
```

### 2.4.æŸ¥çœ‹æ–‡ä»¶ååè¡Œ tail

```
é»˜è®¤æŸ¥çœ‹æ–‡ä»¶ååè¡Œ
tali /etc/passwd

å‚æ•°ï¼š -n5 #æŸ¥çœ‹æ–‡ä»¶åäº”è¡Œ
	  -f  #åŠ¨æ€æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨ä¿¡æ¯ åŒç­‰talif

tali -f /var/log/secure
```

### 2.5.è¿‡æ»¤æ–‡ä»¶å†…å®¹ grep

```
grep "root" /etc/passwd		#åŒ¹é…åŒ…å«rootå…³é”®å­—çš„è¡Œ

å‚æ•°					ç¤ºä¾‹
^ ä»¥ä»€ä¹ˆå¼€å¤´çš„è¡Œ		grep "^root" /etc/passwd
$ ä»¥ä»€ä¹ˆç»“å°¾çš„è¡Œ		grep "/bin/bash$" /etc/passwd
-v å–å			   grep  -v "/bin/bash$" /etc/passwd
-i å¿½ç•¥å¤§å°å†™		 grep -i "root" /etc/passwd
-E å¤šæ¡ä»¶è¿‡æ»¤		 grep -E "sync|ftp" /etc/passwd


-n æŸ¥çœ‹è¿‡æ»¤çš„æ–‡ä»¶æ‰€åœ¨è¡Œ grep -n "root" /etc/passwd

grep -n -A 2 "Failed" /var/log/secure #åŒ¹é…æ–‡ä»¶ä¸­Failedå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°ä»–çš„ä¸‹ä¸¤è¡Œ
grep -n -B 2 "Failed" /var/log/secure #åŒ¹é…æ–‡ä»¶ä¸­Failedå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°ä»–çš„ä¸Šä¸¤è¡Œ
grep -n -C 2 "Failed" /var/log/secure #åŒ¹é…æ–‡ä»¶ä¸­Failedå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°ä»–çš„ä¸Šä¸‹å„ä¸¤è¡Œ
```

## 3.ä¸‹è½½æ–‡ä»¶

### 3.1. wget curl è”ç½‘ä¸‹è½½æ–‡ä»¶

**wget**

```
#centos7 ç³»ç»Ÿæœ€å°åŒ–å®‰è£…é»˜è®¤æ²¡æœ‰wgetå‘½ä»¤ï¼Œéœ€è¦å®‰è£…
#yum install wget -y

#ä¸‹è½½äº’è”ç½‘ä¸Šçš„æ–‡ä»¶è‡³æœ¬åœ°
#wget http://mirrors.aliyun.com/repo/Centos-7.repo

#-o æŒ‡å®šæ–‡ä»¶ä¸‹è½½ä½ç½®
#wget -o /etc/yum.repos.d/CentOs-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
```

**curl** 

```
åªcurlçš„è¯åªä¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹åŠ -oä¸‹è½½

curl -o /etc/yum.repos.d/CentOs-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
```

### 3.2. rz sz ä¸Šä¼ ä¸‹è½½æ–‡ä»¶

```
yum install lrzsz -y

#sz /opt/cc		ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°
#rz				ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

```

## 4.æ–‡ä»¶æˆ–å‘½ä»¤æŸ¥æ‰¾

### 4.1. which whereis å‘½ä»¤è·¯å¾„æŸ¥æ‰¾ 

```
which ls		#æŸ¥æ‰¾lså‘½ä»¤çš„ç»å¯¹è·¯å¾„
whereis ls		#æŸ¥æ‰¾å‘½ä»¤çš„ç»å¯¹è·¯å¾„ã€å¸®åŠ©æ‰‹å†Œç­‰
whereis -b ls	#-b ä»…æ˜¾ç¤ºå‘½ä»¤çš„æ‰€åœ¨è·¯å¾„
type -a ls		#æŸ¥çœ‹å‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼ˆåŒ…æ‹¬åˆ«åï¼‰
```

### 4.2. sort æ–‡ä»¶å†…å®¹æ’åº

å‚æ•°

```
-rï¼šå€’å™
-nï¼šæŒ‰æ•°å­—æ’åº
-tï¼šæŒ‡å®šåˆ†å‰²ç¬¦ï¼ˆé»˜è®¤ç©ºæ ¼ï¼‰
-kï¼šæŒ‡å®šç¬¬å‡ åˆ—ï¼ŒæŒ‡å®šç¬¬å‡ åˆ—å‡ å­—ç¬¦ï¼ˆæŒ‡å®š1,1 3.1,3.3)
```

```
ç»ƒä¹ æ–‡ä»¶
cat >> file.txt <<EOF
b:3
c:2
a:4
e:5
d:1
f:11
EOF

sort -t ":" -k2 file.txt  #-tæŒ‡å®šåˆ†å‰²ç¬¦ -kæŒ‡å®šåˆ—

sort -t ":" -k2 -n file.txt  #-tæŒ‡å®šåˆ†å‰²ç¬¦ -kæŒ‡å®šåˆ— -næŒ‰é˜¿æ‹‰ä¼¯æ•°å­—æ’åº

sort -t ":" -k2 -n -r file.txt  #-tæŒ‡å®šåˆ†å‰²ç¬¦ -kæŒ‡å®šåˆ— -næŒ‰é˜¿æ‹‰ä¼¯æ•°å­—æ’åº -rå€’å™æœ€å¤§çš„åœ¨ä¸Šé¢

sort -t ":" -k2 -nr file.txt | head -n3  #æå–å‰ä¸‰
psï¼š| ç®¡é“ï¼šå°†å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºç»“æœé€šè¿‡ç®¡é“äº¤ç»™å³è¾¹å‘½ä»¤çš„è¾“å…¥

ç»ƒä¹ äºŒï¼š
cat ip.txt
192.168.3.1 00:0F:AF:81:19:1F
192.168.3.2 00:0F:AF:85:6C:25
192.168.3.3 00:0F:AF:85:70:42
192.168.2.20 00:0F:AF:85:55:DE
192.168.2.21 00:0F:AF:85:6C:09
192.168.2.22 00:0F:AF:85:5C:41
192.168.0.151 00:0F:AF:85:6C:F6
192.168.0.152 00:0F:AF:83:1F:65
192.168.0.153 00:0F:AF:85:70:03
192.168.1.10 00:30:15:A2:3B:B6
192.168.1.11 00:30:15:A3:23:B7
192.168.1.12 00:30:15:A2:3A:A1
192.168.1.1 00:0F:AF:81:19:1F
192.168.2.2 00:0F:AF:85:6C:25
192.168.3.3 00:0F:AF:85:70:42
192.168.2.20 00:0F:AF:85:55:DE
192.168.1.21 00:0F:AF:85:6C:09
192.168.2.22 00:0F:AF:85:5C:41
192.168.0.151 00:0F:AF:85:6C:F6
192.168.1.152 00:0F:AF:83:1F:65
192.168.0.153 00:0F:AF:85:70:03
192.168.3.10 00:30:15:A2:3B:B6
192.168.1.11 00:30:15:A3:23:B7
192.168.3.12 00:30:15:A2:3A:A1

sort -t "." -k3.1,3.1 -k4.1,4.3 -n ip.txt
```

### 4.3.  uniq å»é‡å¹¶ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°

å¿…é¡»é…åˆsort ä¸€èµ·ä½¿ç”¨ï¼Œå…ˆæ’åºï¼Œç„¶åå»é‡ç»Ÿè®¡

**å‚æ•°**

```
-c è®¡ç®—é‡å¤çš„æ¬¡æ•°ï¼Œå¿…é¡»æŒ¨ç€çš„ç›¸åŒè¡Œ
```

```
ç»ƒä¹ æ–‡ä»¶
cat >>file3.txt <<EOF
abc
123
abc
123
EOF

sort file3.txt | uniq	#å»é‡ä¸ç»Ÿè®¡
sort file3.txt | uniq -c	#-cå»é‡ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°
```

### 4.4. cut æˆªå–å­—æ®µ é…åˆç®€å•äº†è§£ä½¿ç”¨sed swk

```
é€‰é¡¹ï¼š
-dï¼šæŒ‡å®šåˆ†å‰²ç¬¦
-fï¼šæ•°å­—ï¼Œå–ç¬¬å‡ åˆ— -f3,6ä¸‰åˆ—å’Œ6åˆ—
-cï¼šæŒ‰å­—ç¬¦å–ï¼ˆç©ºæ ¼ä¹Ÿç®—ï¼‰

1.äº§ç”Ÿæ–‡ä»¶
# echo "Im oldxu, is QQ 552408925" > oldboy.txt

2.éœ€æ±‚ï¼šè¿‡æ»¤å‡ºoldboy.txtæ–‡ä»¶é‡Œ oldxuä»¥åŠ552408925
3.å¦‚ä½•å®ç°ï¼š
å®ç°æ–¹æ³•1ï¼š
[root@oldboy ~]# cut -d " " -f 2,5 oldboy.txt
oldxu, 552408925
[root@oldboy ~]# cut -d " " -f 2,5 oldboy.txt  | sed 's#,##g'
oldxu 552408925

å®ç°æ–¹æ³•2ï¼š
[root@oldboy ~]# awk  '{print $2,$5}' oldboy.txt
oldxu, 552408925
[root@oldboy ~]# awk  '{print $2,$5}' oldboy.txt | sed 's#,##g'
oldxu 552408925

å®ç°æ–¹æ³•3ï¼š awkå¤„ç†
[root@oldboy ~]# awk -F "," '{print $1,$2}' oldboy.txt  | awk '{print $2,$5}'
oldxu 552408925


[root@oldboy ~]# awk -F "[ ,]" '{print $2,$6}' oldboy.txt
oldxu 552408925

é«˜çº§ç”¨æ³•
[ ,]+   +è¡¨ç¤ºé‡å¤	å‰é¢çš„å­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡   
	ç©ºæ ¼ç®—ä¸€ä¸ªåˆ†éš”ç¬¦
	é€—å·ç®—ä¸€ä¸ªåˆ†éš”ç¬¦
	ç©ºæ ¼å’Œé€—å·æŒ¨åœ¨ä¸€èµ·ï¼Œä¹Ÿç®—ä¸€ä¸ªåˆ†éš”ç¬¦
	ç©ºæ ¼é€—å·ç©ºæ ¼ï¼Œå…¨ç®—ä¸€ä¸ªåˆ†éš”ç¬¦
[root@oldboy ~]# awk -F "[ ,]+" '{print $2,$5}' oldboy.txt
oldxu 552408925
```

### 4.5. wc ç»Ÿè®¡æ–‡ä»¶å¤šå°‘è¡Œ

```
é€‰é¡¹ï¼š
-l	æ˜¾ç¤ºæ–‡ä»¶è¡Œæ•°
-c	æ˜¾ç¤ºæ–‡ä»¶å­—èŠ‚
-w	æ˜¾ç¤ºæ–‡ä»¶å•è¯
```

ç»ƒä¹ ç»Ÿè®¡ä¸€ä¸ªæ–‡ä»¶æœ‰å¤šå°‘è¡Œ

```
æ–¹æ³•ä¸€ï¼š
# wc -l /etc/services
11176 /etc/services

æ–¹æ³•äºŒï¼š
# cat -n /etc/services |tail -1 |awk '{print $1}'

æ–¹æ³•ä¸‰ï¼š
# grep -n ".*" /etc/services |tail -1 |awk -F ":" '{print $1}'

æ–¹æ³•å››ï¼šä»…ä¾›å‚è€ƒï¼ï¼ï¼ï¼ï¼ï¼ï¼ä¸çº ç»“
NR: è¡Œå·
$0: awkæ˜¯é€è¡Œå¤„ç†æ–‡ä»¶çš„ï¼Œè¯»å…¥ä¸€è¡Œï¼Œç„¶åå°†ä¸€è¡Œçš„å†…å®¹èµ‹å€¼ç»™$0å˜é‡ï¼Œ
# awk '{print NR,$0}' /etc/services  | tail -1 | awk '{print $1}'
11176

```

#ç»ƒä¹ é¢˜: è¿‡æ»¤å‡º/etc/passwdä»¥nologinç»“å°¾çš„å†…å®¹ï¼Œå¹¶ç»Ÿè®¡æœ‰å¤šå°‘è¡Œ

```
	è¿‡æ»¤ï¼š grep   /etc/passwd
	æ¡ä»¶ï¼š nologinç»“å°¾çš„
	å¹¶ä¸”ï¼š
	ç»Ÿè®¡å‡ºç°çš„å†…å®¹æ€»å…±æœ‰å¤šå°‘è¡Œï¼š wc -l

[root@oldboy ~]# grep "nologin$" /etc/passwd | wc -l
19
```

ç»ƒä¹ é¢˜ï¼š

```
åˆ†æå¦‚ä¸‹æ—¥å¿—ï¼Œç»Ÿè®¡æ¯ä¸ªåŸŸåè¢«è®¿é—®çš„æ¬¡æ•°ã€‚
[root@student tmp]# cat >>web.log<<EOF 
http://www.xuliangwei.com/index.html
http://www.xuliangwei.com/1.html
http://post.xuliangwei.com/index.html
http://mp3.xuliangwei.com/index.html
http://www.xuliangwei.com/3.html
http://post.xuliangwei.com/2.html
EOF

æ€è·¯ï¼š
	1.è¦æƒ³åŠæ³•æå–åŸŸå
	2.æ’åºï¼Œå°†ç›¸åŒçš„åŸŸåç½—åˆ—åœ¨ä¸€èµ·
	3.å»é‡ï¼Œç»Ÿè®¡

å®ç°ï¼š
[root@oldboy ~]# awk -F '/' '{print $3}' web.log | sort | uniq -c
      1 mp3.xuliangwei.com
      2 post.xuliangwei.com
      3 www.xuliangwei.com

å°†è®¿é—®æ¬¡æ•°æœ€å¤šçš„æ’åœ¨ä¸Šé¢
[root@oldboy ~]# awk -F '/' '{print $3}' web.log | sort | uniq -c  | sort -nr
      3 www.xuliangwei.com
      2 post.xuliangwei.com
      1 mp3.xuliangwei.com


----------------------------ä¸‹åˆ-------------------------------
ä¹ é¢˜1: ä½¿ç”¨awkå–å‡ºç³»ç»Ÿçš„IPåœ°å€ï¼Œæ€è·¯å¦‚ä¸‹:
	1.æˆ‘è¦å–çš„IPå€¼åœ¨å“ªé‡Œ	 ifconfig
	2.å¦‚ä½•ç¼©å°å–å€¼èŒƒå›´(è¡Œ)
	3.å¦‚ä½•ç²¾ç¡®å…·ä½“å†…å®¹(åˆ—)

æ–¹å¼1ï¼š
[root@oldboy ~]# ifconfig eth0 | head -2 | tail -1 | awk '{print $2}'
172.16.1.53

æ–¹å¼2ï¼š
[root@oldboy ~]# ifconfig eth0 | grep "netmask" | awk '{print $2}'
172.16.1.53


ä¹ é¢˜2: å°†/etc/passwdæ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œä¸­çš„ç¬¬ä¸€åˆ—å’Œæœ€åä¸€åˆ—ä½ç½®è¿›è¡Œäº¤æ¢ã€‚ï¼ˆè‡ªè¡ŒæŒ‡å®šä»¥ï¼šä¸ºåˆ†éš”ç¬¦ï¼‰
	æºæ–‡ä»¶ï¼šroot:x:0:0:root:/root:/bin/bash
	æ”¹å˜åï¼š/bin/bash:x:0:0:root:/root:root


ä¹ é¢˜3: å°†/etc/sysconfig/selinux æ–‡ä»¶ä¸­çš„SELINUX=enforcingæ›¿æ¢æˆSELINUX=disabled
```

## 5.ç”¨æˆ·ç®¡ç†

### 5.1.useradd åˆ›å»ºç”¨æˆ·

```bash
adduserå‘½ä»¤è½¯è¿æ¥æŒ‡å‘useraddå‘½ä»¤
#é€‰é¡¹
# -u    æŒ‡å®šè¦åˆ›å»ºçš„ç”¨æˆ·UIDï¼Œä¸å…è®¸å†²çª
# -g    æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·é»˜è®¤ç»„
# -G    æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·é™„åŠ ç»„ï¼Œé€—å·éš”å¼€å¯æ·»åŠ å¤šä¸ªé™„åŠ ç»„
# -s    æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·çš„bash shell
# -c    æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·çš„æ³¨é‡Šä¿¡æ¯

# -d    æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·çš„å®¶ç›®å½•
# -M    ç»™åˆ›å»ºçš„ç”¨æˆ·ä¸åˆ›å»ºå®¶ç›®å½•
# -r    åˆ›å»ºç³»ç»Ÿç”¨æˆ·ï¼Œé»˜è®¤æ— å®¶ç›®å½•

1.åˆ›å»ºkkç”¨æˆ·ï¼ŒUID5001ï¼ŒåŸºæœ¬ç»„studentsï¼Œé™„åŠ ç»„sa æ³¨é‡Šä¿¡æ¯ï¼š2021 new studentï¼Œç™»å½•shell:/bin/bash
2.åˆ›å»ºmysqlç³»ç»Ÿç”¨æˆ·ï¼Œ-Mä¸åˆ›å»ºç”¨æˆ·çš„å®¶ç›®å½• -sæŒ‡å®šnologinä½¿ç”¨å…¶ä»–ç”¨æˆ·æ— æ³•ç™»å½•ç³»ç»Ÿ
æ–¹æ³•äºŒï¼š-Mä¸ç»™ç”¨æˆ·åˆ›å»ºå®¶ç›®å½•ï¼Œå¹¶æŒ‡å®šç™»å½•çš„bashæ˜¯/sbin/nologin
```

### 5.2.usermod ä¿®æ”¹ç”¨æˆ·

```bash
#é€‰é¡¹
# -u æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„UID
# -g æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ç»„
# -G æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·é™„åŠ ç»„ï¼Œä½¿ç”¨é€—å·éš”å¼€å¤šä¸ªé™„åŠ ç»„, è¦†ç›–åŸæœ‰çš„é™„åŠ ç»„
# -d æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·å®¶ç›®å½•
# -s æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„bash shell
# -c æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·æ³¨é‡Šä¿¡æ¯

# -l æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„ç™»é™†å
# -L æŒ‡å®šè¦é”å®šçš„ç”¨æˆ·
# -U æŒ‡å®šè¦è§£é”çš„ç”¨æˆ·

#4ã€é”å®šç”¨æˆ·ã€æ‰©å±•ã€‘
# echo "123" |passwd --stdin username
# usermod -L username  #é”å®šåä¼šæ— æ³•ç™»é™†ç³»ç»Ÿ

#5ã€è§£é”ç”¨æˆ·ã€æ‰©å±•ã€‘
# usermod -U username
```

### 5.3.userdel åˆ é™¤ç”¨æˆ·

```bash
#é€‰é¡¹ -r åˆ é™¤ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œä»¥åŠç”¨æˆ·çš„é‚®ä»¶ 
```

### 5.4.passwd ä¿®æ”¹ç”¨æˆ·å¯†ç 

```bash
1ã€ä½¿ç”¨passwdå‘½ä»¤ä¿®æ”¹ç”¨æˆ·å¯†ç 
# passwd        #ç»™å½“å‰ç”¨æˆ·ä¿®æ”¹å¯†ç 
# passwd root   #ç»™rootç”¨æˆ·ä¿®æ”¹å¯†ç (åªèƒ½æ˜¯rootæ‰æœ‰æ­¤æƒé™ï¼Œå…¶ä»–ä»»ä½•ç”¨æˆ·éƒ½æ²¡æœ‰è¯¥æƒé™)
# passwd kk #ç»™kkç”¨æˆ·ä¿®æ”¹å¯†ç ï¼ˆrootå¯ä»¥ï¼Œæˆ–è€…kkç”¨æˆ·è‡ªå·±ç»™è‡ªå·±ä¿®æ”¹å¯†ç ï¼‰

2ã€é€šè¿‡passwd --stdinè¯»å–è¾“å‡ºçš„ç»“æœï¼Œå°†ç»“æœèµ‹å€¼ç»™å¯¹åº”çš„ç”¨æˆ·
# echo "123" | passwd --stdin kk    #éäº¤äº’å¼ä¿®æ”¹å¯†ç 
```

**PS: æ¨èå¯†ç ä¿å­˜å¥—ä»¶å·¥å…·ï¼Œæ”¯æŒwindowsã€MacOSã€Iphoneä»¥åŠæµè§ˆå™¨æ’ä»¶Lastpasså®˜æ–¹ç½‘ç«™**

### 5.5.mkpasswd ç”Ÿæˆéšæœºæ•°

```bash
    é€‰é¡¹ï¼š
    -l   è®¾å®šå¯†ç é•¿åº¦,
    -d   æ•°å­,
    -c   å°å†™å­—æ¯,
    -C   å¤§å†™å­—æ¯,
    -s   ç‰¹æ®Šå­—ç¬¦
    
[root@docker01 ~]# yum install expect -y

#æ³¨æ„ï¼šå„ç§ç‰¹æ®Šå­—ç¬¦çš„ä½æ•°åŠ èµ·æ¥ï¼Œä¸èƒ½è¶…è¿‡-læŒ‡å®šçš„é•¿åº¦
[root@docker01 ~]# mkpasswd -l 10 -d 2 -c 3 -C 3 -s 2
[ks1KOmZ8$
```

### 5.6. su sudoææƒ

**1ã€su ææƒ**

 **æ™®é€šç”¨æˆ·su -å¯ä»¥ç›´æ¥åˆ‡æ¢è‡³rootç”¨æˆ·ï¼Œä½†éœ€è¦è¾“å…¥rootç”¨æˆ·çš„å¯†ç ã€‚ è¶…çº§ç®¡ç†å‘˜rootç”¨æˆ·ä½¿ç”¨su - usernameåˆ‡æ¢æ™®é€šç”¨æˆ·ä¸éœ€è¦è¾“å…¥ä»»ä½•å¯†ç **

```bash
su - username	å±äºç™»é™†å¼shell
su 	username	å±äºéç™»é™†å¼shell
åŒºåˆ«åœ¨äºåŠ è½½çš„ç¯å¢ƒå˜é‡ä¸ä¸€æ ·

#1.æ™®é€šç”¨æˆ·ä½¿ç”¨suåˆ‡æ¢root
[root@test01 home]$ su 

#2.æ™®é€šç”¨æˆ·ä½¿ç”¨su -åˆ‡æ¢åˆ°rootï¼Œä¼šåŠ è½½rootçš„ç¯å¢ƒå˜é‡
[kk@test01 home]$ su -

#3.ä»¥æŸä¸ªç”¨æˆ·çš„èº«ä»½æ‰§è¡ŒæŸä¸ªæœåŠ¡ï¼Œä½¿ç”¨å‘½ä»¤su -c username
[root@test01 ~]# su - kk -c 'ls /home'
```

**2ã€sudo ææƒ**

1.å¦‚ä½•å¿«é€ŸåŸ‹ä¸‹hulkçš„ç§å­å‘¢ï¼Ÿ

```bash
#1.å¿«é€Ÿé…ç½®sudoæ–¹å¼[å…ˆç¹ä¸ºå¿«]wheelç»„
[root@test01 ~]# usermod kk -G wheel
[root@test01 ~]# id kk
uid=1005(kk) gid=1005(kk) groups=1005(kk),10(wheel)
[root@test01 ~]# gpasswd -d kk wheel   #åˆ é™¤é™„åŠ ç»„
Removing user kk from group wheel
[root@test01 ~]# id kk
uid=1005(kk) gid=1005(kk) groups=1005(kk)

[root@node1 ~]$ sudo tail -f /var/log/secure    #sudoå®¡è®¡æ—¥å¿—

#2.ä¸€èˆ¬æ­£å¸¸é…ç½®sudoæ–¹å¼
[root@test01 ~]# #visudo => vim /etc/sudoers
#1.ç”¨æˆ·å  2.ä¸»æœºå=(è§’è‰²åï¼‰       4.å‘½ä»¤å
bgx       ALL=(ALL)         /usr/bin/yum,/usr/sbin/useradd   #å…è®¸ä½¿ç”¨sudoæ‰§è¡Œå‘½ä»¤
oldboy   ALL=(ALL)          NOPASSWD:/bin/cp, /bin/rm   #NOPASSWDä¸éœ€è¦ä½¿ç”¨å¯†ç 
```

2.åŸ‹ä¸‹äº†hulkç§å­ååˆå¦‚ä½•ææƒä½¿ç”¨å‘¢ï¼Ÿ

```bash
#1.åˆ‡æ¢æ™®é€šç”¨æˆ·
[root@test01 ~]# su - kk

#2.æ£€æŸ¥æ™®é€šç”¨æˆ·èƒ½ææƒçš„å‘½ä»¤
[root@test01 ~]$ sudo -l
User kk may run the following commands on this host:
    (ALL) ALL

#3.æ™®é€šç”¨æˆ·æ­£å¸¸æƒ…å†µä¸‹æ˜¯æ— æ³•åˆ é™¤optç›®å½•çš„
[root@test01 ~]$ rm -rf /opt/
rm: cannot remove `/opt: Permission denied

#4.ä½¿ç”¨sudoææƒï¼Œéœ€è¦è¾“å…¥æ™®é€šç”¨æˆ·çš„å¯†ç ã€‚
[root@test01 ~]$ sudo rm -rf /opt
```

**3.æå‡çš„æƒé™å¤ªå¤§ï¼Œèƒ½å¦æœ‰åŠæ³•é™åˆ¶ä»…å¼€å¯æŸä¸ªå‘½ä»¤çš„ä½¿ç”¨æƒé™ï¼Ÿå…¶ä»–å‘½ä»¤ä¸å…è®¸ï¼Ÿ**

```bash
ç¬¬ä¸€ç§æ–¹å¼:ä½¿ç”¨sudoä¸­è‡ªå¸¦çš„åˆ«åæ“ä½œ,å°†å¤šä¸ªç”¨æˆ·å®šä¹‰æˆä¸€ä¸ªç»„,è¿™ä¸ªç»„åªæœ‰sudoè®¤å¯
#ç¼–è¾‘sudoé…ç½®
[root@test01 ~]# visudo 
â€‹
# 1.ä½¿ç”¨sudoå®šä¹‰åˆ†ç»„,è¿™ä¸ªç³»ç»Ÿgroupæ²¡ä»€ä¹ˆå…³ç³»
User_Alias OPS = qq,ww
User_Alias DBA = kk,gg
â€‹
# 2.å®šä¹‰å¯æ‰§è¡Œçš„å‘½ä»¤ç»„, ä¾¿äºåç»­è°ƒç”¨
Cmnd_Alias NETWORKING = /sbin/ifconfig, /bin/ping
Cmnd_Alias SOFTWARE = /bin/rpm, /usr/bin/yum
Cmnd_Alias SERVICES = /sbin/service, /usr/bin/systemctl start
Cmnd_Alias STORAGE = /bin/mount, /bin/umount
Cmnd_Alias DELEGATING = /bin/chown, /bin/chmod, /bin/chgrp
Cmnd_Alias PROCESSES = /bin/nice, /bin/kill, /usr/bin/kill, /usr/bin/killall
â€‹
# 3.ä½¿ç”¨sudoå¼€å§‹åˆ†é…æƒé™
OPS  ALL=(ALL) NETWORKING,SOFTWARE,SERVICES,STORAGE,DELEGATING,PROCESSES
DBA  ALL=(ALL) SOFTWARE,PROCESSES
â€‹
#4.ç™»é™†å¯¹åº”çš„ç”¨æˆ·ä½¿ç”¨ sudo -l éªŒè¯æƒé™
æ–¹å¼äºŒï¼šé’ˆå¯¹ç³»ç»Ÿä¸­çœŸå®çš„ç»„æ¥è¿›è¡Œæ“ä½œ
```

### 5.7.-bash-4.1$ æ¢å¤

```bash
#æ•…éšœæ¡ˆä¾‹ï¼Œåœ¨å½“å‰ç”¨æˆ·å®¶ç›®å½•æ‰§è¡Œäº†rm -rf .*ï¼Œä¸‹æ¬¡ç™»å½•ç³»ç»Ÿæ—¶å‡ºç°-bash-4.1$ï¼Œå¦‚ä½•è§£å†³ï¼
-bash-4.1$ cp -a /etc/skel/.bash* ./
-bash-4.1$ exit
[root@text01 ~]#   #é‡æ–°è¿æ¥å³å¯æ¢å¤
```

## 6.ç»„ç®¡ç†

### 6.1.groupadd åˆ›å»ºç»„

```bash
#é€‰é¡¹
# -u æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·çš„UID,ä¸å…è®¸å†²çª
# -g æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·é»˜è®¤ç»„
# -G æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·é™„åŠ ç»„,é€—å·éš”å¼€å¯æ·»åŠ å¤šä¸ªé™„åŠ ç»„
# -d æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·å®¶ç›®å½•
# -s æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·çš„bash shell
# -c æŒ‡å®šè¦åˆ›å»ºç”¨æˆ·æ³¨é‡Šä¿¡æ¯
# -M ç»™åˆ›å»ºçš„ç”¨æˆ·ä¸åˆ›å»ºå®¶ç›®å½•
# -r åˆ›å»ºç³»ç»Ÿè´¦æˆ·ï¼Œé»˜è®¤æ— å®¶ç›®å½•
```



### 6.2.groupmod ä¿®æ”¹ç»„

```bash
#é€‰é¡¹
# -u æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„UID
# -g æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ç»„
# -G æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·é™„åŠ ç»„ï¼Œä½¿ç”¨é€—å·éš”å¼€å¤šä¸ªé™„åŠ ç»„, è¦†ç›–åŸæœ‰çš„é™„åŠ ç»„
# -d æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·å®¶ç›®å½•
# -s æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„bash shell
# -c æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·æ³¨é‡Šä¿¡æ¯
# -l æŒ‡å®šè¦ä¿®æ”¹ç”¨æˆ·çš„ç™»é™†å
# -L æŒ‡å®šè¦é”å®šçš„ç”¨æˆ·
# -U æŒ‡å®šè¦è§£é”çš„ç”¨æˆ·
```

### 6.3.groupdel åˆ é™¤ç»„

```bash
#é€‰é¡¹ -r åˆ é™¤ç”¨æˆ·åŒæ—¶åˆ é™¤å®ƒçš„å®¶ç›®å½•
[root@oldboy ~]# useradd ttboy -g active_gid
[root@oldboy ~]# useradd ggboy -G active_gid

[root@oldboy ~]# grep "active_gid" /etc/group
active_gid:x:12345:ggboy


[root@oldboy ~]# groupdel active_gid
groupdelï¼šä¸èƒ½ç§»é™¤ç”¨æˆ·â€œttboyâ€çš„ä¸»ç»„

#ç§»é™¤ä¸»è¦çš„æˆå‘˜ï¼Œå°±èƒ½åˆ é™¤è¯¥ç»„
[root@oldboy ~]# userdel ttboy
[root@oldboy ~]# groupdel active_gid

[root@oldboy ~]# id ggboy
uid=6009(ggboy) gid=12346(ggboy) ç»„=12346(ggboy)

#1.åˆ é™¤user1ç”¨æˆ·ï¼Œä½†ä¸åˆ é™¤ç”¨æˆ·å®¶ç›®å½•å’Œ mail spool
[root@bgx ~]# userdel user1

#2.-rå‚æ•°å¯ä»¥è¿åŒç”¨æˆ·å®¶ç›®å½•ä¸€èµ·åˆ é™¤(æ…ç”¨)
[root@bgx ~]# userdel -r user1

æ³¨æ„ï¼šåˆ é™¤ä¸€ä¸ªç»„ï¼Œå¿…é¡»ç¡®ä¿è¯¥ç»„çš„ä¸»è¦æˆå‘˜å·²ç»ç§»é™¤è¯¥ç»„ï¼Œå°±å¯ä»¥æ­£å¸¸åˆ é™¤ã€‚ï¼ˆé™„åŠ è¿›æ¥çš„æˆå‘˜æ— éœ€è€ƒè™‘åœ¨å†…ã€‚ï¼‰
```

## 7.æƒé™ç®¡ç†

### 7.1chmod  ä¿®æ”¹æ–‡ä»¶rwxæƒé™

```bash
#-Rå‚æ•°é€’å½’ä¿®æ”¹
#é’ˆå¯¹ç›®å½•è®¾å®šæƒé™
[root@web ~]# mkdir dir
[root@web ~]# chmod 777 dir/    #ä¿®æ”¹ç›®å½•å…è®¸æ‰€æœ‰äººè®¿é—®
[root@web ~]# chmod -R 755 dir/ #ä¿®æ”¹ç›®å½•åŠå­ç›®å½•æƒé™
[root@web ~]# ll -d dir/
drwxr-xr-x 2 root root 6 Apr 13 03:34 dir/

é’ˆå¯¹ hr éƒ¨é—¨çš„è®¿é—®ç›®å½•/home/hr è®¾ç½®æƒé™ï¼Œè¦æ±‚å¦‚ä¸‹:
1.root ç”¨æˆ·å’Œ hr ç»„çš„å‘˜å·¥å¯ä»¥è¯»ã€å†™ã€æ‰§è¡Œ
2.å…¶ä»–ç”¨æˆ·æ²¡æœ‰ä»»ä½•æƒé™

[root@web ~]# groupadd hr
[root@web ~]# useradd hr01 -G hr
[root@web ~]# useradd hr02 -G hr
[root@web ~]# useradd hr03
[root@web ~]# mkdir /home/hr
[root@web ~]# chgrp hr /home/hr
[root@web ~]# chmod 770 /home/hr
[root@web ~]# ll -d /home/hr
drwxrwx--- 2 root hr 6 Apr 13 03:26 /home/hr



hr01å’Œhr02éƒ½èƒ½å®Œæˆå¦‚ä¸‹æ“ä½œ
	touch /home/hr/file
	ll /home/hr

hr03ï¼š ä»–ä¸ä¼šè¿™ä¸ªç›®å½•çš„æ‰€å±ä¸»ï¼Œä¹Ÿä¸æ˜¯hrç»„çš„æˆå‘˜ï¼Œæ‰€ä»¥æŒ‰ç…§å…¶ä»–æƒé™çš„èº«ä»½å»è®¿é—®ï¼š
	å…¶ä»–äººçš„æƒé™èº«ä»½ --- ï¼Œæ‰€ä»¥ hr03 æ²¡æœ‰ä»»ä½•çš„æƒé™
	hr03ç”¨æˆ·æ— æ³•è¿›å…¥ /home/hr   ä¹Ÿæ— æ³• ls /home/hr æµè§ˆ

       å› ä¸ºhr03ç”¨æˆ·ï¼Œæ—¢ä¸æ˜¯å±ä¸»èº«ä»½ï¼Œä¹Ÿä¸æ˜¯ä»–çš„å±ç»„èº«ä»½ï¼Œæ‰€ä»¥å°±æŒ‰ç…§å…¶ä»–äººçš„èº«ä»½è®¿é—®ï¼Œå°±è¦å—åˆ°å…¶ä»–äººæƒé™çº¦æŸ
```

### 7.2 chown ä¿®æ”¹æ–‡ä»¶å±ä¸»å±ç»„

```bash
#å‚æ•°-R é€’å½’ä¿®æ”¹

#1.å˜æ›´æ–‡ä»¶çš„å±ä¸»å’Œå±ç»„
[root@web ~]# chown kk.kk access-2020-03-12.log
[root@web ~]# ll access-2020-03-12.log
-rw-r--r--. 1 kk kk 58112885 3æœˆ  13 09:25 access-2020-03-12.log

#2.ä»…å˜æ›´æ–‡ä»¶çš„å±ç»„
[root@web ~]# chown .root access-2020-03-12.log
[root@web ~]# ll access-2020-03-12.log
-rw-r--r--. 1 kk root 58112885 3æœˆ  13 09:25 access-2020-03-12.log

#3.ä½¿ç”¨chgrpç›´æ¥å˜æ›´æ–‡ä»¶çš„å±ç»„ï¼ˆåªèƒ½æ˜¯å±ç»„ï¼Œä¸èƒ½æ˜¯å…¶ä»–ï¼‰

[root@web ~]# chgrp kk access-2020-03-12.log
[root@web ~]# ll access-2020-03-12.log
-rw-r--r--. 1 kk kk 58112885 3æœˆ  13 09:25 access-2020-03-12.log
```

### 7.3 ç‰¹æ®Šæƒé™ suid sgid sbit

```bash
æ–‡ä»¶æƒé™æ ‡å¿— suidï¼ˆSet User IDï¼‰ï¼Œsgidï¼ˆSet Group IDï¼‰å’Œ sbitï¼ˆSticky Bitï¼‰æ˜¯ UNIX å’Œç±» UNIX æ“ä½œç³»ç»Ÿä¸‹ä¸€äº›ç‰¹æ®Šæƒé™ï¼Œç”¨äºå¤„ç†ç‰¹å®šåœºæ™¯çš„æ–‡ä»¶è®¿é—®å’Œæ‰§è¡Œã€‚ä»¥ä¸‹æ˜¯å¯¹è¿™äº›æƒé™çš„ç®€è¦è¯´æ˜ï¼š

#suid (Set User ID):
å½“ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰ suid æƒé™ï¼Œå¹¶è¢«æ‰§è¡Œæ—¶ï¼Œè¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ· ID å°†è¢«è®¾ç½®ä¸ºæ–‡ä»¶æ‰€æœ‰è€…çš„ç”¨æˆ· IDã€‚è¿™æ„å‘³ç€ï¼Œè¿è¡Œè¯¥ç¨‹åºçš„ç”¨æˆ·å°†è·å¾—ä¸æ–‡ä»¶æ‰€æœ‰è€…ç›¸åŒçš„è®¿é—®æƒé™ã€‚
é€šå¸¸é€‚ç”¨äºå…è®¸éç‰¹æƒç”¨æˆ·æ‰§è¡Œç‰¹æƒä»»åŠ¡çš„æƒ…å†µã€‚
ä½¿ç”¨ chmod u+s filename æˆ– chmod 4xxxï¼ˆåŸæƒé™ï¼‰ filename ç»™æŸä¸ªæ–‡ä»¶è®¾ç½® suid æ ‡å¿—ã€‚
ä½¿ç”¨ ls å‘½ä»¤æ—¶ï¼Œæ–‡ä»¶æƒé™ä¸­çš„ "x"ï¼ˆæ‰§è¡Œæƒé™ï¼‰å°†è¢«æ›¿æ¢ä¸º "s"ã€‚

#sgid (Set Group ID):
å½“ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰ sgid æƒé™ï¼Œå¹¶è¢«æ‰§è¡Œæ—¶ï¼Œè¿›ç¨‹çš„æœ‰æ•ˆç»„ ID å°†è¢«è®¾ç½®ä¸ºæ–‡ä»¶æ‰€æœ‰è€…çš„ç»„ IDã€‚ä¸ suid ç±»ä¼¼ï¼Œæ‰§è¡Œç¨‹åºçš„ç”¨æˆ·å°†è·å¾—ä¸æ–‡ä»¶æ‰€æœ‰è€…åŒç»„ç”¨æˆ·çš„è®¿é—®æƒé™ã€‚
å½“åœ¨ç›®å½•ä¸Šè®¾ç½® sgid æ ‡å¿—æ—¶ï¼Œæ–°å»ºçš„å­ç›®å½•å’Œæ–‡ä»¶å°†ç»§æ‰¿ç›®å½•çš„ç»„ IDï¼Œè€Œä¸æ˜¯ä½¿ç”¨åˆ›å»ºå®ƒä»¬çš„ç”¨æˆ·çš„ç»„ IDã€‚
ä½¿ç”¨ chmod g+s filename æˆ– chmod 2xxxï¼ˆåŸæƒé™ï¼‰ filename ç»™æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•è®¾ç½® sgid æ ‡å¿—ã€‚
ä½¿ç”¨ ls å‘½ä»¤æ—¶ï¼Œæ–‡ä»¶æƒé™ä¸­çš„ "x"ï¼ˆæ‰§è¡Œæƒé™ï¼‰å°†è¢«æ›¿æ¢ä¸º "s"ã€‚

#sbit (Sticky Bit):
é€šå¸¸åœ¨ç›®å½•ä¸Šè®¾ç½®ã€‚Sticky Bit ç”¨äºä¿æŠ¤ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ å½“åœ¨ç›®å½•ä¸Šè®¾ç½® Sticky Bit æ ‡å¿—æ—¶ï¼Œåªæœ‰æ–‡ä»¶æˆ–å­ç›®å½•çš„æ‰€æœ‰è€…ã€ç›®å½•çš„æ‰€æœ‰è€…å’Œ root ç”¨æˆ·æ‰èƒ½é‡å‘½åã€ç§»åŠ¨æˆ–åˆ é™¤å…¶ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ å…¶ä»–ç”¨æˆ·å³ä½¿æ‹¥æœ‰å†™å…¥æƒé™ä¹Ÿæ— æ³•è¿›è¡Œæ­¤ç±»æ“ä½œã€‚
ä½¿ç”¨ chmod o+t dirname æˆ– chmod 1xxxï¼ˆåŸæƒé™ï¼‰ dirname ç»™æŸä¸ªç›®å½•è®¾ç½® Sticky Bit æ ‡å¿—ã€‚
ä½¿ç”¨ ls å‘½ä»¤æ—¶ï¼Œæ–‡ä»¶æƒé™ä¸­çš„ "x"ï¼ˆæ‰§è¡Œæƒé™ï¼‰å°†è¢«æ›¿æ¢ä¸º "t"ã€‚
åœ¨ UNIX å’Œç±» UNIX æ“ä½œç³»ç»Ÿä¸‹é€šè¿‡å‘½ä»¤ ls -l å¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„æƒé™ï¼Œè¿™äº›ç‰¹æ®Šæƒé™å¯æ˜¾ç¤ºä¸º "s" æˆ– "t"ï¼Œå–å†³äºå…·ä½“è®¾ç½®çš„æ ‡å¿—ã€‚
```

## 8.é‡å®šå‘

å½“**è¿è¡Œä¸€ä¸ªç¨‹åº**æ—¶é€šå¸¸ä¼šè‡ªåŠ¨æ‰“å¼€**ä¸‰ä¸ªæ ‡å‡†æ–‡ä»¶**ï¼Œåˆ†åˆ«æ˜¯æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€é”™è¯¯è¾“å‡º

```undefined
æ ‡å‡†è¾“å…¥ï¼šé”®ç›˜ï¼Œè¾“å…¥çš„å†…å®¹ï¼Œæˆ–è€…æ˜¯é€šè¿‡å…¶ä»–æ–¹å¼è¯»å…¥çš„å†…å®¹
æ ‡å‡†è¾“å‡ºï¼šå½“æ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›çš„æ­£ç¡®ç»“æœ
é”™è¯¯è¾“å‡ºï¼šå½“æ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›çš„é”™è¯¯ç»“æœ
```

### 8.1 è¾“å‡ºé‡å®šå‘

**è¾“å‡ºé‡å®šå‘ï¼Œæ”¹å˜è¾“å‡ºå†…å®¹çš„ä½ç½®ã€‚è¾“å‡ºé‡å®šå‘æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼Œå¦‚è¡¨æ ¼æ‰€ç¤º**

| ç±»å‹               | æ“ä½œç¬¦ | ç”¨é€”                                                         |
| :----------------- | :----- | :----------------------------------------------------------- |
| æ ‡å‡†è¦†ç›–è¾“å‡ºé‡å®šå‘ | >      | å°†ç¨‹åºè¾“å‡ºçš„æ­£ç¡®ç»“æœè¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­,ä¼šè¦†ç›–æ–‡ä»¶åŸæœ‰çš„å†…å®¹  |
| æ ‡å‡†è¿½åŠ è¾“å‡ºé‡å®šå‘ | >>     | å°†ç¨‹åºè¾“å‡ºçš„æ­£ç¡®ç»“æœä»¥è¿½åŠ çš„æ–¹å¼è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶ |
| é”™è¯¯è¦†ç›–è¾“å‡ºé‡å®šå‘ | 2>     | å°†ç¨‹åºçš„é”™è¯¯ç»“æœè¾“å‡ºåˆ°æ‰§è¡Œçš„æ–‡ä»¶ä¸­ï¼Œä¼šè¦†ç›–æ–‡ä»¶åŸæœ‰çš„å†…å®¹     |
| é”™è¯¯è¿½åŠ è¾“å‡ºé‡å®šå‘ | 2>>    | å°†ç¨‹åºè¾“å‡ºçš„é”™è¯¯ç»“æœä»¥è¿½åŠ çš„æ–¹å¼è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶ |
| æ ‡å‡†è¾“å…¥é‡å®šå‘     | <<     | å°†å‘½ä»¤ä¸­æ¥æ”¶è¾“å…¥çš„é€”å¾„ç”±é»˜è®¤çš„é”®ç›˜æ›´æ”¹ä¸ºæŒ‡å®šçš„æ–‡ä»¶æˆ–å‘½ä»¤     |

```
è¯·è§£é‡Šå¦‚ä¸‹é‡å®šå‘å«ä¹‰ï¼š

	>		æ ‡å‡†æ­£ç¡®è¾“å‡º   ï¼ˆ è¦†ç›– ï¼‰
	>>		æ ‡å‡†æ­£ç¡®è¾“å‡º   ï¼ˆ è¿½åŠ  ï¼‰
	&>		æ··åˆè¾“å‡ºï¼ˆæ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯è¾“å‡ºï¼‰	ï¼ˆ è¦†ç›– ï¼‰
	&>>		æ··åˆè¾“å‡ºï¼ˆæ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯è¾“å‡ºï¼‰	ï¼ˆ è¿½åŠ  ï¼‰
	2>		æ ‡å‡†é”™è¯¯è¾“å‡º	ï¼ˆ è¦†ç›– ï¼‰
	2>>		æ ‡å‡†é”™è¯¯è¾“å‡º	ï¼ˆ è¿½åŠ  ï¼‰
	1> te.txt 2>&1	æ­£ç¡®å’Œé”™è¯¯éƒ½è¾“å…¥åˆ°ç›¸åŒä½ç½® é”™è¯¯->æ ‡å‡†è¾“å‡º->te.txt  ( è¦†ç›–ï¼Œæ ‡å‡†è¾“å‡ºæ˜¯è¦†ç›–çš„ )
	1>>te.txt 2>&1						é”™è¯¯->æ ‡å‡†è¾“å‡º->>te.txt	( è¿½åŠ ï¼Œæ ‡å‡†è¾“å‡ºæ˜¯è¿½åŠ çš„ )
```

### 8.2 è¾“å…¥é‡å®šå‘

**è¾“å…¥é‡å®šå‘ï¼Œå³åŸæœ¬ä»é”®ç›˜ç­‰ä¸Šè·å¾—çš„è¾“å…¥ä¿¡æ¯ï¼Œé‡å®šå‘ç”±å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥ã€‚< ==0<**

```
æ¡ˆä¾‹1: ä»æ–‡ä»¶ä¸­è¯»å…¥è¾“å…¥çš„æ“ä½œ 
æ¡ˆä¾‹2:mysqlå¦‚ä½•æ¢å¤å¤‡ä»½
æ¡ˆä¾‹3: åˆ©ç”¨é‡å®šå‘å»ºç«‹å¤šè¡Œæ•°æ®çš„æ–‡ä»¶

```

### 8.3 ç®¡é“æŠ€æœ¯ teeã€xargs

**ç®¡é“æ“ä½œç¬¦å· "|" ï¼Œä¸»è¦ç”¨æ¥è¿æ¥å·¦å³ä¸¤ä¸ªå‘½ä»¤, å°†å·¦ä¾§çš„å‘½ä»¤çš„æ ‡å‡†è¾“å‡º, äº¤ç»™å³ä¾§å‘½ä»¤çš„æ ‡å‡†è¾“**

**1ã€tee**

**teeå°†ç®¡é“æ‰§è¡Œçš„ç»“æœä¿å­˜ä¸€ä»½å¹¶å‘åä¼ é€’**

```bash
#é€‰é¡¹: -aè¿½åŠ 

teeå’Œé‡å®šå‘çš„åŒºåˆ«ï¼Ÿ

[root@xuliangwei ~]# date > 1.txt    #å°†dateå‘½ä»¤çš„è¾“å‡ºç»“æœå†™å…¥åˆ°1.txtä¸­

[root@xuliangwei ~]# date | tee 1.txt #å‘½ä»¤æ‰§è¡Œä¼šè¾“å‡ºè‡³å±å¹•ï¼Œä½†ä¼šåŒæ—¶ä¿å­˜ä¸€ä»½è‡³1.txtæ–‡ä»¶ä¸­
```

### 2.xargs

**xargså‚æ•°ä¼ é€’ï¼Œä¸»è¦è®©ä¸€äº›ä¸æ”¯æŒç®¡é“çš„å‘½ä»¤å¯ä»¥ä½¿ç”¨ç®¡é“æŠ€æœ¯**

```bash
# which cat|xargs ls- l

# ls |xargs rm -fv
```

## 9. find æ–‡ä»¶æŸ¥æ‰¾

### 9.1 æŸ¥æ‰¾ç¤ºä¾‹

```bash
#å‚æ•°:
-name	æ–‡ä»¶åç§°æŸ¥æ‰¾
-iname	å¿½ç•¥å¤§å°å†™
-size	æ–‡ä»¶å¤§å°æŸ¥æ‰¾
-type	æ–‡ä»¶ç±»å‹æŸ¥æ‰¾ fæ–‡ä»¶ dç›®å½• lè¿æ¥ bå—è®¾å¤‡ cå­—ç¬¦è®¾å¤‡ så¥—æ¥å­—
-mtime	æ—¶é—´æŸ¥æ‰¾
æ‰“å°å½“å¤©çš„æ–‡ä»¶===è®¡ä¸è®¡ç®—æœ¬åœ°å½“å¤©æ—¶é—´æ–‡ä»¶
#2.æŸ¥æ‰¾7å¤©ä»¥å‰çš„æ–‡ä»¶(ä¸ä¼šæ‰“å°å½“å¤©çš„æ–‡ä»¶)=====( ä¿ç•™äº†æœ€è¿‘7å¤©çš„æ•°æ®)
# find ./ -iname "file-*" -mtime +7

#3.æŸ¥æ‰¾æœ€è¿‘7å¤©çš„æ–‡ä»¶ï¼Œä¸å»ºè®®ä½¿ç”¨(ä¼šæ‰“å°å½“å¤©çš„æ–‡ä»¶[å½“å¤©æ—¶é—´è®¡ç®—])
# find ./ -iname "file-*" -mtime -7

#4.æŸ¥æ‰¾ç¬¬7å¤©æ–‡ä»¶(ä¸ä¼šæ‰“å°å½“å¤©çš„æ–‡ä»¶)
# find ./ -iname "file-*" -mtime 7

#5.æœ¬åœ°æ–‡ä»¶ä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½æ–‡ä»¶, å¤‡ä»½æœåŠ¡å™¨ä¿ç•™3ä¸ªæœˆçš„å¤‡ä»½æ–‡ä»¶(å®é™…ä½¿ç”¨æ–¹æ¡ˆ)
find /backup/ -iname "*.bak" -mtime +7 -delete
find /backup/ -iname "*.bak" -mtime +90 -delete

-user	å±ä¸»æŸ¥è¯¢
-group	å±ç»„æŸ¥è¯¢

#ä¸¤ä¸ªå‚æ•°ä¹‹é—´çš„å…³è”
-a	å¹¶ä¸”å…³ç³»ï¼Œä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³
-o	æˆ–å…³ç³»ï¼Œæ»¡è¶³ä¸€ä¸ªå³å¯åŒ¹é…
!	é not
```

### 9.2 æŸ¥æ‰¾åå¤„ç†åŠ¨ä½œï¼ˆæŸ¥çœ‹ã€åˆ—å‡ºã€æ‹·è´ã€åˆ é™¤ç­‰ï¼‰

**findåŠ¨ä½œå¤„ç†ï¼Œæ¯”å¦‚æŸ¥æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶åï¼Œéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œå¦‚ä½•å¤„ç†, findçš„é»˜è®¤åŠ¨ä½œæ˜¯ -print**

| åŠ¨ä½œ    | å«ä¹‰                                     |
| :------ | :--------------------------------------- |
| -print  | æ‰“å°æŸ¥æ‰¾åˆ°çš„å†…å®¹(é»˜è®¤)                   |
| -ls     | ä»¥é•¿æ ¼å¼æ˜¾ç¤ºçš„æ–¹å¼æ‰“å°æŸ¥æ‰¾åˆ°çš„å†…å®¹       |
| -delete | åˆ é™¤æŸ¥æ‰¾åˆ°çš„æ–‡ä»¶(ä»…èƒ½åˆ é™¤ç©ºç›®å½•)         |
| -ok     | åé¢è·Ÿè‡ªå®šä¹‰ shell å‘½ä»¤(ä¼šæç¤ºæ˜¯å¦æ“ä½œ)  |
| -exec   | åé¢è·Ÿè‡ªå®šä¹‰ shell å‘½ä»¤(æ ‡å‡†å†™æ³• -exec ğŸ˜‰ |

```bash
#psï¼š-execå’Œxargsåˆ é™¤åŒºåˆ«
exec  ä¸€ä¸ªä¸€ä¸ªçš„åˆ é™¤
	rm -f ifcfg-eth0
	rm -f ifcfg-eth1
	rm -f ifcfg-eth2

xargs ä¸€æ¬¡å¹²æ‰
	rm -f  ifcfg-eth0 ifcfg-eth1 ifcfg-eth2

touch file-{1..50000}
# time find ./ -type f -name "file-*" -exec rm -f {} \;
# time find ./ -type f -name "file-*" |xargs rm -f
```

9.3 findé€»è¾‘è¿ç®—ç¬¦ã€-a -o ï¼ã€‘

```bash
#ç¬¦å· ä½œç”¨

-a ä¸ and é»˜è®¤å†™æ³•ä¸éœ€åŠ 

-o æˆ– or

! é -not
```

## 10.æ–‡ä»¶æ‰“åŒ…å‹ç¼©

**å¸¸è§å‹ç¼©åŒ…æ ¼å¼**

```bash
æ ¼å¼				å‹ç¼©å·¥å…·
.zip			zipå‹ç¼©å·¥å…·
.gz				gzipå‹ç¼©å·¥å…·ï¼Œåªèƒ½å‹ç¼©æ–‡ä»¶ï¼Œä¼šåˆ é™¤åŸæ–‡ä»¶(é€šå¸¸é…åˆtarä½¿ç”¨)
.bz2			bzip2å‹ç¼©å·¥å…·ï¼Œåªèƒ½å‹ç¼©æ–‡ä»¶ï¼Œä¼šåˆ é™¤åŸæ–‡ä»¶(é€šå¸¸é…åˆtarä½¿ç”¨)
.tar.gz			å…ˆä½¿ç”¨tarå‘½ä»¤å½’æ¡£æ‰“åŒ…ï¼Œç„¶åä½¿ç”¨gzipå‹ç¼©
.tar.bz2		å…ˆä½¿ç”¨tarå‘½ä»¤å½’æ¡£æ‰“åŒ…ï¼Œç„¶åä½¿ç”¨bzipå‹ç¼©
```

### 10.1 gzipã€.gzã€‘

ä½¿ç”¨gzipæ–¹å¼è¿›è¡Œå‹ç¼©æ–‡ä»¶ ( **åªèƒ½å‹ç¼©æ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶è¢«å‹ç¼©åï¼Œæºæ–‡ä»¶æ²¡æœ‰äº†**)

```bash
#å‚æ•°
-d			#è§£å‹gzipå‹ç¼©åŒ…

yum install gzip -y				#å®‰è£…gzipå‹ç¼©å·¥å…·

gzip file		#å‹ç¼©æ–‡ä»¶
zcat file.gz	#æŸ¥çœ‹å‹ç¼©æ–‡ä»¶
gzip -d file.gz	#è§£å‹å‹ç¼©æ–‡ä»¶
```

### 10.2 gipã€.zipã€‘



**zip, ä½¿ç”¨zipå‘½ä»¤å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©æ‰“åŒ…ï¼Œè§£å‹åˆ™éœ€è¦ä½¿ç”¨unzipå‘½ä»¤**

```bash
yum install zip unzip -y

#zipå‚æ•°
-r			#é€’å½’æ‰“åŒ…
-T			#æŸ¥çœ‹å‹ç¼©åŒ…æ˜¯å¦å®Œæ•´

#unzip å‚æ•°
-l / -t		#ä¸è§£å‹æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹
-d			#æŒ‡å®šè§£å‹ç›®å½•

zip  filename.zip  filename 
zip -r  dir.zip dir/
zip -T  filename.zip

# unzip -l  filename.zip
# unzip -t  filename.zip
# unzip  filename.zip
# unzip filename.zip  -d /opt/
```

### 10.3 tarã€.tar.gz|.tar.bz2ã€‘

**taræ˜¯linuxä¸‹æœ€å¸¸ç”¨çš„å‹ç¼©ä¸è§£å‹ç¼©, æ”¯æŒæ–‡ä»¶å’Œç›®å½•çš„å‹ç¼©å½’æ¡£**

```bash
c   #åˆ›å»ºæ–°çš„å½’æ¡£æ–‡ä»¶
x   #å¯¹å½’æ¡£æ–‡ä»¶è§£åŒ…
t   #åˆ—å‡ºå½’æ¡£æ–‡ä»¶é‡Œçš„æ–‡ä»¶åˆ—è¡¨
v   #è¾“å‡ºå‘½ä»¤çš„å½’æ¡£æˆ–è§£åŒ…çš„è¿‡ç¨‹
f   #æŒ‡å®šåŒ…æ–‡ä»¶åï¼Œå¤šå‚æ•°få†™æœ€å

z   #ä½¿ç”¨gzipå‹ç¼©å½’æ¡£åçš„æ–‡ä»¶(.tar.gz)
j   #ä½¿ç”¨bzip2å‹ç¼©å½’æ¡£åçš„æ–‡ä»¶(.tar.bz2)
J   #ä½¿ç”¨xzå‹ç¼©å½’æ¡£åçš„æ–‡ä»¶(tar.xz)
C   #æŒ‡å®šè§£å‹ç›®å½•ä½ç½®
X   #æ’é™¤å¤šä¸ªæ–‡ä»¶(å†™å…¥éœ€è¦æ’é™¤çš„æ–‡ä»¶åç§°)
h   #æ‰“åŒ…è½¯é“¾æ¥
--exclude   #åœ¨æ‰“åŒ…çš„æ—¶å€™å†™å…¥éœ€è¦æ’é™¤æ–‡ä»¶æˆ–ç›®å½•
```

### å¸¸ç”¨æ‰“åŒ…ä¸å‹ç¼©ç»„åˆ

```bash
czf     #æ‰“åŒ…tar.gzæ ¼å¼
cjf     #æ‰“åŒ…tar.bzæ ¼å¼
cJf     #æ‰“åŒ…tar.xzæ ¼å¼

zxf     #è§£å‹tar.gzæ ¼å¼
jxf     #è§£å‹tar.bzæ ¼å¼
xf      #è‡ªåŠ¨é€‰æ‹©è§£å‹æ¨¡å¼   å¸¸ç”¨å†™æ³•è‡ªåŠ¨é€‰æ‹©è§£å‹
tf      #æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹
```

```bash
#1.ä»¥gzipå½’æ¡£æ–¹å¼æ‰“åŒ…å¹¶å‹ç¼©
tar czf  test.tar.gz  test/ test2/

#2.ä»¥bz2æ–¹å¼å‹ç¼©
yum install bzip2 -y
tar cjf  test.tar.bz2 dir.txt dir/

#3.æ‰“åŒ…é“¾æ¥æ–‡ä»¶,æ‰“åŒ…é“¾æ¥æ–‡ä»¶çš„çœŸå®æ–‡ä»¶[åŠ å‚æ•°-h]
cd /
[root@ /]# tar czfh local.tar.gz  etc/rc.local

#4.æ‰“åŒ…/tmpä¸‹æ‰€æœ‰æ–‡ä»¶
cd /
[root@ /]# find tmp/ -type f | xargs tar czf tmp.tar.gz

æ–¹æ³•äºŒ:
[root@ /]# tar czf tmp2.tar.gz $(find /tmp/ -type f)    #ä¼šä¼˜å…ˆæ‰§è¡Œ$()é‡Œçš„å†…å®¹å¹¶ä½œä¸ºå‚æ•°ä¼ é€’
```

æ€»ç»“

```bash
tar 
	czf	#tar.gz    
	cjf	#tar.bz2
tar
	tf	æµè§ˆåŒ…å†…å®¹

tar
	xf	æ™ºèƒ½è§£å‹
	tar  xf xx.tar.gz -C /opt   #-C æŒ‡å®šè§£å‹åˆ°optç›®å½•


æ‰“åŒ…ä¸€ä¸ªtar.gzçš„å‹ç¼©åŒ…ï¼Œå‹ç¼©/etc /opt /tmp  ,æ£€æŸ¥å‹ç¼©åŒ…çš„ä¸­å†…å®¹ï¼Œæœ€åè§£å‹åˆ°å½“å‰ç›®å½•ã€‚
 tar czf eot.tar.gz /etc/ /opt/ /tmp/
 tar tf eot.tar.gz
 tar xf eot.tar.gz
```

### 10.4 --exclude æ’é™¤æ‰“åŒ…æ–‡ä»¶

```bash
#æ’é™¤å•ä¸ªæ–‡ä»¶
 tar czf etc.tar.gz --exclude=etc/services etc/
 
å°†éœ€è¦æ’é™¤çš„æ–‡ä»¶å†™å…¥æ–‡ä»¶ä¸­
[root@ opt]# cat ~/pc.txt
etc/sysconfig/network-scripts/ifcfg-eth0
etc/services
etc/rc.local

#æŒ‡å®šéœ€è¦æ’é™¤çš„æ–‡ä»¶åˆ—è¡¨, æœ€åè¿›è¡Œæ‰“åŒ…å‹ç¼©
è¯­æ³•:tar å‚æ•° å‹ç¼©åŒ…åç§° è¦æ’é™¤çš„æ–‡ä»¶ æ‰“åŒ…çš„å†…å®¹
[root@ ~]# tar czfX oo3.tar.gz  pc.txt  /etc/
tar: ä»æˆå‘˜åä¸­åˆ é™¤å¼€å¤´çš„â€œ/â€
#ç”±äºæ‰“åŒ…æ—¶ä½¿ç”¨çš„æ˜¯å…¨è·¯å¾„ï¼Œé»˜è®¤ç³»ç»Ÿä¼šæŠŠå¼€å¤´çš„/åˆ é™¤ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è§£å‹æ—¶ æŒ‡å®šè§£å‹åˆ° / ä¸‹é¢
[root@db01-172 ~]# cp oo3.tar.gz  /opt/
[root@db01-172 ~]# cd /opt/
[root@db01-172 opt]# tar xf oo3.tar.gz
[root@db01-172 opt]# find etc/ -type f |grep "ifcg*"
etc/sysconfig/network-scripts/ifcfg-lo
[root@db01-172 opt]# find etc/ -type f |grep "services"
[root@db01-172 opt]# find etc/ -type f |grep "rc.local"
etc/rc.d/rc.local
```

## 11. rpmåŒ…ç®¡ç†

**rpmè½¯ä»¶åŒ…çš„ç»„æˆéƒ¨åˆ†æœ‰å“ªäº›ï¼Ÿ**

```bash
bash-doc-4.2.46-34.el7.x86_64.rpm

bash-docï¼šåŒ…åç§°
4.2.46ï¼šç‰ˆæœ¬å·
-34ï¼šå‘å¸ƒæ¬¡æ•°
el7ï¼šè¡¨ç¤ºè½¯ä»¶åŒ…å¯ä»¥åœ¨ Red Hat 7.xï¼ŒCentOS 7.xï¼ŒCloudLinux 7.x è¿›è¡Œå®‰è£…
.x86_64ï¼šç¡¬ä»¶å¹³å°https://blog.csdn.net/sunny_day_day/article/details/108714946
.rpm:æ‰©å±•å
```

**ä½¿ç”¨rpmå·¥å…·å®‰è£…rpmåŒ…**

| é€‰é¡¹     | æè¿°             |
| :------- | :--------------- |
| -i       | å®‰è£…rpm          |
| -v       | æ˜¾ç¤ºå®‰è£…è¯¦ç»†ä¿¡æ¯ |
| -h       | æ˜¾ç¤ºå®‰è£…rpmè¿›åº¦  |
| --force  | å¼ºåˆ¶é‡æ–°å®‰è£…     |
| --nodeps | å¿½ç•¥ä¾èµ–å…³ç³»     |

```bash
#å‚æ•° 
-ivh 		å®‰è£…npmåŒ…
-iUh		å‡çº§å®‰è£…çš„npmåŒ…
-e			å¸è½½è½¯ä»¶

rpm -q		æŸ¥çœ‹æŒ‡å®šè½¯ä»¶åŒ…æ˜¯å¦å®‰è£…
rpm -qa		æŸ¥çœ‹ç³»ç»Ÿä¸­å·²å®‰è£…çš„æ‰€æœ‰RPMè½¯ä»¶åŒ…åˆ—è¡¨
rpm -qi		æŸ¥çœ‹æŒ‡å®šè½¯ä»¶çš„è¯¦ç»†ä¿¡æ¯
rpm -ql		æŸ¥è¯¢æŒ‡å®šè½¯ä»¶åŒ…æ‰€å®‰è£…çš„ç›®å½•ã€æ–‡ä»¶åˆ—è¡¨
rpm -qc		æŸ¥è¯¢æŒ‡å®šè½¯ä»¶åŒ…çš„é…ç½®æ–‡ä»¶
rpm -qf		æŸ¥è¯¢æ–‡ä»¶æˆ–ç›®å½•å±äºå“ªä¸ªRPMè½¯ä»¶
rpm -qip	æŸ¥è¯¢æœªå®‰è£…çš„rpmåŒ…è¯¦ç»†ä¿¡æ¯
rpm -qlp	æŸ¥è¯¢æœªå®‰è£…çš„è½¯ä»¶åŒ…ä¼šäº§ç”Ÿå“ªäº›æ–‡ä»¶
```

## 12. yumåŒ…ç®¡ç†

```bash
yum localinstall		#å®‰è£…æœ¬åœ°rpmåŒ…ä¼šè‡ªåŠ¨è§£å†³ä¾èµ–

yum install			å®‰è£…
yum reinstall		é‡è£…
yum update			æ›´æ–°
yum remove 			åˆ é™¤
yum repolist 	  	æŸ¥çœ‹ä»“åº“æ€»å’Œçš„rpmåŒ…
yum repolist all 	æŸ¥çœ‹æ‰€æœ‰çš„ä»“åº“ ï¼ˆ åŒ…æ‹¬å¯ç”¨å’Œç¦ç”¨ ï¼‰
yum provides		æŸ¥è¯¢å‘½ä»¤æ˜¯ å“ªä¸ªä»“åº“ä¸‹çš„å“ªä¸ªè½¯ä»¶åŒ…æä¾›
yum groups install	å®‰è£…ç»„åŒ…
yum groups remove 	ç§»é™¤ç»„åŒ…
yum history 
yum history info
yum history undo 
yum clean all		æ¸…ç†æ‰€æœ‰çš„ç¼“å­˜
yum clean packages	æ¸…ç†æ‰€æœ‰å·²ç¼“å­˜çš„rpmåŒ…

#æ›´æ–°ç¼“å­˜
yum clean all
yum makecache
```

## 13. ç£ç›˜ç®¡ç†

### 13.1ã€fdisk ç£ç›˜åˆ†åŒº

**fdiskåªèƒ½åˆ’åˆ†å°äº2TBçš„ç£ç›˜ï¼Œæ‰€ä»¥è¦æ·»åŠ ä¸€å—å°äº2TBçš„ç¡¬ç›˜**

```bash
è¾“å…¥mè¿›å…¥å¸®åŠ©æ˜¾ç¤ºä¿¡æ¯å¦‚ä¸‹ï¼š
[root@web01 ~]# fdisk -l
[root@web01 ~]# fdisk  /dev/sdb
Command (m for help): m         #è¾“å…¥måˆ—å‡ºå¸¸ç”¨çš„å‘½ä»¤
Command action
   a   toggle a bootable flag               #åˆ‡æ¢åˆ†åŒºå¯åŠ¨æ ‡è®°
   b   edit bsd disklabel                   #ç¼–è¾‘sdbç£ç›˜æ ‡ç­¾
   c   toggle the dos compatibility flag    #åˆ‡æ¢doså…¼å®¹æ¨¡å¼
   d   delete a partition                   #åˆ é™¤åˆ†åŒº
   l   list known partition types           #æ˜¾ç¤ºåˆ†åŒºç±»å‹
   m   print this menu                      #æ˜¾ç¤ºå¸®åŠ©èœå•
   n   add a new partition                  #æ–°å»ºåˆ†åŒº
   o   create a new empty DOS partition table   #åˆ›å»ºæ–°çš„ç©ºç™½åˆ†åŒºè¡¨
   p   print the partition table            #æ˜¾ç¤ºåˆ†åŒºè¡¨çš„ä¿¡æ¯
   q   quit without saving changes          #ä¸ä¿å­˜é€€å‡º
   s   create a new empty Sun disklabel     #åˆ›å»ºæ–°çš„Sunç£ç›˜æ ‡ç­¾
   t   change a partitions system id        #ä¿®æ”¹åˆ†åŒºID,å¯ä»¥é€šè¿‡læŸ¥çœ‹id
   u   change display/entry units           #ä¿®æ”¹å®¹é‡å•ä½,ç£æŸ±æˆ–æ‰‡åŒº
   v   verify the partition table           #æ£€éªŒåˆ†åŒºè¡¨
   w   write table to disk and exit         #ä¿å­˜é€€å‡º
   x   extra functionality (experts only)   #æ‹“å±•åŠŸèƒ½

#1.fdiskåˆ›å»ºä¸»åˆ†åŒº
Command (m for help): n
Partition type:
   p   primary (0 primary, 0 extended, 4 free)  #ä¸»åˆ†åŒº
   e   extended  #æ‰©å±•åˆ†åŒº
Select (default p): p   #é€‰æ‹©åˆ›å»ºä¸»åˆ†åŒº
Partition number (1-4, default 1):  #é»˜è®¤åˆ›å»ºç¬¬ä¸€ä¸ªä¸»åˆ†åŒº
First sector (2048-2097151, default 2048): #é»˜è®¤æ‰‡åŒºå›è½¦
Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-2097151, default 2097151): +50M #åˆ†é…ç©ºé—´50MB


#2.fdiskåˆ›å»ºæ‰©å±•åˆ†åŒº
Command (m for help): n  #æ–°å»ºåˆ†åŒº
Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): e   #åˆ›å»ºæ‰©å±•åˆ†åŒº
Partition number (2-4, default 2):
First sector (104448-2097151, default 104448):
Using default value 104448
Last sector, +sectors or +size{K,M,G} (104448-2097151, default 2097151): #ç©ºé—´éƒ½ç»™åˆ°æ‰©å±•åˆ†åŒº

#3.fdiskåˆ›å»ºé€»è¾‘åˆ†åŒº
Command (m for help): n  #æ–°å»ºåˆ†åŒº
Partition type:
   p   primary (1 primary, 1 extended, 2 free)
   l   logical (numbered from 5)
Select (default p): l   #åˆ›å»ºé€»è¾‘åˆ†åŒº
Adding logical partition 5
First sector (106496-2097151, default 106496):
Using default value 106496
Last sector, +sectors or +size{K,M,G} (106496-2097151, default 2097151): +100M  #åˆ†é…100MBç©ºé—´

#4.fdiskæŸ¥çœ‹åˆ†åŒºæƒ…å†µï¼Œå¹¶ä¿å­˜
Command (m for help): p #æŸ¥çœ‹åˆ†åŒºåˆ›å»º
Device Boot      Start         End      Blocks   Id  System
/dev/sdb1            2048      104447       51200   83  Linux
/dev/sdb2          104448     2097151      996352    5  Extended
/dev/sdb5          106496      311295      102400   83  Linux

#ä¿å­˜åˆ†åŒº
Command (m for help): w
The partition table has been altered!
Calling ioctl() to re-read partition table.
Syncing disks.
```

å°å‘ï¼šåˆ†åŒºå¤±è´¥åˆ é™¤äº†,ç³»ç»Ÿä¸ºç”Ÿæ•ˆ,å¯ä»¥å®‰è£…partprobeæŒ‡ä»¤åˆ·æ–°å†…æ ¸åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥å°è¯•æ£€æŸ¥ç£ç›˜æ˜¯å¦ä¸ºgptæ ¼å¼

```bash
[root@xuliangwei-node1 /]# fdisk /dev/sdb -l|grep type
Disk label type: gpt

å®‰è£…parted, åˆ·æ–°å†…æ ¸ç«‹å³ç”Ÿæ•ˆ,æ— éœ€é‡å¯
[root@ ~]# yum -y install parted
[root@ ~]# partprobe
```

### 13.2ã€mkfs æ ¼å¼åˆ†åŒº

**mkfsæ ¼å¼åŒ–ç£ç›˜ï¼Œå®è´¨åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶ç³»ç»Ÿç±»ä¼¼äºå°†æˆ¿å­è£…ä¿®æˆ3å®¤ä¸€å…ï¼Œè¿˜æ˜¯2å®¤ä¸€å…ã€‚**

```bash
#é€‰é¡¹: 
# -b  è®¾å®šæ•°æ®åŒºå—å ç”¨ç©ºé—´å¤§å°ï¼Œç›®å‰æ”¯æŒ1024ã€2048ã€4096 bytesæ¯ä¸ªå—ã€‚
# -t  ç”¨æ¥æŒ‡å®šä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥æ˜¯ext4, xfs
# -i  è®¾å®šinodeçš„å¤§å°
# -N  è®¾å®šinodeæ•°é‡ï¼Œé˜²æ­¢Inodeæ•°é‡ä¸å¤Ÿå¯¼è‡´ç£ç›˜ä¸è¶³

#1.æ ¼å¼åŒ–æ•´ä¸ªç£ç›˜
[root@xuliangwei ~]# mkfs.ext4  /dev/sdb 

#2.æ ¼å¼åŒ–ç£ç›˜çš„æŸä¸ªåˆ†åŒº
[root@xuliangwei ~]# mkfs.xfs  /dev/sdb1
```

### 13.3ã€mount æŒ‚è½½

å¦‚æœéœ€è¦ä½¿ç”¨è¯¥ç£ç›˜çš„ç©ºé—´ï¼Œéœ€è¦å‡†å¤‡ä¸€ä¸ªç©ºçš„ç›®å½•ä½œä¸ºæŒ‚è½½ç‚¹ï¼Œä¸è¯¥è®¾å¤‡è¿›è¡Œå…³è”ã€‚

**1.ä¸´æ—¶æŒ‚è½½**

```bash
# é€‰é¡¹ï¼š-tæŒ‡å®šæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ†åŒº -a æŒ‚è½½/etc/fstabä¸­çš„é…ç½®æ–‡ä»¶ -o æŒ‡å®šæŒ‚è½½å‚æ•°
# æŒ‚è½½/dev/sdb1è‡³db1ç›®å½•
[root@ ~]# mkdir /db1
[root@ ~]# mount -t xfs /dev/sdb1  /db1/ 
```

**2.umountå¸è½½**

æŒ‚è½½çš„ç£ç›˜ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨å¯ä»¥ä½¿ç”¨umountè¿›è¡Œå¸è½½ã€‚

```bash
#é€‰é¡¹ï¼š
-l å¼ºåˆ¶å¸è½½
-o æŒ‡å®šæŒ‚è½½å‚æ•°ï¼Œé»˜è®¤æ˜¯è¯»å†™rwï¼Œåªè¯»or
mount -o or /dev/sdc1 /data-c/            

#1.å¸è½½ç›®å½•æ–¹å¼
[root@ ~]# umount /db1

#2.å¸è½½è®¾å¤‡æ–¹å¼
[root@ ~]# umount /dev/sdb1

#3.umountä¸èƒ½å¸è½½çš„æƒ…å†µ
[root@ db1]# umount /db1  
umount: /db1: device is busy.
        (In some cases useful info about processes that use
         the device is found by lsof(8) or fuser(1)

#PS: å¦‚ä¸Šæƒ…å†µè§£å†³åŠæ³•æœ‰ä¸¤ç§, 1.åˆ‡æ¢è‡³å…¶ä»–ç›®å½• 2.ä½¿ç”¨'-l'é€‰é¡¹å¼ºåˆ¶å¸è½½    
[root@student db1]# umount -l /db1
```

**2.æ°¸ä¹…æŒ‚è½½**

æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±éœ€è¦é…ç½®ä¸€ä¸ªæ–‡ä»¶   /etc/fstab   ï¼ˆå¼€æœºä¼šåŠ è½½è¯¥æ–‡ä»¶ä¸­çš„è®¾å¤‡ï¼‰

**/etc/fstabé…ç½®æ–‡ä»¶ç¼–å†™æ ¼å¼**

```bash
è¦æŒ‚è½½çš„è®¾å¤‡	æŒ‚è½½ç‚¹(å…¥å£)	æ–‡ä»¶ç³»ç»Ÿç±»å‹	æŒ‚è½½å‚æ•°		æ˜¯å¦å¤‡ä»½	æ˜¯å¦æ£€æŸ¥
/dev/sdb1	/db1		  xfs		defaults		0			0

#ç¬¬ä¸€åˆ—ï¼šå¯ä»¥ä½¿ç”¨UUIDä¹Ÿå¯ä»¥ä½¿ç”¨è®¾å¤‡åç§°
[root@container ~]# blkid                                   #æŸ¥çœ‹ç£ç›˜çš„UUID
/dev/sda1: UUID="723eb45d-9a1b-4e8f-b06d-cf9024302147" TYPE="xfs"
/dev/sda2: UUID="yVHSU3-Cmkf-qsg9-6DNg-P87L-mCDN-VOHvcO" TYPE="LVM2_member"
/dev/sdb1: UUID="3b0143a3-39af-4991-afab-01227fbe767c" TYPE="xfs"

#ç¬¬å››åˆ—ï¼šæŒ‚è½½å‚æ•°ã€‚æŒ‚è½½å‚æ•°æœ‰å¾ˆå¤šï¼Œåœ¨è¿™å—æˆ‘ä»¬äº†è§£å³å¯ï¼Œä¸å¿…æ·±ç©¶ã€‚ã€ä¸€èˆ¬ä½¿ç”¨defaultã€‘
å‚æ•°			å«ä¹‰
async/sync	æ˜¯å¦ä¸ºåŒæ­¥æ–¹å¼è¿è¡Œã€‚é»˜è®¤async
user/nouser	æ˜¯å¦å…è®¸æ™®é€šç”¨æˆ·ä½¿ç”¨mountå‘½ä»¤æŒ‚è½½ã€‚é»˜è®¤nouser
exec/noexe	æ˜¯å¦å…è®¸å¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œã€‚é»˜è®¤exec
suid/nosuid	æ˜¯å¦å…è®¸å­˜åœ¨suidå±æ€§çš„æ–‡ä»¶ã€‚é»˜è®¤suid
auto/noauto	æ‰§è¡Œmount -a å‘½ä»¤æ—¶ï¼Œæ­¤æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦è¢«ä¸»åŠ¨æŒ‚è½½ã€‚é»˜è®¤auto
rw/ro		æ˜¯å¦ä»¥åªè¯»æˆ–è€…è¯»å†™æ¨¡å¼è¿›è¡ŒæŒ‚è½½ã€‚é»˜è®¤rw
default		å…·æœ‰rw,suid,dev,exec,auto,nouser,asyncç­‰é»˜è®¤å‚æ•°çš„è®¾å®šã€‚

#ç¬¬äº”åˆ—ï¼šæ˜¯å¦è¿›è¡Œå¤‡ä»½ã€‚é€šå¸¸è¿™ä¸ªå‚æ•°çš„å€¼ä¸º0æˆ–è€…1				ã€ä¸å¤‡ä»½ã€‘
é€‰é¡¹	å«ä¹‰
0	ä»£è¡¨ä¸åšå¤‡ä»½
1	ä»£è¡¨è¦æ¯å¤©è¿›è¡Œå¤‡ä»½æ“ä½œ
2	ä»£è¡¨ä¸å®šæ—¥æœŸçš„è¿›è¡Œå¤‡ä»½æ“ä½œ

#ç¬¬å…­åˆ—ï¼šæ˜¯å¦æ£€éªŒæ‰‡åŒºï¼šå¼€æœºçš„è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿé»˜è®¤ä¼šä»¥fsckæ£€éªŒæˆ‘ä»¬ç³»ç»Ÿæ˜¯å¦ä¸ºå®Œæ•´	ã€ä¸æ£€æŸ¥ã€‘
é€‰é¡¹	å«ä¹‰
0	ä¸è¦æ£€éªŒç£ç›˜æ˜¯å¦æœ‰åé“
1	æ£€éªŒ
2	æ ¡éªŒ (å½“1çº§åˆ«æ£€éªŒå®Œæˆä¹‹åè¿›è¡Œ2çº§åˆ«æ£€éªŒ)


#ç¤ºä¾‹ï¼š
[root@container ~]# tail  /etc/fstab           #è¿›å…¥å¼€æœºåŠ è½½æ–‡ä»¶æ·»åŠ ä¸€ä¸ªæŒ‚è½½
/dev/sdb1 	/data1		xfs	defaults 0 0
```

**å¦‚ä½•çŸ¥é“å†™çš„å¯¹äºä¸å¯¹   mount -a    (   ä¼šå»åŠ è½½/etc/fstabä¸­çš„ æŒ‚è½½ä¿¡æ¯   )**

```bash
[root@container ~]# mount -a

[root@container ~]# df -h               #æ£€æŸ¥æŒ‚è½½ç‚¹
æ–‡ä»¶ç³»ç»Ÿ                 å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sdb1               20G   33M  20G  1% /data1		ã€Š--è¯»å–/etc/fstab åŠ è½½è¯¥è®¾å¤‡
```

### 13.4ã€gdisk ç£ç›˜åˆ†åŒº(å¤§äº2T)

1ã€èƒ½å¤Ÿè¯†åˆ«å¤§äº2TBçš„ç£ç›˜å­˜å‚¨ç©ºé—´

2ã€å¯ä»¥æ”¯æŒåˆ†åŒºçš„æ•°é‡  é«˜è¾¾  128ä¸ª ä¸»åˆ†åŒº      æ²¡æœ‰æ‰©å±•ï¼Œé€»è¾‘åˆ†åŒºçš„æ¦‚å¿µã€‚

3ã€MBR ç£ç›˜  å’Œ  GPT  ä¸èƒ½äº’ç›¸è½¬æ¢ã€å®¹æ˜“é€ æˆæ•°æ®ä¸¢å¤±ã€‚

**ä½¿ç”¨gdiskå·¥å…·åˆ†åŒº**

```bash
#1.å®‰è£…gdiskï¼Œæ²¡æœ‰gdiskéœ€è¦yumä¸‹è½½ä¸€ä¸ª
yum install gdisk -y


#2.åˆ›å»ºä¸€ä¸ªæ–°åˆ†åŒºï¼Œ500MBå¤§å°
[root@ ~]# gdisk /dev/sdb
Command (? for help): n     #åˆ›å»ºæ–°åˆ†åŒº
Partition number (1-128, default 1):
First sector (34-2097118, default = 2048) or {+-}size{KMGTP}:
Last sector (2048-2097118, default = 2097118) or {+-}size{KMGTP}: +500M #åˆ†é…500Må¤§å°

Command (? for help): p #æ‰“å°æŸ¥çœ‹
Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         1026047   500.0 MiB   8300  Linux filesystem

Command (? for help): w #ä¿å­˜åˆ†åŒº
Do you want to proceed? (Y/N): y    #ç¡®è®¤
OK; writing new GUID partition table (GPT) to /dev/sdb.
The operation has completed successfully.


#3.åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥å°è¯•æ£€æŸ¥ç£ç›˜æ˜¯å¦ä¸ºgptæ ¼å¼
[root@xuliangwei-node1 /]# fdisk /dev/sdb -l|grep type
Disk label type: gpt

#4.å®‰è£…parted, åˆ·æ–°å†…æ ¸ç«‹å³ç”Ÿæ•ˆ,æ— éœ€é‡å¯
[root@ ~]# yum -y install parted
[root@ ~]# partprobe /dev/sdb

2.ä½¿ç”¨mkfsè¿›è¡Œæ ¼å¼åŒ–ç£ç›˜ã€‚å‰é¢å·²ç»ä»‹ç»è¿‡ï¼Œæ­¤å¤„ä¸åå¤ä»‹ç»ã€‚
[root@xuliangwei ~]# mkfs.xfs  /dev/sdb

3.ä½¿ç”¨mountå‘½ä»¤å°†æŸä¸ªç›®å½•æŒ‚è½½è¯¥åˆ†åŒºï¼Œè¿›è¡Œä½¿ç”¨ã€‚
[root@ ~]# mkdir /data_gdisk
[root@ ~]# mount /dev/sdb /data_gdisk
```

### 13.5ã€swap ç‰©ç†å†…å­˜

Swapåˆ†åŒºåœ¨ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ï¼Œå°†ç¡¬ç›˜ç©ºé—´ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´é‡Šæ”¾å‡ºæ¥ï¼Œä»¥ä¾›å½“å‰è¿è¡Œçš„ç¨‹åºä½¿ç”¨ã€‚

**PS: å½“ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ä¼šéšæœºkillå ç”¨å†…å­˜çš„è¿›ç¨‹ï¼Œä»è€Œäº§ç”Ÿoomï¼Œä¸´æ—¶ä½¿ç”¨swapå¯ä»¥è§£å†³ã€‚**

```bash
[root@container ~]# swapoff -a          #ä¸´æ—¶å–æ¶ˆswapåˆ†åŒº
[root@container ~]# free -m		    	#æŸ¥çœ‹swapåˆ†åŒº
[root@container ~]# swapon -a           #å¼€å¯swapåˆ†åŒº
```

**å¦‚ä½•å°†ç£ç›˜ç©ºé—´åˆ’åˆ†ä¸€éƒ¨åˆ†ç»™swapä½¿ç”¨**

```
1.å…ˆæ‰¾ä¸€å—ç¡¬ç›˜ï¼Œåˆ’åˆ†1Gbç©ºé—´		  fdisk
2.æ ¼å¼åŒ–ä¸ºä¸€ä¸ªswapçš„è®¾å¤‡     	   mkswap /dev/sdb1                #æ ¼å¼åŒ–å‰è¦å…ˆå¸è½½æŒ‚è½½
3.é€šè¿‡						    swapon -a /dev/sdb1  å°†è¯¥è®¾å¤‡åŠ å…¥swap
4.ä½¿ç”¨free -m æ£€æŸ¥swapçš„å¤§å°		 free -m
5.å¦‚æœä¸æƒ³ä½¿ç”¨swapäº†				 swapoff /dev/sdb1   ç§»é™¤
```

**------å¦‚ä¸Šæ“ä½œéƒ½æ˜¯ä¸´æ—¶çš„ï¼Œå¦‚éœ€æ°¸ä¹…ç”Ÿæ•ˆï¼Œéœ€è¦æ·»åŠ åˆ°/etc/fstabï¼ï¼ï¼ï¼ï¼ï¼**

### 13.6 ã€df ã€duæŸ¥çœ‹ç£ç›˜ç©ºé—´

**df ä½¿ç”¨**

```bash
#å‚æ•°
-h			#ä»¥äººç±»å¯è¯»çš„æ–¹å¼æ˜¾ç¤º(GB\MB\KB)ç£ç›˜ä½¿ç”¨æƒ…å†µ
-T			#æ˜¾ç¤ºå„ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ã€‚
--total		#å°†åœ¨è¾“å‡ºåˆ—è¡¨çš„åº•éƒ¨æ˜¾ç¤ºæ€»è®¡ä¿¡æ¯
-i			#æ˜¾ç¤º inode ä¿¡æ¯
```

**du ä½¿ç”¨**

 `du` å‘½ä»¤æŸ¥æ‰¾ç›®å½•ä¸‹å ç”¨ç©ºé—´è¾ƒå¤§çš„æ–‡ä»¶å’Œå­ç›®å½• 

```bash
du -a /path/to/directory | sort -n -r | head -n N

å…¶ä¸­ï¼š
/path/to/directory æ˜¯æ‚¨è¦æ£€æŸ¥çš„ç›®å½•è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚
N æ˜¯æ‚¨å¸Œæœ›æŸ¥çœ‹çš„æœ€å¤§æ–‡ä»¶ï¼å­ç›®å½•çš„æ•°é‡ã€‚
```

åŒºåˆ«

```bash
du å’Œ df éƒ½æ˜¯ç”¨äºæ£€æŸ¥ç£ç›˜ç©ºé—´çš„ Unixã€Linux å’Œ macOS ç³»ç»Ÿå‘½ä»¤ã€‚å°½ç®¡å®ƒä»¬éƒ½ä¸ç£ç›˜ç©ºé—´åˆ†æç›¸å…³ï¼Œä½†å®ƒä»¬çš„åŠŸèƒ½å’Œç›®æ ‡æœ‰æ‰€ä¸åŒã€‚

#duï¼ˆDisk Usageï¼‰:
du ä¸»è¦ç”¨äºåˆ†ææ–‡ä»¶å’Œç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´ã€‚å®ƒå¯ä»¥æŠ¥å‘Šç»™å®šæ–‡ä»¶æˆ–ç›®å½•ï¼ˆåŠå…¶å­ç›®å½•ï¼‰çš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚du å…è®¸æŒ‰æ–‡ä»¶å’Œç›®å½•æŸ¥æ‰¾ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œå¹¶æŒ‰éœ€æ·±å…¥åˆ°åµŒå¥—å­ç›®å½•ä¸­ã€‚

ä¸€äº›å¸¸è§çš„ du ç”¨æ³•ï¼š
æ˜¾ç¤ºæŒ‡å®šç›®å½•åŠå…¶å­ç›®å½•çš„å¤§å°ï¼šdu /path/to/directory
ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºç›®å½•å¤§å°ï¼šdu -h /path/to/directory
æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å¤§å°ï¼šdu -h /path/to/file

#dfï¼ˆDisk Freeï¼‰:
df ä¸»è¦ç”¨äºæ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€æŒ‚è½½ç‚¹æˆ–ç£ç›˜åˆ†åŒºçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚å®ƒæä¾›äº†å…³äºæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡æ•°æ®ï¼Œå¦‚æ€»ç©ºé—´ã€å·²ç”¨ç©ºé—´ã€å¯ç”¨ç©ºé—´ç­‰ã€‚df ä¸ä¼šæ·±å…¥åˆ°æ–‡ä»¶æˆ–å­ç›®å½•çº§åˆ«ï¼Œä½†å¯ä»¥ç»™å‡ºå…³äºæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„æ€»ä½“æ¦‚è¿°ã€‚

ä¸€äº›å¸¸è§çš„ df ç”¨æ³•ï¼š
æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µï¼šdf
ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µï¼šdf -h
æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼šdf /path/to/mount/point

#æ€»ä¹‹ï¼Œdu ç”¨äºæ·±å…¥æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶å’Œç›®å½•çš„ç£ç›˜å ç”¨æƒ…å†µï¼Œè€Œ df ç”¨äºæŸ¥çœ‹æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿæˆ–ç£ç›˜åˆ†åŒºçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æ¦‚å†µã€‚ä¸¤è€…éƒ½æ˜¯ç£ç›˜ç©ºé—´åˆ†æå·¥å…·ï¼Œä½†ç”¨é€”å’Œç„¦ç‚¹ä¸åŒã€‚
```

### 13.7  inodeä½¿ç”¨æŸ¥è¯¢

```bash
1ã€ä½¿ç”¨ df å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿçš„ inode ä½¿ç”¨æƒ…å†µã€‚ä½¿ç”¨ -i é€‰é¡¹æ˜¾ç¤º inode ä¿¡æ¯ï¼š
# df -i

2ã€è¦æŸ¥æ‰¾æ‹¥æœ‰å¤§é‡ inode çš„ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ find å‘½ä»¤é…åˆ wc -l å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š
for i in /*; do echo -n "$i: " && find "$i" -print | wc -l; done | sort -n -k2 -r

è¿™æ¡å‘½ä»¤é€’å½’éå†æ ¹ç›®å½•ï¼ˆ/*ï¼‰ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªç›®å½•å ç”¨çš„ inode æ•°é‡ï¼ŒæŒ‰é™åºæ’åˆ—ã€‚
```

**inode çš„ç®¡ç†å¯¹äºç¡®ä¿æ–‡ä»¶ç³»ç»Ÿæ­£å¸¸å·¥ä½œå’Œä¼˜åŒ–ç£ç›˜ç©ºé—´ä½¿ç”¨æä¸ºé‡è¦ã€‚åœ¨è¿›è¡Œç£ç›˜ç›‘æ§å’Œä¼˜åŒ–æ—¶ï¼Œè¯·ç¡®ä¿å…³æ³¨ inode ä½¿ç”¨æƒ…å†µã€‚**

## 14. è¿›ç¨‹ç®¡ç†

**ç¨‹åºåœ¨è¿è¡Œåï¼Œæˆ‘ä»¬éœ€è¦äº†è§£è¿›ç¨‹çš„è¿è¡ŒçŠ¶æ€ã€‚æŸ¥çœ‹è¿›ç¨‹çš„çŠ¶æ€åˆ†ä¸º: é™æ€å’ŒåŠ¨æ€ä¸¤ç§æ–¹å¼**

 **ps:æ¯ä¸ªè¿›ç¨‹çš„çˆ¶è¿›ç¨‹éƒ½å«PPID,å­è¿›ç¨‹åˆ™å«PID**

### 14.1 ps aux é™æ€è¿›ç¨‹ä¿¡æ¯æŸ¥çœ‹

```bash
#å¸¸ç”¨å‚æ•°
ps				#æ˜¾ç¤ºå½“å‰ç»ˆç«¯å†…çš„è¿›ç¨‹
ps -e			#æ˜¾ç¤ºå…¨éƒ¨è¿›ç¨‹
ps -ef			#ä»¥å®Œæ•´çš„æ ¼å¼æ˜¾ç¤ºå…¨éƒ¨è¿›ç¨‹
ps -u username	#æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·è¿è¡Œçš„è¿›ç¨‹
ps -l			#é•¿æ ¼å¼æ˜¾ç¤ºå½“å‰ç»ˆç«¯å†…çš„è¿›ç¨‹ä¿¡æ¯
ps -aux			#æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹ä¿¡æ¯ï¼Œè€Œæ— è®ºå®ƒä»¬æ˜¯å¦ä¸ç»ˆç«¯å…³è”ã€‚
```

```bash
USER  	 		è¿›ç¨‹è¿è¡Œçš„ç”¨æˆ·èº«ä»½ï¼ˆ æ¯ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½éœ€è¦ä¸€ä¸ªç‰¹å®šçš„ç”¨æˆ·èº«ä»½æ¥è¿è¡Œ ï¼‰
PID				å­è¿›ç¨‹çš„èº«ä»½æ ‡è¯† ï¼ˆ å°±æ˜¯ä¸€ç§æ ‡è¯†ï¼Œç”¨æ¥åŒºåˆ†ä¸åŒçš„è¿›ç¨‹ ï¼‰
%CPU			è¯¥è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”æ˜¯å¤šå°‘
%MEM			è¯¥è¿›ç¨‹å ç”¨å†…å­˜çš„ç™¾åˆ†æ¯”æ˜¯å¤šå°‘
VSZ				è™šæ‹Ÿå†…å­˜
RSS				å®é™…å ç”¨å†…å­˜   
TTY				è¯¥è¿›ç¨‹æ˜¯å“ªä¸ªç»ˆç«¯è¿è¡Œçš„  ? è¡¨ç¤ºæ˜¯ç³»ç»Ÿè¿è¡Œçš„	pts/0 pts/1 æ¥æºçš„ç»ˆç«¯æ˜¯å“ªä¸€ä¸ª
STAT			è¿›ç¨‹æ‰€è¡¨ç¤ºçš„çŠ¶æ€ï¼ˆ è¿è¡Œ æš‚åœ åœæ­¢ .......ï¼‰
START			è¿›ç¨‹å¯åŠ¨æ—¶é—´
TIME			è¿›ç¨‹å ç”¨CPUçš„æ—¶é—´
COMMAND			è¿è¡Œè¯¥è¿›ç¨‹éœ€è¦æ‰§è¡Œçš„å‘½ä»¤	[ ] è¡¨ç¤ºå†…æ ¸å¯åŠ¨çš„è¿›ç¨‹


#STATçŠ¶æ€
- STATåŸºæœ¬çŠ¶æ€â€”â€”æè¿°						
  R	ï¼šè¿›ç¨‹è¿è¡Œ								
  S	ï¼šå¯ä¸­æ–­è¿›ç¨‹						
  T	ï¼šè¿›ç¨‹è¢«æš‚åœ							
  D	ï¼šä¸å¯ä¸­æ–­è¿›ç¨‹						
  Z	ï¼šåƒµå°¸è¿›ç¨‹								
- STATçŠ¶æ€+ç¬¦å·â€”â€”æè¿°
  s	ï¼šè¿›ç¨‹æ˜¯æ§åˆ¶è¿›ç¨‹ï¼Œ Ssè¿›ç¨‹çš„é¢†å¯¼è€…ï¼Œçˆ¶è¿›ç¨‹
  <	ï¼šè¿›ç¨‹è¿è¡Œåœ¨é«˜ä¼˜å…ˆçº§ä¸Šï¼ŒS<ä¼˜å…ˆçº§è¾ƒé«˜çš„è¿›ç¨‹
  N	ï¼šè¿›ç¨‹è¿è¡Œåœ¨ä½ä¼˜å…ˆçº§ä¸Šï¼ŒSNä¼˜å…ˆçº§è¾ƒä½çš„è¿›ç¨‹
  ï¼‹ï¼šå½“å‰è¿›ç¨‹è¿è¡Œåœ¨å‰å°ï¼ŒR+è¯¥è¡¨ç¤ºè¿›ç¨‹åœ¨å‰å°è¿è¡Œ
  l	ï¼šè¿›ç¨‹æ˜¯å¤šçº¿ç¨‹çš„ï¼ŒSlè¡¨ç¤ºè¿›ç¨‹æ˜¯ä»¥çº¿ç¨‹æ–¹å¼è¿è¡Œ
```

### 14.2 top åŠ¨æ€æŸ¥çœ‹

w:
	11:20:10 up 6 days,  7:46,  2 users,  load average: 0.01, 0.02, 0.05
uptime:
	11:20:14 up 6 days,  7:46,  2 users,  load average: 0.01, 0.02, 0.05

top:æŸ¥çœ‹å‰ä¸‰è¡Œæ˜¾ç¤ºä¿¡æ¯
ç¬¬ä¸€è¡Œ,ä»»åŠ¡å¯¹åˆ—ä¿¡æ¯åŒuptimeå‘½ä»¤æ‰§è¡Œç»“æœä¸€æ ·

- top - 11:18:15 up 6 days,  7:44,  2 users,  load average: 0.08, 0.03, 0.06

> 11:18:15					å½“å‰ç³»ç»Ÿæ—¶é—´ 
> up 6 days,7:44	 	ç³»ç»Ÿè¿è¡Œå¤©æ•°,å°æ—¶
> 2 users 					å½“å‰2ä¸ªç”¨æˆ·ç™»å½•
> load average: 0.08, 0.03, 0.06	åé¢ä¸‰ç»„æ•°åˆ†åˆ«æ˜¯1åˆ†é’Ÿ,äº”åˆ†é’Ÿ,åäº”åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µ

ç¬¬äºŒè¡Œ,tasks-ä»»åŠ¡(è¿›ç¨‹)
Tasks: 112 total,   1 running, 110 sleeping,   1 stopped,   0 zombie

> ç³»ç»Ÿå…±æœ‰112ä¸ªè¿›ç¨‹,å…¶ä¸­å¤„äºè¿è¡Œçš„1ä¸ª,110ä¸ªåœ¨ä¼‘çœ (sleep),stoppedçŠ¶æ€çš„1ä¸ª,zombieçŠ¶æ€(åƒµå°¸)çš„æœ‰é›¶ä¸ª

ç¬¬ä¸‰è¡Œ,CPUçŠ¶æ€ä¿¡æ¯
%Cpu(s):  0.3 us,  0.3 sy,  0.0 ni, 99.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st

```bash
us:	ç”¨æˆ·è¿›ç¨‹å ç”¨cpuç™¾åˆ†æ¯”ï¼ˆ è§†é¢‘åŠ å¯†ã€è§†é¢‘è§£ç  ï¼‰
sy:	å†…æ ¸è¿›ç¨‹å ç”¨cpuç™¾åˆ†æ¯” ï¼ˆ æ¯”å¦‚ ç½‘å¡ã€ç¡¬ä»¶è®¾å¤‡ã€ç¡¬ç›˜ ï¼‰
ni:	ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹å ç”¨cpuç™¾åˆ†æ¯”  
id:	ç©ºé—²çš„ç™¾åˆ†æ¯” ï¼ˆ å€¼è¶Šå¤§ã€è¯´æ˜æœåŠ¡å™¨è¶Šç©ºé—² ï¼‰
wa:	ç”¨æˆ·è¯·æ±‚ç£ç›˜èµ„æºï¼Œç£ç›˜å¾ˆæ…¢æ…¢æ…¢ï¼Œè¯·æ±‚çš„èµ„æºå¾ˆå¤š,ä¼šé€ æˆå¤§é‡çš„ç­‰å¾…ç¨‹åº    ï¼ˆ æ•°æ®åº“ ï¼‰
hi:	ç¡¬ä¸­æ–­
si:	è½¯ä¸­æ–­
st:	å½“è¯¥æœåŠ¡å™¨è¿è¡Œäº†å¾ˆå¤šçš„è™šæ‹Ÿæœºï¼Œè¿™äº›è™šæ‹Ÿæœºæ€»å…±å ç”¨å½“å‰ç‰©ç†æœåŠ¡å™¨çš„ç™¾åˆ†æ¯”æ˜¯å¤šå°‘
```

ä¸å¯èƒ½ç”¨topå»æ¯å°æœåŠ¡å™¨è§‚å¯Ÿï¼ŒåæœŸå°†æ‰€æœ‰çš„æœåŠ¡å™¨é€šè¿‡ç›‘æ§ï¼Œç»Ÿä¸€çš„ç›‘æ§èµ·æ¥ã€‚
top å¸¸è§æŒ‡ä»¤

```bash
å­—æ¯					        å«ä¹‰
h						æŸ¥çœ‹å¸®åŠ©
1						æ•°å­—1ï¼Œæ˜¾ç¤ºæ‰€æœ‰CPUæ ¸å¿ƒçš„è´Ÿè½½
z						ä»¥é«˜äº®æ˜¾ç¤ºæ•°æ®
b						é«˜äº®æ˜¾ç¤ºå¤„äºRçŠ¶æ€çš„è¿›ç¨‹
M						æŒ‰å†…å­˜ä½¿ç”¨ç™¾åˆ†æ¯”æ’åºè¾“å‡º
P						æŒ‰CPUä½¿ç”¨ç™¾åˆ†æ¯”æ’åºè¾“å‡º
q						é€€å‡ºtop
```

æ€»ç»“

```bash
>1.è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ
	åƒµå°¸è¿›ç¨‹ï¼ˆä¼šå ç”¨èµ„æºï¼‰
	å­¤å„¿è¿›ç¨‹ï¼ˆï¼‰
2.ç³»ç»ŸæŒ‡æ ‡ç›‘æ§
	ps  é™æ€
	top åŠ¨æ€
3.ä¸­æ–­
	è½¯ä¸­æ–­	ç¡¬ä¸­æ–­
```

#### nice è¿›ç¨‹ä¼˜å…ˆçº§

åœ¨å¯åŠ¨è¿›ç¨‹æ—¶ï¼Œä¸ºä¸åŒçš„è¿›ç¨‹ä½¿ç”¨ä¸åŒçš„è°ƒåº¦ç­–ç•¥ã€‚
nice å€¼è¶Šé«˜ï¼š è¡¨ç¤ºä¼˜å…ˆçº§è¶Šä½ï¼Œä¾‹å¦‚+19ï¼Œè¯¥è¿›ç¨‹å®¹æ˜“å°†CPU ä½¿ç”¨é‡è®©ç»™å…¶ä»–è¿›ç¨‹ã€‚
nice å€¼è¶Šä½ï¼š è¡¨ç¤ºä¼˜å…ˆçº§è¶Šé«˜ï¼Œä¾‹å¦‚-20ï¼Œè¯¥è¿›ç¨‹ä¸å€¾å‘äºè®©å‡ºCPUã€‚ æœ€é«˜çš„ä¼˜å…ˆçº§

```bash
ä½       æ­£å¸¸      é«˜
+20      0       -20
```

**nice æŒ‡å®šç¨‹åºè¿è¡Œä¼˜å…ˆçº§**

```bash
#è¯­æ³•æ ¼å¼ 
nice -n ä¼˜å…ˆçº§æ•°å­— è¿›ç¨‹åç§°

#1.å¼€å¯vimå¹¶ä¸”æŒ‡å®šç¨‹åºä¼˜å…ˆçº§ä¸º-5
[root@m01 ~]# nice -n -5 vim &
[1] 98417

#2.æŸ¥çœ‹è¯¥è¿›ç¨‹çš„ä¼˜å…ˆçº§æƒ…å†µ
[root@m01 ~]# ps axo pid,command,nice |grep 98417
 98417 vim                         -5
```

**renice ä¿®æ”¹æ­£åœ¨è¿è¡Œç¨‹åºçš„ä¼˜å…ˆçº§**

```bash
#è¯­æ³•æ ¼å¼ 
renice -n ä¼˜å…ˆçº§æ•°å­— è¿›ç¨‹pid

#1.æŸ¥çœ‹vimçš„è¿›ç¨‹id,åç§°,nice(ä¼˜å…ˆçº§)
[root@syc~]# ps axo pid,command,nice |grep vim |grep -v grep	#æŸ¥æ‰¾åè¿›è¡Œè¿‡æ»¤
 3621 vim                         -20

#2.ä¿®æ”¹vimçš„ä¼˜å…ˆçº§ä¸º-20
[root@syc~]# renice -n -20 3621
3621 (è¿›ç¨‹ ID) æ—§ä¼˜å…ˆçº§ä¸º 0ï¼Œæ–°ä¼˜å…ˆçº§ä¸º -20

#3.æŸ¥çœ‹vimçš„ä¼˜å…ˆçº§(è¿™ä¸ªè¿‡æ»¤çš„æ˜¯idå·,ä»€ä¹ˆè¿‡æ»¤çš„æ˜¯åå­—)
[root@syc~]# ps axo pid,command,nice |grep 3621
 3621 vim                         -20
 3629 grep --color=auto 3621      -20
```



### 14.3 kill ç®¡ç†è¿›ç¨‹çŠ¶æ€

å½“ç¨‹åºè¿è¡Œä¸ºè¿›ç¨‹åï¼Œå¦‚æœå¸Œæœ›åœæ­¢è¿›ç¨‹ï¼Œæ€ä¹ˆåŠå‘¢? é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨linuxçš„killå‘½ä»¤å¯¹è¿›ç¨‹å‘é€å…³é—­ä¿¡å·ã€‚å½“ç„¶é™¤äº†killã€è¿˜æœ‰killallï¼Œpkill

1.ä½¿ç”¨kill -låˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰€æ”¯æŒçš„ä¿¡å·

```bash
# kill -l
```

è™½ç„¶linuxæ”¯æŒä¿¡å·å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬ä»…åˆ—å‡ºæˆ‘ä»¬æœ€ä¸ºå¸¸ç”¨çš„3ä¸ªä¿¡å·

| æ•°å­—ç¼–å· | ä¿¡å·å«ä¹‰ | ä¿¡å·ç¿»è¯‘                     |
| :------- | :------- | :--------------------------- |
| 1        | SIGHUP   | é€šå¸¸ç”¨æ¥é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶     |
| 9        | SIGKILL  | å¼ºåˆ¶æ€æ­»è¿›ç¨‹                 |
| 15       | SIGTERM  | ç»ˆæ­¢è¿›ç¨‹ï¼Œé»˜è®¤killä½¿ç”¨è¯¥ä¿¡å· |

Linuxç³»ç»Ÿä¸­çš„killallã€pkillå‘½ä»¤ç”¨äºæ€æ­»æŒ‡å®šåå­—çš„è¿›ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨killå‘½ä»¤æ€æ­»æŒ‡å®šè¿›ç¨‹PIDçš„è¿›ç¨‹ï¼Œå¦‚æœè¦æ‰¾åˆ°æˆ‘ä»¬éœ€è¦æ€æ­»çš„è¿›ç¨‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ä¹‹å‰ä½¿ç”¨psç­‰å‘½ä»¤å†é…åˆgrepæ¥æŸ¥æ‰¾è¿›ç¨‹ï¼Œè€Œ**killall**ã€**pkill**æŠŠè¿™ä¸¤ä¸ªè¿‡ç¨‹åˆäºŒä¸ºä¸€ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å‘½ä»¤ã€‚

```bash
#1ã€é€šè¿‡æœåŠ¡åç§°æ€æ‰è¿›ç¨‹
[root@syc~]# killall vsftpd
[root@syc~]# pkill vsftpd
#2.ä½¿ç”¨pkillè¸¢å‡ºä»è¿œç¨‹ç™»å½•åˆ°æœ¬æœºçš„ç”¨æˆ·ï¼Œç»ˆæ­¢pts/0ä¸Šæ‰€æœ‰è¿›ç¨‹, å¹¶ä¸”bashä¹Ÿç»“æŸï¼ˆç”¨æˆ·è¢«å¼ºåˆ¶é€€å‡ºï¼‰
[root@syc~]# pkill -9 -t pts/0
```

### 14.4 jobsã€bgã€fgçš„ä½¿ç”¨

```bash
[root@xuliangwei ~]# sleep 3000 & 		//è¿è¡Œç¨‹åº(æ—¶)ï¼Œè®©å…¶åœ¨åå°æ‰§è¡Œ 
[root@xuliangwei ~]# sleep 4000 		//^Z,å°†å‰å°çš„ç¨‹åºæŒ‚èµ·(æš‚åœ)åˆ°åå° 
[2]+ Stopped sleep 4000
[root@xuliangwei ~]# ps aux |grep sleep
[root@xuliangwei ~]# jobs  				//æŸ¥çœ‹åå°ä½œä¸š
[1]- Running sleep 3000 & 
[2]+ Stopped sleep 4000

[root@xuliangwei ~]# bg %2     			//è®©ä½œä¸š 2 åœ¨åå°è¿è¡Œ
[root@xuliangwei ~]# fg %1     			//å°†ä½œä¸š 1 è°ƒå›åˆ°å‰å°
[root@xuliangwei ~]# kill %1   			//kill 1ï¼Œç»ˆæ­¢ PID ä¸º 1 çš„è¿›ç¨‹

[root@xuliangwei ~]# (while :; do date; sleep 2; done) & //è¿›ç¨‹åœ¨åå°è¿è¡Œï¼Œä½†è¾“å‡ºä¾ç„¶åœ¨å½“å‰ç»ˆç«¯
[root@xuliangwei ~]# (while :; do date; sleep 2; done) &>/dev/null &
```



### 14.5 screen ç®¡ç†åå°è¿›ç¨‹

```bash
é€‰é¡¹:
-list		æŸ¥çœ‹æ‰“å¼€çš„æ–°çª—å£
-r			åŠ çª—å£id	è¿›å…¥çª—å£
-s			æŒ‡å®šçª—å£åç§°

#1.æ‰“å¼€æ–°çš„çª—å£
[root@syc~]# screen 
2.æŒ‡å®šæ‰“å¼€ä¸€ä¸ªåå­—ä¸ºwykçš„çª—å£-----åŠ å¤§S
[root@syc~]# screen -S WYK
[root@syc~]# screen -list				##æŸ¥çœ‹æ‰€æœ‰çª—å£--------åŠ -list
There is a screen on:
        3285.WYK        (Attached)
1 Socket in /var/run/screen/S-root.

ç°åœ¨å·²ç»åœ¨æ–°æ‰“å¼€çš„wykçª—å£ä¸‹å¯ä»¥æ‰§è¡Œä¸€ä¸ªtopæŸ¥çœ‹è¿›ç¨‹çŠ¶æ€,Ctrl+a+då¹³æ»‘é€€å‡ºçª—å£,è¿™ä¸ªå‘½ä»¤è¿˜ä¼šåœ¨åå°è¿è¡Œ,
å°±ç®—å…³äº†ç»ˆç«¯ä¹Ÿä¸ä¼šé€€å‡º,ä¹Ÿæ˜¯éœ€è¦exitæ¥å…³é—­æ–°å»ºçš„screençª—å£

#2å¹³æ»‘çš„é€€å‡ºscreen,ä½†ä¸ä¼šç»ˆæ­¢screenä¸­çš„ä»»åŠ¡ã€‚æ³¨æ„: å¦‚æœä½¿ç”¨exit æ‰ç®—çœŸçš„å…³é—­screençª—å£

#3è¿›å…¥æ­£åœ¨è¿è¡Œçš„screen	 -rå¯ä»¥åŠ idå·ä¹Ÿå¯ä»¥åŠ åå­—è¿›å…¥
[root@syc~]# screen -r wyk
[root@syc~]# screen -r 3285
```



## 15. crond è®¡åˆ’ä»»åŠ¡

1.ç³»ç»Ÿçº§åˆ«çš„å®šæ—¶ä»»åŠ¡ï¼š ä¸´æ—¶æ–‡ä»¶æ¸…ç†ã€ç³»ç»Ÿä¿¡æ¯é‡‡é›†ã€æ—¥å¿—æ–‡ä»¶åˆ‡å‰²

2.ç”¨æˆ·çº§åˆ«çš„å®šæ—¶ä»»åŠ¡ï¼š å®šæ—¶å‘äº’è”ç½‘åŒæ­¥æ—¶é—´ã€å®šæ—¶å¤‡ä»½ç³»ç»Ÿé…ç½®æ–‡ä»¶ã€å®šæ—¶å¤‡ä»½æ•°æ®åº“çš„æ•°æ®

```bash
[root@ ~]# vim /etc/crontab
SHELL=/bin/bash                     #æ‰§è¡Œå‘½ä»¤çš„è§£é‡Šå™¨
PATH=/sbin:/bin:/usr/sbin:/usr/bin  #ç¯å¢ƒå˜é‡
MAILTO=root                         #é‚®ä»¶å‘ç»™è°
# Example of job definition:
# .---------------- minute (0 - 59) #åˆ†é’Ÿ
# |  .------------- hour (0 - 23)   #å°æ—¶
# |  |  .---------- day of month (1 - 31)   #æ—¥æœŸ
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr #æœˆä»½
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat  #æ˜ŸæœŸ
# |  |  |  |  |
# *  *  *  *  *   command to be executed

# *  è¡¨ç¤ºä»»æ„çš„(åˆ†ã€æ—¶ã€æ—¥ã€æœˆã€å‘¨)æ—¶é—´éƒ½æ‰§è¡Œ
# -  è¡¨ç¤ºä¸€ä¸ªæ—¶é—´èŒƒå›´æ®µ, å¦‚5-7ç‚¹
# ,  è¡¨ç¤ºåˆ†éš”æ—¶æ®µ, å¦‚6,0,4è¡¨ç¤ºå‘¨å…­ã€æ—¥ã€å››
# /1 è¡¨ç¤ºæ¯éš”nå•ä½æ—¶é—´, å¦‚*/10 æ¯10åˆ†é’Ÿ
```

2.äº†è§£crontabçš„æ—¶é—´ç¼–å†™è§„èŒƒ

```bash
00 02 * * * ls      #æ¯å¤©çš„å‡Œæ™¨2ç‚¹æ•´æ‰§è¡Œ
00 02 1 * * ls      #æ¯æœˆçš„1æ—¥çš„å‡Œæ™¨2ç‚¹æ•´æ‰§è¡Œ
00 02 14 2 * ls     #æ¯å¹´çš„2æœˆ14æ—¥å‡Œæ™¨2ç‚¹æ‰§è¡Œ
00 02 * * 7 ls      #æ¯å‘¨å¤©çš„å‡Œæ™¨2ç‚¹æ•´æ‰§è¡Œ
00 02 * 6 5 ls      #æ¯å¹´çš„6æœˆå‘¨äº”å‡Œæ™¨2ç‚¹æ‰§è¡Œ
00 02 14 * 7 ls     #æ¯æœˆ14æ—¥æˆ–æ¯å‘¨æ—¥çš„å‡Œæ™¨2ç‚¹éƒ½æ‰§è¡Œ
00 02 14 2 7 ls     #æ¯å¹´çš„2æœˆ14æ—¥æˆ–æ¯å¹´2æœˆçš„å‘¨å¤©çš„å‡Œæ™¨2ç‚¹æ‰§è¡Œ   
*/10  02 * * * ls   #æ¯å¤©å‡Œæ™¨2ç‚¹ï¼Œæ¯éš”10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
* * * * *  ls       #æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œ
00 00 14 2 *  ls    #æ¯å¹´2æœˆ14æ—¥çš„å‡Œæ™¨æ‰§è¡Œå‘½ä»¤ 
*/5 * * * *  ls     #æ¯éš”5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
00 02 * 1,5,8 * ls  #æ¯å¹´çš„1æœˆ5æœˆ8æœˆå‡Œæ™¨2ç‚¹æ‰§è¡Œ
00 02 1-8 * *  ls    #æ¯æœˆ1å·åˆ°8å·å‡Œæ™¨2ç‚¹æ‰§è¡Œ
0 21 * * * ls       #æ¯å¤©æ™šä¸Š21:00æ‰§è¡Œ
45 4 1,10,22 * * ls #æ¯æœˆ1ã€10ã€22æ—¥çš„4:45æ‰§è¡Œ
45 4 1-10 * * l     #æ¯æœˆ1åˆ°10æ—¥çš„4:45æ‰§è¡Œ
3,15 8-11 */2 * * ls #æ¯éš”ä¸¤å¤©çš„ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ
0 23-7/1 * * * ls   #æ™šä¸Š11ç‚¹åˆ°æ—©ä¸Š7ç‚¹ä¹‹é—´ï¼Œæ¯éš”ä¸€å°æ—¶æ‰§è¡Œ
15 21 * * 1-5 ls    #å‘¨ä¸€åˆ°å‘¨äº”æ¯å¤©æ™šä¸Š21:15æ‰§è¡Œ
```

### **crontabä½¿ç”¨**

```bash
#å‚æ•°	å«ä¹‰
-e	ç¼–è¾‘å®šæ—¶ä»»åŠ¡
-l	æŸ¥çœ‹å®šæ—¶ä»»åŠ¡
-r	åˆ é™¤å®šæ—¶ä»»åŠ¡
-u	æŒ‡å®šå…¶ä»–ç”¨æˆ·

1.ä½¿ç”¨rootç”¨æˆ·æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡æ—¶é—´åŒæ­¥

#1.å¦‚ä½•åŒæ­¥æ—¶é—´
[root@xuliangwei ~]# ntpdate time.windows.com &>/dev/null
#2.é…ç½®å®šæ—¶ä»»åŠ¡
[root@xuliangwei ~]# crontab -e -u root
[root@xuliangwei ~]# crontab -l -u root
*/5 * * * * ntpdate time.windows.com &>/dev/null

2.æ¯å¤©çš„ä¸‹åˆ3,5ç‚¹ï¼Œæ¯éš”åŠå°æ—¶æ‰§è¡Œä¸€æ¬¡syncå‘½ä»¤
[root@xuliangwei ~]# crontab -l
*/30 15,17 * * * sync &>/dev/null


3.æ¡ˆä¾‹ï¼šæ¯å¤©å‡Œæ™¨3ç‚¹åšä¸€æ¬¡å¤‡ä»½ï¼Ÿå¤‡ä»½/etc/ç›®å½•åˆ°/backupä¸‹é¢
1) å°†å¤‡ä»½å‘½ä»¤å†™å…¥ä¸€ä¸ªè„šæœ¬ä¸­
2) æ¯å¤©å¤‡ä»½æ–‡ä»¶åè¦æ±‚æ ¼å¼: 2019-05-01_hostname_etc.tar.gz
3) åœ¨æ‰§è¡Œè®¡åˆ’ä»»åŠ¡æ—¶ï¼Œä¸è¦è¾“å‡ºä»»åŠ¡ä¿¡æ¯
4) å­˜æ”¾å¤‡ä»½å†…å®¹çš„ç›®å½•è¦æ±‚åªä¿ç•™ä¸‰å¤©çš„æ•°æ®
#1.å®ç°å¦‚ä¸Šå¤‡ä»½éœ€æ±‚
[root@xuliangwei ~]# mkdir /backup
[root@xuliangwei ~]# tar zcf $(date +%F)_$(hostname)_etc.tar.gz /etc
[root@xuliangwei ~]# find /backup -name â€œ*.tar.gzâ€ -mtime +3 -exec rm -f {}\;

#2.å°†å‘½ä»¤å†™å…¥è‡³ä¸€ä¸ªæ–‡ä»¶ä¸­
[root@xuliangwei ~]# vim /root/back.sh
mkdir /backup
tar zcf $(date +%F)_$(hostname)_etc.tar.gz /etc
find /backup -name â€œ*.tar.gzâ€ -mtime +3 -exec rm -f {}\;

#3.é…ç½®å®šæ—¶ä»»åŠ¡
[root@xuliangwei ~]# crontab -l
00 03 * * * bash /root/back.sh  &>/dev/null

#3.å¤‡ä»½è„šæœ¬
[root@container ~]# cat /opt/backup.sh            
#!/usr/bin/bash
 
#1.ä½¿ç”¨tarå‘½ä»¤å¤‡ä»½/etcç›®å½•åˆ°backupç›®å½•
mkdir -p /backup
tar czf /backup/$(date +%F_%H_%M)_$(hostname)_etc.tar.gz /etc/
 
#2.ä¿ç•™æœ€è¿‘3å¤©çš„æ•°æ®ï¼Œå…¶ä½™å…¨éƒ¨åˆ é™¤
find /backup -type f -name "*.tar.gz" -mtime +3 -delete
```

**æ³¨æ„äº‹é¡¹**

```bash
1) ç»™å®šæ—¶ä»»åŠ¡æ³¨é‡Š
2) å°†éœ€è¦å®šæœŸæ‰§è¡Œçš„ä»»åŠ¡å†™å…¥Shellè„šæœ¬ä¸­ï¼Œé¿å…ç›´æ¥ä½¿ç”¨å‘½ä»¤æ— æ³•æ‰§è¡Œçš„æƒ…å†µtar date
3) å®šæ—¶ä»»åŠ¡çš„ç»“å°¾ä¸€å®šè¦æœ‰&>/dev/nullæˆ–è€…å°†ç»“æœè¿½åŠ é‡å®šå‘>>/tmp/date.logæ–‡ä»¶
4) æ³¨æ„æœ‰äº›å‘½ä»¤æ˜¯æ— æ³•æˆåŠŸæ‰§è¡Œçš„ echo "123" >>/tmp/test.log &>/dev/null
5.å¦‚æœä¸€å®šè¦æ˜¯ç”¨å‘½ä»¤ï¼Œå‘½ä»¤å¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„

5.crondå¦‚ä½•å¤‡ä»½
1) é€šè¿‡æŸ¥æ‰¾/var/log/cronä¸­æ‰§è¡Œçš„è®°å½•ï¼Œå»æ¨ç®—ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´
2) å®šæ—¶çš„å¤‡ä»½/var/spool/cron/{usernmae}

6.crondå¦‚ä½•æ‹’ç»æŸä¸ªç”¨æˆ·ä½¿ç”¨
#1.ä½¿ç”¨rootå°†éœ€è¦æ‹’ç»çš„ç”¨æˆ·åŠ å…¥/etc/cron.deny
[root@ ~]# echo "yikun" >> /etc/cron.deny

#2.ç™»é™†è¯¥æ™®é€šç”¨æˆ·ï¼Œæµ‹è¯•æ˜¯å¦èƒ½ç¼–å†™å®šæ—¶ä»»åŠ¡
[oldboy@yikun ~]$ crontab -e
You (yikun) are not allowed to use this program (crontab)
See crontab(1) for more information
```

**è®¡åˆ’ä»»åŠ¡å¦‚ä½•è°ƒè¯•**

```bash
1.æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åä¿ç•™æ‰§è¡ŒæˆåŠŸçš„ç»“æœã€‚
2.ç¼–å†™è„šæœ¬
è„šæœ¬éœ€è¦ç»Ÿä¸€è·¯å¾„/scripts
è„šæœ¬å†…å®¹å¤åˆ¶æ‰§è¡ŒæˆåŠŸçš„å‘½ä»¤(å‡å°‘æ¯ä¸ªç¯èŠ‚å‡ºé”™å‡ ç‡)
è„šæœ¬æ‰§è¡Œçš„è¾“å‡ºä¿¡æ¯å¯ä»¥é‡å®šå‘è‡³å…¶ä»–ä½ç½®ä¿ç•™æˆ–å†™å…¥/dev/null
3.æ‰§è¡Œè„šæœ¬
ä½¿ç”¨bashå‘½ä»¤æ‰§è¡Œ, é˜²æ­¢è„šæœ¬æ²¡æœ‰å¢åŠ æ‰§è¡Œæƒé™(/usr/bin/bash)
æ‰§è¡Œè„šæœ¬æˆåŠŸåï¼Œå¤åˆ¶è¯¥æ‰§è¡Œçš„å‘½ä»¤ï¼Œä»¥ä¾¿å†™å…¥cron
4.ç¼–å†™è®¡åˆ’ä»»åŠ¡
åŠ ä¸Šå¿…è¦çš„æ³¨é‡Šä¿¡æ¯, äººã€æ—¶é—´ã€ä»»åŠ¡
è®¾å®šè®¡åˆ’ä»»åŠ¡æ‰§è¡Œçš„å‘¨æœŸ
ç²˜è´´æ‰§è¡Œè„šæœ¬çš„å‘½ä»¤(ä¸è¦æ‰‹æ•²)
5.è°ƒè¯•è®¡åˆ’ä»»åŠ¡(è¿›è¡Œç¡®è®¤æ£€æŸ¥)
å¢åŠ ä»»åŠ¡é¢‘ç‡æµ‹è¯•
æ£€æŸ¥ç¯å¢ƒå˜é‡é—®é¢˜
æ£€æŸ¥crondæœåŠ¡æ—¥å¿—
```

## 16. ç³»ç»Ÿæ’æŸ¥

 **æˆ‘ä»¬ä»¥ä¸‰ä¸ªç¤ºä¾‹åˆ†åˆ«æ¥çœ‹è¿™ä¸‰ç§æƒ…å†µï¼Œå¹¶ç”¨ stressã€mpstatã€pidstat ç­‰å·¥å…·ï¼Œæ‰¾å‡ºå¹³å‡è´Ÿè½½å‡é«˜çš„æ ¹æºã€‚**
stress æ˜¯ Linux ç³»ç»Ÿå‹åŠ›æµ‹è¯•å·¥å…·ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä½œå¼‚å¸¸è¿›ç¨‹æ¨¡æ‹Ÿå¹³å‡è´Ÿè½½å‡é«˜çš„åœºæ™¯ã€‚
mpstat æ˜¯å¤šæ ¸ CPU æ€§èƒ½åˆ†æå·¥å…·ï¼Œç”¨æ¥å®æ—¶æŸ¥çœ‹æ¯ä¸ª CPU çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä»¥åŠæ‰€æœ‰ CPU çš„å¹³å‡æŒ‡æ ‡ã€‚
pidstat æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¿›ç¨‹æ€§èƒ½åˆ†æå·¥å…·ï¼Œç”¨æ¥å®æ—¶æŸ¥çœ‹è¿›ç¨‹çš„ CPUã€å†…å­˜ã€I/O ä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰æ€§èƒ½æŒ‡æ ‡ã€‚ 

```bash
#å¦‚æœå‡ºç°æ— æ³•ä½¿ç”¨mpstatã€pidstatå‘½ä»¤æŸ¥çœ‹%waitæŒ‡æ ‡å»ºè®®æ›´æ–°ä¸‹è½¯ä»¶åŒ…
wget http://pagesperso-orange.fr/sebastien.godard/sysstat-11.7.3-1.x86_64.rpm
rpm -Uvh sysstat-11.7.3-1.x86_64.rpm
```

### 16.1 CPU å¯†é›†å‹è¿›ç¨‹

*1.é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯è¿è¡Œ stress å‘½ä»¤ï¼Œæ¨¡æ‹Ÿä¸€ä¸ª CPU ä½¿ç”¨ç‡ 100% çš„åœºæ™¯ï¼š*

```bash
[root@m01 ~]# stress --cpu 1 --timeout 600
```

*2.æ¥ç€ï¼Œåœ¨ç¬¬äºŒä¸ªç»ˆç«¯è¿è¡Œ uptime æŸ¥çœ‹å¹³å‡è´Ÿè½½çš„å˜åŒ–æƒ…å†µ*

```bash
# ä½¿ç”¨watch -d å‚æ•°è¡¨ç¤ºé«˜äº®æ˜¾ç¤ºå˜åŒ–çš„åŒºåŸŸ(æ³¨æ„è´Ÿè½½ä¼šæŒç»­å‡é«˜)
[root@m01 ~]# watch -d uptime
17:27:44 up 2 days,  3:11,  3 users,  load average: 1.10, 0.30, 0.17
```

*3.æœ€åï¼Œåœ¨ç¬¬ä¸‰ä¸ªç»ˆç«¯è¿è¡Œ mpstat æŸ¥çœ‹ CPU ä½¿ç”¨ç‡çš„å˜åŒ–æƒ…å†µ*

```bash
# -P ALL è¡¨ç¤ºç›‘æ§æ‰€æœ‰ CPUï¼Œåé¢æ•°å­— 5 è¡¨ç¤ºé—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®
[root@m01 ~]# mpstat -P ALL 5
Linux 3.10.0-957.1.3.el7.x86_64 (m01)   2019å¹´04æœˆ29æ—¥     _x86_64_    (1 CPU)

17æ—¶32åˆ†03ç§’  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
17æ—¶32åˆ†08ç§’  all   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
17æ—¶32åˆ†08ç§’    0   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00

#å•æ ¸CPUæ‰€ä»¥åªæœ‰ä¸€ä¸ªallå’Œ0
```

*4.ä»ç»ˆç«¯äºŒä¸­å¯ä»¥çœ‹åˆ°ï¼Œ1 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ä¼šæ…¢æ…¢å¢åŠ åˆ° 1.00ï¼Œè€Œä»ç»ˆç«¯ä¸‰ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæ­£å¥½æœ‰ä¸€ä¸ª CPU çš„ä½¿ç”¨ç‡ä¸º 100%ï¼Œä½†å®ƒçš„ iowait åªæœ‰ 0ã€‚è¿™è¯´æ˜ï¼Œå¹³å‡è´Ÿè½½çš„å‡é«˜æ­£æ˜¯ç”±äº CPU ä½¿ç”¨ç‡ä¸º 100% ã€‚é‚£ä¹ˆï¼Œåˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹å¯¼è‡´äº† CPU ä½¿ç”¨ç‡ä¸º 100% å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ pidstat æ¥æŸ¥è¯¢*

```bash
# é—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®
[root@m01 ~]# pidstat -u 5 1
Linux 3.10.0-957.1.3.el7.x86_64 (m01)   2019å¹´04æœˆ29æ—¥     _x86_64_(1 CPU)

17æ—¶33åˆ†21ç§’   UID       PID    %usr %system  %guest    %CPU   CPU  Command
17æ—¶33åˆ†26ç§’     0    110019   98.80    0.00    0.00   98.80     0  stress

#ä»è¿™é‡Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°ï¼Œstress è¿›ç¨‹çš„ CPU ä½¿ç”¨ç‡ä¸º 100%ã€‚
```

### 16.2 I/O å¯†é›†å‹è¿›ç¨‹

*1.é¦–å…ˆè¿˜æ˜¯è¿è¡Œ stress å‘½ä»¤ï¼Œä½†è¿™æ¬¡æ¨¡æ‹Ÿ I/O å‹åŠ›ï¼Œå³ä¸åœåœ°æ‰§è¡Œ sync*

```bash
[root@m01 ~]# stress  --io 1 --timeout 600s
```

*2.ç„¶ååœ¨ç¬¬äºŒä¸ªç»ˆç«¯è¿è¡Œ uptime æŸ¥çœ‹å¹³å‡è´Ÿè½½çš„å˜åŒ–æƒ…å†µï¼š*

```bash
[root@m01 ~]# watch -d uptime
18:43:51 up 2 days,  4:27,  3 users,  load average: 1.12, 0.65, 0.00
```

*3.æœ€åç¬¬ä¸‰ä¸ªç»ˆç«¯è¿è¡Œ mpstat æŸ¥çœ‹ CPU ä½¿ç”¨ç‡çš„å˜åŒ–æƒ…å†µï¼š*

```bash
# æ˜¾ç¤ºæ‰€æœ‰ CPU çš„æŒ‡æ ‡ï¼Œå¹¶åœ¨é—´éš” 5 ç§’è¾“å‡ºä¸€ç»„æ•°æ®
[root@m01 ~]# mpstat -P ALL 5
Linux 3.10.0-693.2.2.el7.x86_64 (bgx.com)   2019å¹´05æœˆ07æ—¥     _x86_64_    (1 CPU)

14æ—¶20åˆ†07ç§’  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
14æ—¶20åˆ†12ç§’  all    0.20    0.00   82.45   17.35    0.00    0.00    0.00    0.00    0.00    0.00
14æ—¶20åˆ†12ç§’    0    0.20    0.00   82.45   17.35    0.00    0.00    0.00    0.00    0.00    0.00

#ä¼šå‘ç°cpuçš„ä¸å†…æ ¸æ‰“äº¤é“çš„syså ç”¨éå¸¸é«˜
```

*4.é‚£ä¹ˆåˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹ï¼Œå¯¼è‡´ iowait è¿™ä¹ˆé«˜å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ç”¨ pidstat æ¥æŸ¥è¯¢*

```bash
# é—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®ï¼Œ-u è¡¨ç¤º CPU æŒ‡æ ‡
[root@m01 ~]# pidstat -u 5 1
Linux 3.10.0-957.1.3.el7.x86_64 (m01)   2019å¹´04æœˆ29æ—¥     _x86_64_(1 CPU)
18æ—¶29åˆ†37ç§’   UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
18æ—¶29åˆ†42ç§’     0    127259   32.60    0.20    0.00   67.20   32.80     0  stress
18æ—¶29åˆ†42ç§’     0    127261    4.60   28.20    0.00   67.20   32.80     0  stress
18æ—¶29åˆ†42ç§’     0    127262    4.20   28.60    0.00   67.20   32.80     0  stress

#å¯ä»¥å‘ç°ï¼Œè¿˜æ˜¯ stress è¿›ç¨‹å¯¼è‡´çš„ã€‚
```

### 16.3 å¤§é‡è¿›ç¨‹åœºæ™¯

*å½“ç³»ç»Ÿä¸­è¿è¡Œè¿›ç¨‹è¶…å‡º CPU è¿è¡Œèƒ½åŠ›æ—¶ï¼Œå°±ä¼šå‡ºç°ç­‰å¾… CPU çš„è¿›ç¨‹ã€‚*

*1.é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ stressï¼Œä½†è¿™æ¬¡æ¨¡æ‹Ÿçš„æ˜¯ 4 ä¸ªè¿›ç¨‹*

```bash
[root@m01 ~]# stress -c 4 --timeout 600
```

*2.ç”±äºç³»ç»Ÿåªæœ‰ 1 ä¸ª CPUï¼Œæ˜æ˜¾æ¯” 4 ä¸ªè¿›ç¨‹è¦å°‘å¾—å¤šï¼Œå› è€Œï¼Œç³»ç»Ÿçš„ CPU å¤„äºä¸¥é‡è¿‡è½½çŠ¶æ€*

```bash
[root@m01 ~]# watch -d uptime
19:11:07 up 2 days,  4:45,  3 users,  load average: 4.65, 2.65, 4.65
```

*3.ç„¶åï¼Œå†è¿è¡Œ pidstat æ¥çœ‹ä¸€ä¸‹è¿›ç¨‹çš„æƒ…å†µï¼š*

```bash
# é—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®
[root@m01 ~]# pidstat -u 5 1
å¹³å‡æ—¶é—´:   UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
å¹³å‡æ—¶é—´:     0    130290   24.55    0.00    0.00   75.25   24.55     -  stress
å¹³å‡æ—¶é—´:     0    130291   24.95    0.00    0.00   75.25   24.95     -  stress
å¹³å‡æ—¶é—´:     0    130292   24.95    0.00    0.00   75.25   24.95     -  stress
å¹³å‡æ—¶é—´:     0    130293   24.75    0.00    0.00   74.65   24.75     -  stress
```

*å¯ä»¥çœ‹å‡ºï¼Œ4 ä¸ªè¿›ç¨‹åœ¨äº‰æŠ¢ 1 ä¸ª CPUï¼Œæ¯ä¸ªè¿›ç¨‹ç­‰å¾… CPU çš„æ—¶é—´ï¼ˆä¹Ÿå°±æ˜¯ä»£ç å—ä¸­çš„ %wait åˆ—ï¼‰é«˜è¾¾ 75%ã€‚è¿™äº›è¶…å‡º CPU è®¡ç®—èƒ½åŠ›çš„è¿›ç¨‹ï¼Œæœ€ç»ˆå¯¼è‡´ CPU è¿‡è½½ã€‚*

#### æ€»ç»“

https://www.cnblogs.com/muahao/p/6346775.html

```bash
å¹³å‡è´Ÿè½½æä¾›äº†ä¸€ä¸ªå¿«é€ŸæŸ¥çœ‹ç³»ç»Ÿæ•´ä½“æ€§èƒ½çš„æ‰‹æ®µï¼Œåæ˜ äº†æ•´ä½“çš„è´Ÿè½½æƒ…å†µã€‚ä½†åªçœ‹å¹³å‡è´Ÿè½½æœ¬èº«ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥å‘ç°ï¼Œåˆ°åº•æ˜¯å“ªé‡Œå‡ºç°äº†ç“¶é¢ˆã€‚æ‰€ä»¥ï¼Œåœ¨ç†è§£å¹³å‡è´Ÿè½½æ—¶ï¼Œä¹Ÿè¦æ³¨æ„ï¼š
å¹³å‡è´Ÿè½½é«˜æœ‰å¯èƒ½æ˜¯ CPU å¯†é›†å‹è¿›ç¨‹å¯¼è‡´çš„ï¼›
å¹³å‡è´Ÿè½½é«˜å¹¶ä¸ä¸€å®šä»£è¡¨ CPU ä½¿ç”¨ç‡é«˜ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯ I/O æ›´ç¹å¿™äº†ï¼›
å½“å‘ç°è´Ÿè½½é«˜çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ mpstatã€pidstat ç­‰å·¥å…·ï¼Œè¾…åŠ©åˆ†æè´Ÿè½½çš„æ¥æº
```

## 17. systemctl ç³»ç»Ÿç®¡ç†

**systemdç›¸å…³é…ç½®æ–‡ä»¶**

```
/usr/lib/systemd/system/ 	#ç±»ä¼¼Centos6ç³»ç»Ÿçš„å¯åŠ¨è„šæœ¬ï¼Œ/etc/init.d/
/etc/systemd/system/ 		#ç±»ä¼¼Centos6ç³»ç»Ÿçš„/etc/rc.d/rcN.d/
/etc/systemd/system/multi-user.target.wants/
```

**systemdç®¡ç†æœåŠ¡ç›¸å…³å‘½ä»¤**
systemctlç®¡ç†æœåŠ¡çš„å¯åŠ¨ã€é‡å¯ã€åœæ­¢ã€é‡è½½ã€æŸ¥çœ‹çŠ¶æ€ç­‰å¸¸ç”¨å‘½ä»¤
é’ˆå¯¹å½“å‰æ­£åœ¨è¿è¡Œçš„ç¨‹ åº

| systemctlå‘½ä»¤                    | ä½œç”¨                 |
| :------------------------------- | :------------------- |
| systemctl start crond.service    | å¯åŠ¨æœåŠ¡             |
| systemctl stop crond.service     | åœæ­¢æœåŠ¡             |
| systemctl restart crond.service  | é‡å¯æœåŠ¡             |
| systemctl reload crond.service   | é‡æ–°åŠ è½½é…ç½®         |
| systemctl status crond.servre    | æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€     |
| systemctl is-active sshd.service | æŸ¥çœ‹æœåŠ¡æ˜¯å¦åœ¨è¿è¡Œä¸­ |
| systemctl mask crond.servre      | ç¦æ­¢æœåŠ¡è¿è¡Œ         |
| systemctl unmask crond.servre    | å–æ¶ˆç¦æ­¢æœåŠ¡è¿è¡Œ     |

**å½“æˆ‘ä»¬ä½¿ç”¨systemctlå¯åŠ¨ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹åï¼Œå¯ä»¥é€šè¿‡sysctemctl statusæŸ¥çœ‹æ­¤å®ˆæŠ¤è¿›ç¨‹çš„çŠ¶æ€**

| çŠ¶æ€            | æè¿°                                     |
| :-------------- | :--------------------------------------- |
| loaded          | æœåŠ¡å•å…ƒçš„é…ç½®æ–‡ä»¶å·²ç»è¢«å¤„ç†             |
| active(running) | æœåŠ¡æŒç»­è¿è¡Œ                             |
| active(exited)  | æœåŠ¡æˆåŠŸå®Œæˆä¸€æ¬¡çš„é…ç½®                   |
| active(waiting) | æœåŠ¡å·²ç»è¿è¡Œä½†åœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶             |
| inactive        | æœåŠ¡æ²¡æœ‰åœ¨è¿è¡Œ                           |
| enabled         | æœåŠ¡è®¾å®šä¸ºå¼€æœºè¿è¡Œ                       |
| disabled        | æœåŠ¡è®¾å®šä¸ºå¼€æœºä¸è¿è¡Œ                     |
| static          | æœåŠ¡å¼€æœºä¸å¯åŠ¨ï¼Œä½†å¯ä»¥è¢«å…¶ä»–æœåŠ¡è°ƒç”¨å¯åŠ¨ |

**systemctl è®¾ç½®æœåŠ¡å¼€æœºå¯åŠ¨ã€ä¸å¯åŠ¨ã€æŸ¥çœ‹å„çº§åˆ«ä¸‹æœåŠ¡å¯åŠ¨çŠ¶æ€ç­‰å¸¸ç”¨å‘½ä»¤**

```bash
systemctlå‘½ä»¤ï¼ˆ7ç³»ç»Ÿï¼‰						ä½œç”¨

systemctl enable crond.service				å¼€æœºè‡ªåŠ¨å¯åŠ¨
systemctl disable crond.service				å¼€æœºä¸è‡ªåŠ¨å¯åŠ¨
systemctl list-unit-files					æŸ¥çœ‹å„ä¸ªçº§åˆ«ä¸‹æœåŠ¡çš„å¯åŠ¨ä¸ç¦ç”¨
systemctl is-enabled crond.service			æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ˜¯å¦ä¸ºå¼€æœºè‡ªå¯åŠ¨
systemctl daemon-reload						åˆ›å»ºæ–°æœåŠ¡æ–‡ä»¶éœ€è¦é‡è½½å˜æ›´(æ›´æ”¹æœåŠ¡åè¦å¯åŠ¨ä¸æˆåŠŸæ—¶ä¼šæç¤ºæ‰§è¡Œè¿™ä¸ªå‘½ä»¤)
```
**systemctlçš„journalctlæ—¥å¿—**

```
journalctl -n 20    #æŸ¥çœ‹æœ€å20è¡Œ
journalctl -f       #åŠ¨æ€æŸ¥çœ‹æ—¥å¿—
journalctl -p err   #æŸ¥çœ‹æ—¥å¿—çš„çº§åˆ«
journalctl -u crond #æŸ¥çœ‹æŸä¸ªæœåŠ¡çš„å•å…ƒçš„æ—¥å¿—
```

# LinuxåŸºç¡€çŸ¥è¯†

## 0.linuxç›®å½•ç»“æ„

```bash
[root@wyk ~]# ll /
usr								ç³»ç»Ÿæ–‡ä»¶ç›®å½•ç›¸å½“äºc:\windows
lib -> usr/lib					åº“æ–‡ä»¶Glibc 32bit  æ±½è½¦çš„èºä¸			
lib64 -> usr/lib64				åº“æ–‡ä»¶Glibc 64bit  æ±½è½¦çš„èºä¸	
sbin -> usr/sbin   				ç®¡ç†å‘˜ä½¿ç”¨çš„å‘½ä»¤    /sbin/shutdown, /sbin/reboot
bin -> usr/bin     				æ™®é€šç”¨æˆ·ä½¿ç”¨çš„å‘½ä»¤   /bin/ls, /bin/date 
boot							å­˜æ”¾ç³»ç»Ÿå¯åŠ¨ç›¸å…³çš„æ–‡ä»¶, ä¾‹å¦‚:kernel, grub(å¼•å¯¼è£…è½½ç¨‹åº)
								grubï¼ˆ å‘Šè¯‰ä½  æœ‰å“ªäº›å†…æ ¸ï¼Œä½ å¯ä»¥é€‰æ‹©éœ€è¦åŠ è½½çš„é‚£ä¸€ä¸ªï¼‰
   							 	vmlinuz-3.10.0-957.12.2.el7.x86_64  æ­£å¸¸çš„ç³»ç»Ÿå†…æ ¸
    							vmlinuz-0-rescue-93f219319dd5bdb4xx ç»Ÿçš„æ•‘æ´å†…æ ¸
etc								ç³»ç»Ÿé…ç½®æ–‡ä»¶
home							æ™®é€šç”¨æˆ·å®¶ç›®å½•
root							ç³»ç»Ÿç®¡ç†å‘˜å®¶ç›®å½•
proc							è¿›ç¨‹æ–‡ä»¶
tmp								ä¸´æ—¶ç›®å½•
var								æ—¥å¿—æ–‡ä»¶
/var/tmp						è¿›ç¨‹äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶
dev								è®¾å¤‡ç›®å½•æ–‡ä»¶(ç¡¬ç›˜\å…‰é©±ç­‰ç­‰)
/dev   							å­˜æ”¾è®¾å¤‡æ–‡ä»¶,æ¯”å¦‚ç¡¬ç›˜,ç¡¬ç›˜åˆ†åŒº,å…‰é©±,ç­‰ç­‰
/dev/null  						é»‘æ´è®¾å¤‡,åªè¿›ä¸å‡º.ç±»ä¼¼äºåƒåœ¾å›æ”¶ç«™
/dev/random    					ç”Ÿæˆéšæœºæ•°è®¾å¤‡
/dev/zero  						èƒ½æºæºä¸æ–­çš„äº§ç”Ÿæ•°æ®,ç±»ä¼¼äºå–æ¬¾æœº,éšæ—¶éšåœ°å–é’±

--------------------------------------------------------------
media       					æŒ‚è½½æˆ‘ä»¬çš„uç›˜ã€æˆ–è€…å…¶ä»–è®¾å¤‡
mnt     						æŒ‚è½½æˆ‘ä»¬çš„uç›˜ã€æˆ–è€…å…¶ä»–è®¾å¤‡
opt     						ä¸‰æ–¹å‚å•†åŒ…ç›®å½•oracle  gitlab
run     						åŒ…å«ç³»ç»Ÿè¿è¡Œæ—¶æ‰€éœ€è¦çš„æ–‡ä»¶ã€‚ä»¥å‰ /var/run
srv     						æœåŠ¡å¯åŠ¨åéœ€è¦è®¿é—®çš„æ•°æ®ç›®å½•ã€‚ä½¿ç”¨å¾ˆå°‘| saltstack
sys     						syså’Œprocä¸€æ ·æ˜¯è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œè®°å½•æ ¸å¿ƒç³»ç»Ÿç¡¬ä»¶ä¿¡æ¯ã€‚
```

## 1.æ–‡ä»¶å±æ€§ç±»å‹

1.1.æ–‡ä»¶å±æ€§

```bash
æ•´ä¸ªæ–‡ä»¶çš„å±æ€§åˆ†ä¸ºååˆ—
#ls -l
-rw-r--r-- 1 root root 1019 Apr 28 15:41 pass.txt

-                   1ï¼šæ–‡ä»¶ç±»å‹              
rw-r--r--           2ï¼šæƒé™    
1                   3ï¼šè¡¨ç¤ºç¡¬é“¾æ¥æ•°                
root                4ï¼šè¿™ä¸ªæ–‡ä»¶çš„æ‹¥æœ‰äººæ˜¯è°       ï¼ˆä¸ªäººï¼‰
root                5ï¼šè¿™ä¸ªæ–‡ä»¶çš„æ‹¥æœ‰ç»„æ˜¯è°       ï¼ˆå°ç»„ï¼‰
1019                6ï¼šæ–‡ä»¶å¤§å°
Apr 28 15:41        7ã€8ã€9ï¼šæ–‡ä»¶åˆ›å»ºæˆ–ä¿®æ”¹çš„æ—¶é—´
pass.txt            10:æ–‡ä»¶çš„åç§°
```

1.2.æ–‡ä»¶ç±»å‹

```bash
ä½¿ç”¨ll æˆ–è€… ls -l èƒ½å¤ŸåŒºåˆ†å‡ºæ¥çš„æ•ˆæœ
-:  è¡¨ç¤ºæ˜¯ä¸€ä¸ªæ–‡ä»¶( æ™®é€šæ–‡ä»¶ã€è„šæœ¬æ–‡ä»¶ã€å‹ç¼©æ–‡ä»¶ã€å‘½ä»¤æ–‡ä»¶)
s:  socket,è¿›ç¨‹ä¸è¿›ç¨‹ä¹‹é—´çš„é€šè®¯åè®®
c:  å­—ç¬¦è®¾å¤‡ï¼ˆç»ˆç«¯ã€é”®ç›˜ï¼‰
b:  å—è®¾å¤‡ï¼ˆç£ç›˜ï¼‰
l:  è½¯é“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰
d:  è¡¨ç¤ºä¸€ä¸ªç›®å½•
```

1.3.file åˆ¤æ–­æ–‡ä»¶ç±»å‹

```bash
æˆ‘ä»¬æ— æ³•é€šè¿‡ls -læ–‡ä»¶çš„ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒå¯èƒ½æ˜¯æ™®é€šæ–‡ä»¶ã€ä¹Ÿå¯èƒ½æ˜¯å‹ç¼©æ–‡ä»¶ã€æˆ–è€…æ˜¯å‘½ä»¤æ–‡ä»¶ç­‰ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨fileæ¥æ›´åŠ ç²¾å‡†çš„åˆ¤æ–­è¿™ä¸ªæ–‡ä»¶çš„ç±»å‹

fileå‘½ä»¤åˆ¤æ–­æœ€å‡†ç¡®
é€šè¿‡åç¼€åˆ¤æ–­æ–‡ä»¶ç±»å‹ mp4 sh zip txt log........
```

## 2.ç”¨æˆ·ã€ç»„ç®¡ç†

**1.ç”¨æˆ·ç®¡ç†**

**/etc/passwd**,è®°å½•äº†ç”¨æˆ·çš„ä¿¡æ¯ **/etc/shadow** è®°å½•äº†ç”¨æˆ·çš„å¯†ç 

```
# head -n1 /etc/passwd
root:x:0:0:root:/root:/bin/bash         #ä»¥:ä½œä¸ºåˆ†éš”ç¬¦,æ€»å…±ä¸ƒåˆ—
  1  2 3 4  5      6      7
åˆ†åˆ«ä¸ºï¼š
ç”¨æˆ·åç§°:å¯†ç å ä½ç¬¦:ç”¨æˆ·UID:ç»„GID:æ³¨é‡Šä¿¡æ¯:ç”¨æˆ·å®¶ç›®å½•:ç™»å½•shell
```

**ç³»ç»Ÿå¯¹ç”¨æˆ·æœ‰ä¸€ä¸ªçº¦å®š**

| ç”¨æˆ·UID | ç³»ç»Ÿä¸­çº¦å®šçš„å«ä¹‰                                          |
| ------- | --------------------------------------------------------- |
| 0       | è¶…çº§ç®¡ç†,æœ€é«˜æƒé™,æœ‰ç€æå¼ºçš„ç ´ååŠ›                        |
| 1~200   | ç³»ç»Ÿç”¨æˆ·,ç”¨æ¥è¿è¡Œç³»ç»Ÿè‡ªå¸¦çš„è¿›ç¨‹,é»˜è®¤å·²åˆ›å»º                |
| 201~999 | ç³»ç»Ÿç”¨æˆ·,ç”¨æ¥è¿è¡Œç”¨æˆ·å®‰è£…çš„ç¨‹åº,æ‰€æœ‰æ­¤ç±»ç”¨æˆ·æ— éœ€ç™»å½•ç³»ç»Ÿ  |
| 1000+   | æ™®é€šç”¨æˆ·,æ­£å¸¸å¯ä»¥ç™»å½•ç³»ç»Ÿç”¨æˆ·,æƒé™æ¯”è¾ƒå°,èƒ½æ‰§è¡Œçš„ä»»åŠ¡æœ‰é™ |

 **ç”¨æˆ·åˆ›å»ºæµç¨‹**

```shell
#useraddåˆ›å»ºç”¨æˆ·æ—¶ï¼Œç³»ç»Ÿä¼šä»¥/etc/login.defsã€/etc/default/useradd ä¸¤ä¸ªé…ç½®æ–‡ä»¶ä½œä¸ºå‚ç…§ç‰©ï¼Œå¦‚æœåœ¨åˆ›å»ºç”¨æˆ·æ—¶æŒ‡å®šäº†å‚æ•°åˆ™ä¼šè¦†ç›–etc/login.defsã€/etc/default/useraddæ–‡ä»¶é»˜è®¤é…ç½®ï¼Œå¦‚æœªæŒ‡å®šåˆ™ä½¿ç”¨é»˜è®¤ã€‚

[root@test01 ~]# grep -E -v "^#|^$" /etc/login.defs 
MAIL_DIR        /var/spool/mail         åˆ›å»ºé‚®ç®±çš„ä½ç½®
PASS_MAX_DAYS   99999                   å¯†ç æœ€é•¿ä½¿ç”¨çš„å¤©æ•°
PASS_MIN_DAYS   0                       å¯†ç æœ€çŸ­ä½¿ç”¨çš„å¤©æ•°
PASS_MIN_LEN    5                       å¯†ç é•¿åº¦
PASS_WARN_AGE   7                       å¯†ç åˆ°æœŸå‰7å¤©è­¦å‘Š
UID_MIN                  1000           ç”¨æˆ·uidæœ€å°å€¼
UID_MAX                 60000           ç”¨æˆ·uidæœ€å¤§å€¼
SYS_UID_MIN               201           ç³»ç»Ÿuidæœ€å°å€¼
SYS_UID_MAX               999           ç³»ç»Ÿuidæœ€å¤§å€¼
GID_MIN                  1000           ç»„idæœ€å°å€¼
GID_MAX                 60000           ç»„idæœ€å¤§å€¼
SYS_GID_MIN               201           ç³»ç»ŸGIDæœ€å¤§å€¼
SYS_GID_MAX               999           ç³»ç»ŸGIDæœ€å¤§å€¼
CREATE_HOME yes                         æ˜¯å¦åˆ›å»ºåŠ ç›®å½•å¼€å…³
UMASK           077                     æƒé™ä½
USERGROUPS_ENAB yes                     åˆ›å»ºç”¨æˆ·é»˜è®¤ç»„å¼€å…³
ENCRYPT_METHOD SHA512                   å¯†ç åŠ å¯†ç®—æ³•

[root@test01 ~]# cat /etc/default/useradd 
# useradd defaults file
GROUP=100                   å…³é—­é»˜è®¤åˆ›å»ºç»„å¼€å…³åï¼Œé»˜è®¤åˆ†é…GID100çš„ç»„
HOME=/home                  é»˜è®¤å®¶ç›®å½•
INACTIVE=-1                 ç”¨æˆ·å¤±æ•ˆæ—¶é—´ï¼Œ-1æ°¸ä¹…ä¸å¤±æ•ˆ
EXPIRE=                     è¿‡æœŸæ—¶é—´
SHELL=/bin/bash             é»˜è®¤ç™»å½•shell
SKEL=/etc/skel              é»˜è®¤ç”¨æˆ·æ‹·è´çš„ç¯å¢ƒå˜é‡ï¼ˆå‘½ä»¤æç¤ºç¬¦ï¼‰
CREATE_MAIL_SPOOL=yes       æ˜¯å¦å¼€å¯é‚®ç®±å¼€å…³

```

**2.ç»„ç®¡ç†**

```
åŸºæœ¬ç»„ï¼šåˆ›å»ºæ—¶æŒ‡å®šç»„ï¼Œå°±å«åŸºæœ¬ç»„ï¼Œåˆ›å»ºæ—¶å¯é€šè¿‡-gæŒ‡å®šï¼Œå¦‚æœªæŒ‡å®šåˆ™åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ç»„ä¸ç”¨æˆ·åŒå  ï¼ˆåªèƒ½æœ‰1ä¸ªï¼‰
ç§æœ‰ç»„ï¼šåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šç»„ï¼Œé»˜è®¤åˆ›å»ºä¸ç”¨æˆ·åŒåçš„ç»„        ï¼ˆåªæœ‰æœ‰1ä¸ªï¼‰
é™„åŠ ç»„ï¼šåŸºæœ¬ç»„å¦‚æœæ— æ³•æ»¡è¶³æˆæƒè¦æ±‚ï¼Œå¯ä»¥å°†ç”¨æˆ·åŠ å…¥æœ‰æƒé™çš„é™„åŠ ç»„ï¼Œç”¨æˆ·é¡ºåŠ¿ç»§æ‰¿è¯¥ç»„çš„æƒé™ã€‚å½“ç„¶é™„åŠ ç»„å¯ä»¥ï¼ˆæœ‰Nå¤šä¸ª)

   ps:
        1.é¦–å…ˆå¾—æœ‰ç»„ã€‚
        2.åœ¨è¿›è¡ŒåŠ å…¥ã€‚
```

| ç”¨æˆ·UID | ç³»ç»Ÿä¸­çº¦å®šçš„å«ä¹‰                                             |
| ------- | ------------------------------------------------------------ |
| 0       | è¶…çº§ç®¡ç†å‘˜ï¼Œæœ€é«˜æƒé™ï¼Œæœ‰ç€æå¼ºçš„ç ´åèƒ½åŠ›                     |
| 1~200   | ç³»ç»Ÿç”¨æˆ·ï¼Œç”¨æ¥è¿è¡Œç³»ç»Ÿè‡ªå¸¦çš„è¿›ç¨‹ï¼Œé»˜è®¤å·²åˆ›å»º                 |
| 201~999 | ç³»ç»Ÿç”¨æˆ·ï¼Œç”¨æ¥è¿è¡Œç”¨æˆ·å®‰è£…çš„ç¨‹åºï¼Œæ‰€ä»¥æ­¤ç±»ç”¨æˆ·æ— éœ€ç™»å½•ç³»ç»Ÿ   |
| 1000+   | æ™®é€šç”¨æˆ·ï¼Œæ­£å¸¸å¯ä»¥ç™»é™†ç³»ç»Ÿçš„ç”¨æˆ·ï¼Œæƒé™æ¯”è¾ƒå°ï¼Œèƒ½æ‰§è¡Œçš„ä»»åŠ¡æœ‰é™ |

## 3. æ–‡ä»¶æƒé™ç®¡ç†

1ã€æƒé™ä¸­çš„rwxæ˜¯å¹²ä»€ä¹ˆçš„

| å­—æ¯        | å«ä¹‰     | å¯¹åº”æƒé™ |
| :---------- | :------- | :------- |
| r(read)     | è¯»å–æƒé™ | 4        |
| w(write)    | å†™å…¥æƒé™ | 2        |
| x(execute)  | æ‰§è¡Œæƒé™ | 1        |
| -(æ²¡æœ‰æƒé™) | æ²¡æœ‰æƒé™ | 0        |

2ã€**æƒé™ä¸­çš„rwxå¯¹æ–‡ä»¶çš„å½±å“ï¼š**

```
è¯»å–æƒé™ï¼ˆrï¼‰å…·æœ‰è¯»å–\é˜…è¯»æ–‡ä»¶å†…å®¹æƒé™
1.åªèƒ½ä½¿ç”¨æŸ¥çœ‹ç±»å‘½ä»¤catã€headã€tailã€lessã€more

å†™å…¥æƒé™ï¼ˆwï¼‰å…·æœ‰æ–°å¢ã€ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æƒé™
1.ä½¿ç”¨vimç¼–è¾‘ä¼šæç¤ºæƒé™æ‹’ç», ä½†å¯å¼ºåˆ¶ä¿å­˜,ä¼šè¦†ç›–æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹
2.ä½¿ç”¨echoå‘½ä»¤é‡å®šå‘çš„æ–¹å¼å¯ä»¥å¾€æ–‡ä»¶å†…å†™å…¥æ•°æ®,  >>å¯ä»¥è¿›è¡Œè¿½åŠ 
3.ä¸èƒ½åˆ é™¤æ–‡ä»¶,å› ä¸ºåˆ é™¤æ–‡ä»¶çœ‹çš„ä¸æ˜¯æ–‡ä»¶çš„å±æ€§,  éœ€è¦çœ‹ä¸Šçº§ç›®å½•æ˜¯å¦æœ‰wçš„æƒé™

æ‰§è¡Œæƒé™ï¼ˆxï¼‰å…·æœ‰æ‰§è¡Œæ–‡ä»¶çš„æƒé™
1.æ‰§è¡Œæƒé™ä»€ä¹ˆç”¨éƒ½æ²¡æœ‰
2.å¦‚æœæ™®é€šç”¨æˆ·éœ€è¦æ‰§è¡Œæ–‡ä»¶,éœ€è¦é…åˆræƒé™   rx ï¼ˆå‘½ä»¤ï¼‰  rwï¼ˆé…ç½®æ–‡ä»¶ï¼‰ r(å•çº¯çš„æ™®é€šåªçœ‹ä¸æ”¹ä¸æ‰§è¡Œ)
```

3ã€**rwxå¯¹ç›®å½•çš„å½±å“**

```
è¯»å–æƒé™ï¼ˆrï¼‰ï¼Œå¦‚æœç›®å½•åªæœ‰ræƒé™: å…·æœ‰æµè§ˆç›®å½•åŠå­ç›®å½•æƒé™
	1.å¯ä»¥ä½¿ç”¨lså‘½ä»¤æµè§ˆç›®å½•åŠå­ç›®å½•ï¼Œ ä½†åŒæ—¶ä¹Ÿä¼šæç¤ºæƒé™æ‹’ç»
	2.ä½¿ç”¨ls -lå‘½ä»¤æµè§ˆç›®å½•åŠå­ç›®å½•ï¼Œæ–‡ä»¶å±æ€§ä¼šå¸¦é—®å·ï¼Œå¹¶ä¸”åªèƒ½çœ‹åˆ°æ–‡ä»¶å
	æ€»ç»“: ç›®å½•åªæœ‰ræƒé™ï¼Œä»…ä»…åªèƒ½æµè§ˆå†…çš„æ–‡ä»¶åï¼Œæ— å…¶ä»–æ“ä½œæƒé™

å†™å…¥æƒé™ï¼ˆwï¼‰ï¼Œå¦‚æœç›®å½•åªæœ‰wæƒé™: å…·æœ‰å¢åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ç›®å½•å†…æ–‡ä»¶åæƒé™(éœ€è¦xæƒé™é…åˆ)
	PS: å¦‚æœç›®å½•æœ‰wæƒé™, å¯ä»¥åœ¨ç›®å½•å†…åˆ›å»ºæ–‡ä»¶, åˆ é™¤æ–‡ä»¶(è·Ÿæ–‡ä»¶æœ¬èº«æƒé™æ— å…³)
	ä¸èƒ½è¿›å…¥ç›®å½•ã€ä¸èƒ½å¤åˆ¶ç›®å½•ã€ä¸èƒ½åˆ é™¤ç›®å½•ã€ä¸èƒ½ç§»åŠ¨ç›®å½•

æ‰§è¡Œæƒé™ï¼ˆxï¼‰ï¼Œå¦‚æœç›®å½•åªæœ‰xæƒé™
	1.åªèƒ½è¿›å…¥ç›®å½•
	2.ä¸èƒ½æµè§ˆã€å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤
```

æ€»ç»“

```bash
ç›®å½•ï¼š ç»™äºˆrx
1.æ‹¥æœ‰è¿›å…¥è¯¥ç›®å½•çš„æƒé™
2.å¦‚æœæƒ³æ“ä½œè¯¥ç›®å½•ä¸‹æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å–å†³äºè¯¥æ–‡ä»¶æ˜¯å¦å…è®¸å¯¹åº”çš„ç”¨æˆ·è¿›è¡Œæ“ä½œ
3.æ— æ³•å¯¹è¯¥ç›®å½•è¿›è¡Œæ–°å¢å’Œåˆ é™¤æ–‡ä»¶

rx	ç›®å½•	
	rw	æ–‡ä»¶ï¼ˆé…ç½®ï¼‰
	rx	æ–‡ä»¶ï¼ˆè„šæœ¬ï¼‰
	r	æ–‡ä»¶ï¼ˆé‡è¦çš„æ–‡ä»¶ï¼Œåªèƒ½çœ‹ï¼Œä¸èƒ½æ”¹ï¼Œä¹Ÿä¸èƒ½æ‰§è¡Œã€‚ï¼‰
	
PS: æ–‡ä»¶çš„ xæƒé™å°å¿ƒç»™äºˆï¼Œç›®å½•çš„ wæƒé™å°å¿ƒç»™äºˆã€‚
PS: æ–‡ä»¶é€šå¸¸è®¾å®šçš„æƒé™æ˜¯644,ç›®å½•è®¾å®šçš„æƒé™æ˜¯755
PS: æ§åˆ¶ç›®å½•æƒé™755, å¦‚æœæœ‰æ™®é€šç”¨æˆ·éœ€è¦æ“ä½œç›®å½•é‡Œé¢çš„æ–‡ä»¶ï¼Œåœ¨æ¥çœ‹æ–‡ä»¶çš„æƒé™
```

## 4. è¾“å…¥è¾“å‡º

| åç§°                 | æ–‡ä»¶æè¿°ç¬¦ | ä½œç”¨                                       |
| :------------------- | :--------- | :----------------------------------------- |
| æ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰    | 0          | é»˜è®¤æ˜¯é”®ç›˜ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡ä»¶æˆ–å…¶ä»–å‘½ä»¤çš„è¾“å‡ºã€‚ |
| æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰   | 1          | é»˜è®¤è¾“å‡ºåˆ°å±å¹•ã€‚                           |
| é”™è¯¯è¾“å‡ºï¼ˆSTDERRï¼‰   | 2          | é»˜è®¤è¾“å‡ºåˆ°å±å¹•ã€‚                           |
| æ–‡ä»¶åç§°ï¼ˆfilenameï¼‰ | 3+....     |                                            |

**è¾“å‡ºé‡å®šå‘ï¼Œæ”¹å˜è¾“å‡ºå†…å®¹çš„ä½ç½®ã€‚è¾“å‡ºé‡å®šå‘æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼Œå¦‚è¡¨æ ¼æ‰€ç¤º**

| ç±»å‹               | æ“ä½œç¬¦ | ç”¨é€”                                                         |
| :----------------- | :----- | :----------------------------------------------------------- |
| æ ‡å‡†è¦†ç›–è¾“å‡ºé‡å®šå‘ | >      | å°†ç¨‹åºè¾“å‡ºçš„æ­£ç¡®ç»“æœè¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­,ä¼šè¦†ç›–æ–‡ä»¶åŸæœ‰çš„å†…å®¹  |
| æ ‡å‡†è¿½åŠ è¾“å‡ºé‡å®šå‘ | >>     | å°†ç¨‹åºè¾“å‡ºçš„æ­£ç¡®ç»“æœä»¥è¿½åŠ çš„æ–¹å¼è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶ |
| é”™è¯¯è¦†ç›–è¾“å‡ºé‡å®šå‘ | 2>     | å°†ç¨‹åºçš„é”™è¯¯ç»“æœè¾“å‡ºåˆ°æ‰§è¡Œçš„æ–‡ä»¶ä¸­ï¼Œä¼šè¦†ç›–æ–‡ä»¶åŸæœ‰çš„å†…å®¹     |
| é”™è¯¯è¿½åŠ è¾“å‡ºé‡å®šå‘ | 2>>    | å°†ç¨‹åºè¾“å‡ºçš„é”™è¯¯ç»“æœä»¥è¿½åŠ çš„æ–¹å¼è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶ |
| æ ‡å‡†è¾“å…¥é‡å®šå‘     | <<     | å°†å‘½ä»¤ä¸­æ¥æ”¶è¾“å…¥çš„é€”å¾„ç”±é»˜è®¤çš„é”®ç›˜æ›´æ”¹ä¸ºæŒ‡å®šçš„æ–‡ä»¶æˆ–å‘½ä»¤     |

## 5. yumåŒ…ç®¡ç†

**ä¸€ä¸ªrepoæ–‡ä»¶å†…å®¹**

```bash
[root@container ~]# cat /etc/yum.repos.d/test.repo
[local-oldboy]				#ä»“åº“åç§°ï¼Œå¯éšæ„è¡¨ç¤º
name = Local Packages		#ä»“åº“çš„æè¿° å¯é€šè¿‡ yum repolistæŸ¥çœ‹
baseurl = file:///mnt       #æˆ‘ä»¬çš„ä»“åº“åœ¨é‚£é‡Œï¼Œä½¿ç”¨ä»€ä¹ˆåè®®è®¿é—®æœ‰http:// ftp://  file://
enabled = 1				    #æ˜¯å¦å¯ç”¨è¯¥ä»“åº“   1 è¡¨ç¤ºå¯åŠ¨  0è¡¨ç¤ºä¸å¯ç”¨
gpgcheck = 0				#æ˜¯å¦è¦æ ¡éªŒè½¯ä»¶åŒ…çš„åˆæ³•æ€§  ï¼ˆ 0 ä¸æ ¡éªŒ ï¼‰
```

## 6. ç£ç›˜ç®¡ç†

 è¿œç¨‹æ§åˆ¶å¡æ“ä½œå‚è€ƒé“¾æ¥
https://www.bilibili.com/video/av46656120/?p=7 

**1.å¦‚ä½•ä½¿ç”¨ç£ç›˜**

```bash
1.1 æœ‰ä¸€ä¸ªç£ç›˜
1.2 ä½¿ç”¨fdiskåˆ†åŒº  å¤§äº2tb ä½¿ç”¨ gdiskåˆ†åŒº   ï¼ˆåˆ†ä¸€ä¸ªåŒºï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æ•´ä¸ªç£ç›˜ï¼‰
1.3 éœ€è¦è¿›è¡Œæ ¼å¼åŒ–   mkfs.xfs
1.4 ä½¿ç”¨mountè¿›è¡ŒæŒ‚è½½
1.5 å°†æŒ‚è½½çš„ä¿¡æ¯æ·»åŠ åˆ°/etc/fstab  
1.6 ä½¿ç”¨ mount -a æ‰§è¡Œæ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œä»£è¡¨ç¼–å†™æ­£å¸¸ã€‚é‡å¯è®¾å¤‡ä¼šè‡ªåŠ¨æŒ‚è½½ä¸Šæ¥
```

**2.SWAP**

```bash
2.1 SWAPæ˜¯å½“ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ï¼Œä¸´æ—¶å°†ç£ç›˜ç©ºé—´ä½œä¸ºå†…å­˜é¡¶æ›¿ä½¿ç”¨
2.2 å¦‚æœæ²¡æœ‰swap ç‰©ç†ä¸å¤Ÿï¼Œç³»ç»Ÿä¼šå¯ç”¨ä¿æŠ¤æœºåˆ¶ï¼Œç„¶åkillæ‰æŸä¸ªå ç”¨å†…å­˜çš„ç¨‹åº
2.3 å¦‚æœæœ‰swapï¼Œç‰©ç†ä¸å¤Ÿï¼Œä¼šä½¿ç”¨swapä½œä¸ºå†…å­˜ï¼ˆç³»ç»Ÿå°±ä¼šå¼€å§‹å˜å¾—æ¯”è¾ƒçš„å¡é¡¿äº†ï¼‰
16Gb    | äº‘ä¸»æœº åŸºæœ¬æ²¡æœ‰swap
```

**3.RAID**

```bash
3.1 ç£ç›˜é˜µåˆ—æŠ€æœ¯ï¼Œå¯¹ç£ç›˜è¿›è¡Œç¼–æ’ï¼Œæä¾›æ›´é«˜çš„è¯»å†™é€Ÿåº¦ã€ä»¥åŠå†—ä½™èƒ½åŠ›ã€‚
3.2 RAID 0   1  5  10 
3.3 RAID 0 å¿«ã€å¤§ã€‚   åä¸€ä¸ªç£ç›˜ï¼Œéƒ½ç»“æŸäº†ã€‚
3.4 RAID 1 æœ‰å†—ä½™ï¼Œå…è®¸åä¸€ä¸ªç›˜ã€å†™ä¸å¿«ï¼Œè¯»æ¯”è¾ƒå¿«ã€‚ å®¹é‡ä»…èƒ½ä½¿ç”¨ ç™¾åˆ†ä¹‹ 50%
3.5 RAID 5 æ—¢èƒ½ä¿è¯é€Ÿåº¦ã€è¿˜èƒ½ä¿è¯å†—ä½™ã€ç©ºé—´æœ‰1/3çš„æµªè´¹ã€‚  æˆæœ¬å¯æ§ã€‚   ï¼ˆ ä½¿ç”¨è¾ƒå¤š ï¼‰
3.6 RAID 10   å…ˆåšRAID 1  åœ¨åšRAID0  ï¼ˆåš2ä¸ªRAID1 4å¿«ç›˜ï¼Œ==>RAID0  ç©ºé—´ 50% ï¼‰

å†—ä½™ä»å¥½åˆ°åï¼šRaid1==>Raid10==>Raid5==>Raid0
æ€§èƒ½ä»å¥½åˆ°åï¼šRaid0==>Raid10==>Raid5==>Raid1
æˆæœ¬ä»ä½åˆ°é«˜ï¼šRaid0==>Raid5==>Raid1==>Raid10
```

## 7. systemctlç³»ç»ŸæœåŠ¡ç®¡ç†

**7.1 å¼€æœºå¯åŠ¨æµç¨‹**

1. Linuxç³»ç»Ÿçš„å¯åŠ¨è¿‡ç¨‹å¹¶ä¸æ˜¯å¤§å®¶æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¤æ‚ï¼Œå…¶è¿‡ç¨‹å¯ä»¥åˆ†ä¸º5ä¸ªé˜¶æ®µï¼š

- å†…æ ¸çš„å¼•å¯¼ã€‚

- è¿è¡Œ init(6)ã€‚ sentos7 è¿è¡Œçˆ¶è¿›ç¨‹(systemd) pstreeè¿›è¡ŒæŸ¥çœ‹çˆ¶è¿›ç¨‹systemd -spå±•å¼€æŸ¥çœ‹

- ç³»ç»Ÿåˆå§‹åŒ–ã€‚

- å»ºç«‹ç»ˆç«¯ ã€‚

- ç”¨æˆ·ç™»å½•ç³»ç»Ÿã€‚

  centos7
  6å’Œ7å¯åŠ¨çš„ç¥–å®—è¿›ç¨‹ä¸ä¸€æ ·,åŠ è½½åˆå§‹åŒ–è„šæœ¬çš„ä½ç½®ä¹Ÿä¸ä¸€æ ·,å…¶ä»–éƒ½ä¸€æ ·

**7.2 è¿è¡Œçº§åˆ«**

ä»€ä¹ˆæ˜¯è¿è¡Œçº§åˆ«ï¼Œè¿è¡Œçº§åˆ«å°±æ˜¯æ“ä½œç³»ç»Ÿå½“å‰æ­£åœ¨è¿è¡Œçš„åŠŸèƒ½çº§åˆ«(ä¸€èˆ¬ç”¨3å‘½ä»¤è¡Œ)

```bash
 System V initè¿è¡Œçº§åˆ«			systemdç›®æ ‡åç§°						ä½œç”¨
  0						runlevel0.target, poweroff.target			å…³æœº
  1						runlevel1.target, rescue.target				å•ç”¨æˆ·æ¨¡å¼
  2						runlevel2.target, multi-user.target			æ²¡æœ‰ä½¿ç”¨
  3						runlevel3.target, multi-user.target			å¤šç”¨æˆ·çš„æ–‡æœ¬ç•Œé¢
  4						runlevel4.target, multi-user.target			æ²¡æœ‰ä½¿ç”¨
  5						runlevel5.target, graphical.target			å¤šç”¨æˆ·çš„å›¾å½¢ç•Œé¢
  6						runlevel6.target, reboot.target				é‡å¯
```

æŸ¥çœ‹è¿è¡Œçº§åˆ«

```bash
#centos6ç³»ç»Ÿçš„è¿è¡Œçº§åˆ«ï¼Œ/etc/inittab #è¿è¡Œçº§åˆ«æ–‡ä»¶,ä¿®æ”¹ä¸‹é¢æ•°å­—å°±å¯ä»¥
1.ä¸´æ—¶
	runlevel	æŸ¥çœ‹å½“å‰çº§åˆ«   

	init Number(çº§åˆ«æ•°å­—) 	åˆ‡æ¢çº§åˆ«

2.æ°¸ä¹…  /etc/inittab
	id:5:initdefault #å¼€æœºå¯åŠ¨ä»€ä¹ˆçº§åˆ«(5å°±æ˜¯å›¾å½¢åŒ–ç•Œé¢)

#centos7è¿è¡Œçº§åˆ«
multi-user.target: analogous to runlevel 3
graphical.target: analogous to runlevel 5

#systemctl get-default    æŸ¥çœ‹è¿è¡Œçº§åˆ«
multi-user.target   3

#ä¿®æ”¹é»˜è®¤è¿è¡Œçº§åˆ«
[root@syc~]# systemctl set-default graphical.target
Removed symlink /etc/systemd/system/default.target.
Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/graphical.target.
#è¿›è¡ŒæŸ¥çœ‹çº§åˆ«
[root@syc~]# systemctl get-default
graphical.target
```



## 8.ç³»ç»Ÿå¹³å‡è´Ÿè½½

 æ¯æ¬¡å‘ç°ç³»ç»Ÿå˜æ…¢æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸åšçš„ç¬¬ä¸€ä»¶äº‹ï¼Œå°±æ˜¯æ‰§è¡Œ top æˆ–è€… uptime å‘½ä»¤ï¼Œæ¥äº†è§£ç³»ç»Ÿçš„è´Ÿè½½æƒ…å†µã€‚æ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼Œæˆ‘åœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥äº† uptime å‘½ä»¤ï¼Œç³»ç»Ÿä¹Ÿéšå³ç»™å‡ºäº†ç»“æœã€‚ 

```bash
[root@m01 ~]# uptime
04:49:26 up 2 days, 2:33, 2 users, load average: 0.70, 0.04, 0.05

#æˆ‘ä»¬å·²ç»æ¯”è¾ƒç†Ÿæ‚‰å‰é¢å‡ åˆ—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯å½“å‰æ—¶é—´ã€ç³»ç»Ÿè¿è¡Œæ—¶é—´ä»¥åŠæ­£åœ¨ç™»å½•ç”¨æˆ·æ•°ã€‚
è€Œæœ€åä¸‰ä¸ªæ•°å­—å‘¢ï¼Œä¾æ¬¡åˆ™æ˜¯è¿‡å» 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ï¼ˆLoad Averageï¼‰ã€‚
```

**8.1 ä»€ä¹ˆæ˜¯å¹³å‡è´Ÿè½½**

- å¹³å‡è´Ÿè½½æ˜¯æŒ‡å•ä½æ—¶é—´å†…ï¼Œç³»ç»Ÿå¤„äº å¯è¿è¡ŒçŠ¶æ€R å’Œ ä¸å¯ä¸­æ–­çŠ¶æ€D çš„å¹³å‡è¿›ç¨‹æ•°ï¼Œä¹Ÿå°±æ˜¯å¹³å‡æ´»è·ƒè¿›ç¨‹æ•°
- å¹³å‡è´Ÿè½½å…¶å®å°±æ˜¯å•ä½æ—¶é—´å†…çš„æ´»è·ƒè¿›ç¨‹æ•°ã€‚ ( å¯è¿è¡ŒçŠ¶æ€R + ä¸å¯ä¸­æ–­çŠ¶æ€D )
- å¹³å‡è´Ÿè½½è¦çœ‹çš„æ˜¯ä¸‰ä¸ªå€¼(1,5,15åˆ†é’Ÿ)ï¼Œä¸æ˜¯ä¸€ä¸ªã€‚

**8.2 å¯è¿è¡ŒçŠ¶æ€å’Œä¸å¯ä¸­æ–­çŠ¶æ€æ˜¯ä»€ä¹ˆ**

- 1.å¯è¿è¡ŒçŠ¶æ€è¿›ç¨‹ï¼Œæ˜¯æŒ‡æ­£åœ¨ä½¿ç”¨ CPU æˆ–è€…æ­£åœ¨ç­‰å¾… CPU çš„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ps å‘½ä»¤çœ‹åˆ°å¤„äº R çŠ¶æ€çš„è¿›ç¨‹ã€‚
- 2.ä¸å¯ä¸­æ–­è¿›ç¨‹ï¼Œ(ä½ åšä»€ä¹ˆäº‹æƒ…çš„æ—¶å€™æ˜¯ä¸èƒ½æ‰“æ–­çš„?) ç³»ç»Ÿä¸­æœ€å¸¸è§çš„æ˜¯ç­‰å¾…ç¡¬ä»¶è®¾å¤‡çš„ I/O å“åº”ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ ps å‘½ä»¤ä¸­çœ‹åˆ°çš„ D çŠ¶æ€ï¼ˆä¹Ÿç§°ä¸º Disk Sleepï¼‰çš„è¿›ç¨‹ã€‚

**8.3 å¹³å‡è´Ÿè½½å¤šå°‘æ—¶åˆç†**

 æœ€ç†æƒ³çš„çŠ¶æ€æ˜¯æ¯ä¸ª CPU ä¸Šéƒ½åˆšå¥½è¿è¡Œç€ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·æ¯ä¸ª CPU éƒ½å¾—åˆ°äº†å……åˆ†åˆ©ç”¨ã€‚æ‰€ä»¥åœ¨è¯„åˆ¤å¹³å‡è´Ÿè½½æ—¶ï¼Œé¦–å…ˆä½ è¦çŸ¥é“ç³»ç»Ÿæœ‰å‡ ä¸ª CPUï¼Œè¿™å¯ä»¥é€šè¿‡ top å‘½ä»¤è·å–ï¼Œæˆ–grep â€˜model nameâ€™ /proc/cpuinfo 

```bash
ä¾‹1ã€å‡è®¾ç°åœ¨åœ¨ 4ã€2ã€1æ ¸çš„CPUä¸Šï¼Œå¦‚æœå¹³å‡è´Ÿè½½ä¸º 2 æ—¶ï¼Œæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ
Q1.åœ¨4 ä¸ª CPU çš„ç³»ç»Ÿä¸Šï¼Œæ„å‘³ç€ CPU æœ‰ 50% çš„ç©ºé—²ã€‚
Q2.åœ¨2 ä¸ª CPU çš„ç³»ç»Ÿä¸Šï¼Œæ„å‘³ç€æ‰€æœ‰çš„ CPU éƒ½åˆšå¥½è¢«å®Œå…¨å ç”¨ã€‚
Q3.è€Œ1 ä¸ª CPU çš„ç³»ç»Ÿä¸Šï¼Œåˆ™æ„å‘³ç€æœ‰ä¸€åŠçš„è¿›ç¨‹ç«äº‰ä¸åˆ° CPUã€‚


1.å¦‚æœ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„ä¸‰ä¸ªå€¼åŸºæœ¬ç›¸åŒï¼Œæˆ–è€…ç›¸å·®ä¸å¤§ï¼Œé‚£å°±è¯´æ˜ç³»ç»Ÿè´Ÿè½½å¾ˆå¹³ç¨³ã€‚
2.ä½†å¦‚æœ 1 åˆ†é’Ÿçš„å€¼è¿œå°äº 15 åˆ†é’Ÿçš„å€¼ï¼Œå°±è¯´æ˜ç³»ç»Ÿæœ€è¿‘ 1 åˆ†é’Ÿçš„è´Ÿè½½åœ¨å‡å°‘ï¼Œè€Œè¿‡å» 15 åˆ†é’Ÿå†…å´æœ‰å¾ˆå¤§çš„è´Ÿè½½ã€‚
3.åè¿‡æ¥ï¼Œå¦‚æœ 1 åˆ†é’Ÿçš„å€¼è¿œå¤§äº 15 åˆ†é’Ÿçš„å€¼ï¼Œå°±è¯´æ˜æœ€è¿‘ 1 åˆ†é’Ÿçš„è´Ÿè½½åœ¨å¢åŠ ï¼Œè¿™ç§å¢åŠ æœ‰å¯èƒ½åªæ˜¯ä¸´æ—¶æ€§çš„ï¼Œä¹Ÿæœ‰å¯èƒ½è¿˜ä¼šæŒç»­ä¸Šå‡ï¼Œæ‰€ä»¥å°±éœ€è¦æŒç»­è§‚å¯Ÿã€‚

PS: ä¸€æ—¦ 1 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½æ¥è¿‘æˆ–è¶…è¿‡äº† CPU çš„ä¸ªæ•°ï¼Œå°±æ„å‘³ç€ç³»ç»Ÿæ­£åœ¨å‘ç”Ÿè¿‡è½½çš„é—®é¢˜ï¼Œè¿™æ—¶å°±å¾—åˆ†æé—®é¢˜ï¼Œå¹¶è¦æƒ³åŠæ³•ä¼˜åŒ–äº†
åœ¨æ¥çœ‹ä¸ªä¾‹å­3ã€å‡è®¾æˆ‘ä»¬åœ¨æœ‰2ä¸ª CPU ç³»ç»Ÿä¸Šçœ‹åˆ°å¹³å‡è´Ÿè½½ä¸º 2.73ï¼Œ6.90ï¼Œ12.98
é‚£ä¹ˆè¯´æ˜åœ¨è¿‡å»1 åˆ†é’Ÿå†…ï¼Œç³»ç»Ÿæœ‰ 136% çš„è¶…è½½ (2.73/2=136%)
è€Œåœ¨è¿‡å» 5 åˆ†é’Ÿå†…ï¼Œæœ‰ 345% çš„è¶…è½½ (6.90/2=345%)
è€Œåœ¨è¿‡å»15 åˆ†é’Ÿå†…ï¼Œæœ‰ 649% çš„è¶…è½½ï¼Œ(12.98/2=649%)
ä½†ä»æ•´ä½“è¶‹åŠ¿æ¥çœ‹ï¼Œç³»ç»Ÿçš„è´Ÿè½½æ˜¯åœ¨é€æ­¥çš„é™ä½ã€‚
```

**8.4 å¹³å‡è´Ÿè½½å’ŒCPUä½¿ç”¨ç‡æœ‰ä»€ä¹ˆå…³ç³»**

Q: å¹³å‡è´Ÿè½½é«˜äº†ï¼Œä¸å°±æ„å‘³ç€ CPU ä½¿ç”¨ç‡é«˜å—ï¼Ÿ 

 A: å›åˆ°å¹³å‡è´Ÿè½½çš„å«ä¹‰ä¸Šæ¥ï¼Œå¹³å‡è´Ÿè½½æ˜¯æŒ‡å•ä½æ—¶é—´å†…ï¼Œå¤„äºå¯è¿è¡ŒçŠ¶æ€å’Œä¸å¯ä¸­æ–­çŠ¶æ€çš„è¿›ç¨‹æ•°ã€‚æ‰€ä»¥ï¼Œå®ƒä¸ä»…åŒ…æ‹¬äº†æ­£åœ¨ä½¿ç”¨ CPU çš„è¿›ç¨‹ï¼Œè¿˜åŒ…æ‹¬ç­‰å¾… CPU å’Œç­‰å¾… I/O çš„è¿›ç¨‹ã€‚ 

è€Œ CPU ä½¿ç”¨ç‡ï¼Œæ˜¯å•ä½æ—¶é—´å†… CPU ç¹å¿™æƒ…å†µçš„ç»Ÿè®¡ï¼Œè·Ÿå¹³å‡è´Ÿè½½å¹¶ä¸ä¸€å®šå®Œå…¨å¯¹åº”ã€‚æ¯”å¦‚ï¼š

- 1.CPU å¯†é›†å‹è¿›ç¨‹ï¼Œä½¿ç”¨å¤§é‡ CPU è®¡ç®—ä¼šå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜ï¼Œæ­¤æ—¶è¿™ä¸¤è€…æ˜¯ä¸€è‡´çš„ï¼› ï¼ˆ è§†é¢‘çš„è½¬ç  åŠ å¯† è®¡ç®—åœ†å‘¨ç‡ ï¼‰
- 2.I/O å¯†é›†å‹è¿›ç¨‹ï¼Œç­‰å¾… I/O ä¹Ÿä¼šå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜ï¼Œä½† CPU ä½¿ç”¨ç‡ä¸ä¸€å®šå¾ˆé«˜ï¼› å…³æ³¨wa
- 3.å¤§é‡çš„ CPU è¿›ç¨‹è°ƒåº¦ä¹Ÿä¼šå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜ï¼Œæ­¤æ—¶çš„ CPU ä½¿ç”¨ç‡ä¹Ÿä¼šæ¯”è¾ƒé«˜ã€‚

**æ€»ç»“: æ’æŸ¥æ­¥éª¤**

```bash
æŸ¥çœ‹æ­¥éª¤:
1.uptimeçœ‹çœ‹è´Ÿè½½çš„æƒ…å†µ ï¼ˆ è¶…è¿‡äº† cpuçš„æ ¸å¿ƒ ï¼‰
2.topçœ‹æ˜¯cpuçš„ä½¿ç”¨ç‡é«˜ è¿˜æ˜¯ waç­‰å¾…é«˜ è¿˜æ˜¯å†…æ ¸æ€å ç”¨cpué«˜ ã€è½¯ä¸­æ–­é«˜ ã€niceä¼˜å…ˆçº§è¿›ç¨‹å ç”¨cpuã€
3.topçœ‹æ˜¯å“ªä¸ªè¿›ç¨‹
4.è¿½è¸ªè¿™ä¸ªè¿›ç¨‹çš„æƒ…å†µã€‚
5.çœ‹çœ‹æ˜¯å¦å­˜åœ¨å¼‚å¸¸æ—¥å¿—ã€‚
```

